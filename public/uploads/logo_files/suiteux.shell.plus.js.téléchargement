var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_plus_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["plus"],{87152:function(e,t,n){(t=e.exports=n(25127)(!1)).push([e.id,'.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\={display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;border:1px solid hsla(0,0%,100%,0);box-shadow:0 1px 2px 0 rgba(0,0,0,.1);box-sizing:border-box;width:276px;padding-left:0;align-items:flex-start;margin:0 0 17px 16px}html[dir=rtl] .o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\={margin-left:0;margin-right:16px}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.1);box-shadow:0 8px 16px 0 rgba(0,0,0,.1)}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>button{min-width:30px;width:30px;height:36px;padding-left:10px;padding-right:10px;background-color:transparent;border:none;align-items:flex-start}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-ms-clear{display:none}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-cancel-button,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-decoration,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-results-button,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-results-decoration{-webkit-appearance:none;display:none}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\= .j6BvNpCF90XiKxu0F7sZzw\\=\\={width:250px;height:32px;background:transparent;align-items:flex-start;border:none;display:block;font:13px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;text-overflow:ellipsis;padding-left:5px;outline:none;margin:.1em}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\= .j6BvNpCF90XiKxu0F7sZzw\\=\\=:-internal-autofill-selected{background-color:transparent!important}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=:focus{cursor:text}.o365cs-base .nHk7LESAfIWtWyD9f7IM9g\\=\\={margin:0 0 5px 16px}',""]),t.locals={SearchControl:"oxbF2LyKwVB/a5+4gTMkFg==",inputBox:"j6BvNpCF90XiKxu0F7sZzw==",SearchControlZoomMargin:"nHk7LESAfIWtWyD9f7IM9g=="}},46095:function(e,t,n){(t=e.exports=n(25127)(!1)).push([e.id,'.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\={position:absolute}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._1ZqUEbZKjUMrjQWoZseg6g\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:16px;height:16px;line-height:15px;border-radius:1em;box-sizing:border-box;text-align:center;left:0}@media (-ms-high-contrast:active),(forced-colors:active){.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._1ZqUEbZKjUMrjQWoZseg6g\\=\\={-ms-high-contrast-adjust:none;forced-color-adjust:none;background-color:Highlight!important;color:highlightText!important}}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._56EuyMD2soE1\\/gKXBY0q9g\\=\\={top:7px;width:8px;height:8px;border:1px solid #fff;border-radius:4px}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= .\\+OLPNIF6B5kKoA97J3vVpw\\=\\={border-color:#000}',""]),t.locals={unseenitems:"TlAdlUrWd0Z6/TteKJSQig==",unseenCount:"_1ZqUEbZKjUMrjQWoZseg6g==",emptyBadge:"_56EuyMD2soE1/gKXBY0q9g==",emptyBadgeDarkMode:"+OLPNIF6B5kKoA97J3vVpw=="}},97201:function(e,t,n){(t=e.exports=n(25127)(!1)).push([e.id,'.NszUgtzDfx0t1PQrucmvnA\\=\\={display:block}.c6QE6q0imyqZPiHyLPm9YA\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.uGAx4CbRh\\+jEaMdf4Etv7w\\=\\={font-family:SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:600}.vmO5rYvtVrmsybm3QJFJUw\\=\\={font-family:SegoeUI-Light-final,Segoe UI Light,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.Q8qHkqThZ3HCwPmk\\+m2bFQ\\=\\={font-family:SegoeUI-SemiLight-final,Segoe UI Semilight,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.iDm2WTqpMgwzbBSSRlbuog\\=\\={font-family:Arial,SegoeUI-Regular-final,Segoe UI,Segoe,Tahoma,Helvetica,sans-serif}',""]),t.locals={displayBlock:"NszUgtzDfx0t1PQrucmvnA==",segoeRegular:"c6QE6q0imyqZPiHyLPm9YA==",segoeSemibold:"uGAx4CbRh+jEaMdf4Etv7w==",segoeLight:"vmO5rYvtVrmsybm3QJFJUw==",segoeSemiLight:"Q8qHkqThZ3HCwPmk+m2bFQ==",arialRegular:"iDm2WTqpMgwzbBSSRlbuog=="}},88786:function(e,t,n){(t=e.exports=n(25127)(!1)).push([e.id,".LOH65mHND5UuJ9b5MOPIyg\\=\\={height:calc(100vh - 115px)}.EjkBtpEVGYQK1q\\/td6mhdg\\=\\={height:calc(100vh - 113px)}.sbU\\+9csU7o21SILr6MJmgw\\=\\={height:calc(100vh - 73px)}",""]),t.locals={flexPaneContentContainer:"LOH65mHND5UuJ9b5MOPIyg==",flexPaneContentContainerForThinHeader:"EjkBtpEVGYQK1q/td6mhdg==",flexPaneContentContainerForShyHeader:"sbU+9csU7o21SILr6MJmgw=="}},8473:function(e,t,n){(t=e.exports=n(25127)(!1)).push([e.id,'.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\={font-family:ShellFabricMDL2IconsLite,ShellFabricMDL2Icons;line-height:1}.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\= .o365cs-base [class*=" ms-Icon--"]:before,.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\= .o365cs-base [class^=ms-Icon--]:before{font-family:inherit}.HKHsnwPD9asgCY\\/1RHVuQw\\=\\=,.I4nj8afMLjWpJ2UOud88zg\\=\\={height:100%}',""]),t.locals={customHeaderButton:"TaSuqlyJ5MSqTQbXTeS3tQ==",customHeaderButtonsContainer:"HKHsnwPD9asgCY/1RHVuQw==",customHeaderButtonWrapper:"I4nj8afMLjWpJ2UOud88zg=="}},84422:function(e,t,n){(t=e.exports=n(25127)(!1)).push([e.id,".\\/FzkYcX7qvnoEMaUtV922A\\=\\=,.hNRvTvwVOsDErxAdwaiZGQ\\=\\={-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1)}.MqP9cttxW\\/k6fP9KBfvJXw\\=\\=,.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={width:100%;height:8px;visibility:hidden;display:none}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={background:transparent;cursor:pointer}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\=:hover{opacity:.4;background:#404040}.mYrlHvrSR57f9RgjZDapRg\\=\\={position:absolute;left:47.81%;right:47.81%;border-radius:6px;width:14px;height:2px;align-self:center;pointer-events:none}.DJNRezt7dApXIOSDqmGElw\\=\\={-webkit-animation-name:headerSlideInFrames;animation-name:headerSlideInFrames}.QU0CdgILUm0YoP\\+SCe437g\\=\\={-webkit-animation-name:headerSlideOutFrames;animation-name:headerSlideOutFrames}.ICSgbPvcuYIMYmjWDVZjyQ\\=\\={-webkit-animation-name:workloadDivSlideInFrames;animation-name:workloadDivSlideInFrames;animation-fill-mode:forwards}.psEYMGfctmMkbBQaQqGwDg\\=\\={-webkit-animation-name:workloadDivSlideOutFrames;animation-name:workloadDivSlideOutFrames;animation-fill-mode:forwards}@-webkit-keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@-webkit-keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@-webkit-keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}@keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}",""]),t.locals={headerAnimations:"/FzkYcX7qvnoEMaUtV922A==",workloadDivAnimations:"hNRvTvwVOsDErxAdwaiZGQ==",shyHeader:"MqP9cttxW/k6fP9KBfvJXw==",shyHeaderOverlay:"tqq1tl3OHof+9xOfBWUR4Q==",shyHeaderGripper:"mYrlHvrSR57f9RgjZDapRg==",headerSlideIn:"DJNRezt7dApXIOSDqmGElw==",headerSlideOut:"QU0CdgILUm0YoP+SCe437g==",workloadDivSlideIn:"ICSgbPvcuYIMYmjWDVZjyQ==",workloadDivSlideOut:"psEYMGfctmMkbBQaQqGwDg=="}},88818:function(e,t,n){var r=n(87152);"string"==typeof r&&(r=[[e.id,r,""]]);var a={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(r,a);r.locals&&(e.exports=r.locals)},50115:function(e,t,n){var r=n(46095);"string"==typeof r&&(r=[[e.id,r,""]]);var a={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(r,a);r.locals&&(e.exports=r.locals)},81348:function(e,t,n){var r=n(97201);"string"==typeof r&&(r=[[e.id,r,""]]);var a={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(r,a);r.locals&&(e.exports=r.locals)},85620:function(e,t,n){var r=n(88786);"string"==typeof r&&(r=[[e.id,r,""]]);var a={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(r,a);r.locals&&(e.exports=r.locals)},42573:function(e,t,n){var r=n(8473);"string"==typeof r&&(r=[[e.id,r,""]]);var a={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(r,a);r.locals&&(e.exports=r.locals)},90932:function(e,t,n){var r=n(84422);"string"==typeof r&&(r=[[e.id,r,""]]);var a={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(r,a);r.locals&&(e.exports=r.locals)},79487:function(e,t,n){"use strict";var r;n.d(t,{o:function(){return r}}),function(e){e[e.OWA=1]="OWA",e[e.TokenFactory=3]="TokenFactory"}(r||(r={}))},56597:function(e,t,n){"use strict";n.d(t,{K:function(){return y}});var r=n(62244),a=n(66337),i=n(91011),o=n(32964),s=n(89990),u=n(9264),l=n(85884),c=n(41018),p=n(99964),d=n(79487),f=n(78453),h=n(39013),g=n(17698),m=n(84686);function S(e){var t=null;try{null!=sessionStorage&&(t=sessionStorage.getItem(e))}catch(e){}return t}var y=function(){function e(t,n,r,a){if(void 0===a&&(a=!1),u.validateField(n,"url",u.StringTypeString,!0),u.isNullOrEmptyString(n))throw u.createInvalidParameterException("url");if(n.indexOf("?")>=0)throw u.createInvalidParameterException("url");"/"===n.charAt(0)&&(n=u.buildUrl(u.getCurrentWindowLocation(),n)),u.validateFullUrl(n,"url"),n.charCodeAt(n.length-1)==="/".charCodeAt(0)&&(n=n.substr(0,n.length-1)),n=n.toLowerCase(),this.url=n,u.getUrlDomainPart(n,!0)!==u.getUrlDomainPart(u.getCurrentWindowLocation(),!0)&&!a||window.IsO365ShellTestPage?this.mode=1:this.mode=0,this.formDigestHandlingEnabled=!1,this.iFrameSourceUrl=r,e.sIFrameInstanceCode[this.appWebProxyUrl]=t,window.addEventListener("unload",e.resetMessageListenerAttachedFlag)}return Object.defineProperty(e.prototype,"appWebProxyUrl",{get:function(){return u.buildUrl(this.url,this.iFrameSourceUrl)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canExecuteNow",{get:function(){return null!==document.body||e.sWindowLoadCalled},enumerable:!1,configurable:!0}),e.prototype.executeAsync=function(e){return this.validateRequest(e,!1),this.executeValidatedRequestInternal(e)},e.prototype.executeCrossDomainRequestAsync=function(e,t){return void 0===t&&(t=!1),this.validateRequest(e,!0),this.executeValidatedRequestInternal(e,t)},e.prototype.ping=function(){return null!=e.sFramePinged&&e.sFramePinged[this.appWebProxyUrl]},e.prototype.registerOpxHost=function(e){this.executeOrQueueCrossDomainRequest(f.u.RegisterOpxHost,e)},e.prototype.executeOpxRequest=function(e){var t={requestObject:e};this.executeOrQueueCrossDomainRequest(f.u.OutgoingOpxMessage,t)},e.prototype.executeStorageRequest=function(t){if(1===this.mode)this.executeOrQueueCrossDomainRequest(f.u.Storage,t);else if(0===this.mode)try{var n=t.requestObject;1===n.RequestType?(0,i.jl)().tag("RequestExecutor_SuiteDataSharingDeprecated",6,-1018,s.OH):p.J.processRequest(n,(function(n){var r={responseObject:n};e.fireDataWatchSentCallback(t),null!=t.success&&t.success(r),e.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,0,"")}))}catch(n){null!=t.error&&t.error({},0,n.message),e.fireDataWatchReceivedCallbackGivenResponseInfo(t,{},n.errorCode||0,n.message)}},e.prototype.executeIdentityProviderRequest=function(e){1===this.mode&&this.executeOrQueueCrossDomainRequest(f.u.UserState,e)},e.prototype.executeSignalRRequest=function(e){this.validateRequest(e,!1),e.timeout=0,this.executeOrQueueCrossDomainRequest(f.u.SignalR,e)},e.prototype.setBeforeSendRequestAction=function(e){this.beforeSendRequest=e},e.prototype.prefetchOAuthAccessToken=function(e){var t=this;g.e.Instance.configuration.IsPwa?m.g.getToken(e).catch((function(n){1===n.responseType&&t.executeOrQueueCrossDomainRequest(f.u.TokenPrefetch,e)})):this.executeOrQueueCrossDomainRequest(f.u.TokenPrefetch,e)},e.prototype.getOwaUserConfiguration=function(e){this.executeOrQueueCrossDomainRequest(f.u.OwaUserConfig,e)},e.internalProcessIFrameRequestTimeoutCallback=function(t){if(null!==e.sPostMessageIdToRequestInfoMap){var n=e.sPostMessageIdToRequestInfoMap[t];null!=n&&(e.isCurrentSiteInTrustOrLocalZone()&&(0,i.jl)().tag("RequestExecutor_IFrameLoadError",4,-1007,s.DP),e.sPostMessageIdToRequestInfoMap[t]=null,delete e.sPostMessageIdToRequestInfoMap[t],u.reportSimpleError(n.requestInfo,-1001,s.fL,"IFrameRequest"),(0,i.jl)().serverRequest(n.command,n.requestInfo.method,e.sIFrameInstanceCode[n.appWebProxyUrl].toString(),n.requestInfo.url,-1001),e.fireDataWatchReceivedCallbackGivenResponseInfo(n.requestInfo,null,-1001,s.fL))}},e.prototype.validateRequest=function(e,t){if(u.validateRequestInfo(e),u.isFullUrl(e.url)){if(!t&&u.getUrlDomainPart(e.url,!0).toLowerCase()!==u.getUrlDomainPart(this.url,!0))throw u.createInvalidParameterException("requestInfo.url")}else e.url=u.buildUrl(this.url,e.url);(e.binaryStringRequestBody||e.binaryStringResponseBody)&&u.checkBrowserBinaryDataSupport()},e.prototype.executeValidatedRequestInternal=function(e,t){return void 0===t&&(t=!1),t?this.executeQueryDirect(e):1===this.mode?this.executeOrQueueCrossDomainRequest(f.u.Query,e):this.executeQueryDirect(e),e.postMessageId},e.prototype.executeQueryDirect=function(t){var n=this,r=u.buildUrl(this.url,"_api/contextinfo");r=u.encodeUrlForXmlHttpRequest(r),e.ensureFormDigest(this.url,r,this.formDigestHandlingEnabled,t,(function(e,t){return n.executeQueryUsingXMLHttpRequest(e,t)}))},e.ensureFormDigest=function(t,n,a,o,l){t=t.toLowerCase();var c=new Date;if(!a||"GET"===o.method.toUpperCase()||null!=e.sFormDigestExpirationCache[t]&&e.sFormDigestExpirationCache[t]>c.getTime())l(e.sFormDigestValueCache[t],o);else{var p=u.getXMLHttpRequest();p.open("POST",n),p.setRequestHeader("accept","application/json;odata=verbose");var d=Date.now(),h=0;o.timeout>0&&(h=window.setTimeout((function(){p.onreadystatechange=function(){};try{p.abort()}catch(e){}u.reportSimpleError(o,-1001,s.fL,"ensureFormDigest"),(0,i.jl)().serverRequest(f.u.Query,o.method,null,o.url,-1001,o.isTokenGeneratedFromWorkload)}),o.timeout)),p.onreadystatechange=function(){if(4===p.readyState){var n=Date.now()-d;if(0!==h&&window.clearTimeout(h),p.onreadystatechange=function(){},200!==p.status||null===p.getResponseHeader("content-type")||p.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){var a=(0,r.Uw)(s.vK,p.status.toString(),p.getResponseHeader("content-type"));u.reportSimpleError(o,-1002,a),(0,i.jl)().tag("RequestExecutor_UnexpectedResponse",6,-1002,p.status.toString(),p.getResponseHeader("content-type")),(0,i.jl)().serverRequest(f.u.Query,o.method,null,o.url,-1002,o.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(p))}else{var c=JSON.parse(p.responseText);if(null!=c){var g=c.d.GetContextWebInformation.FormDigestValue,m=c.d.GetContextWebInformation.FormDigestTimeoutSeconds,S=(new Date).getTime()+750*m;e.sFormDigestValueCache[t]=g,e.sFormDigestExpirationCache[t]=S,l(g,o),(0,i.jl)().serverRequest(f.u.Query,o.method,null,o.url,p.status,o.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(p))}else u.reportSimpleError(o,-1002,s.OX),(0,i.jl)().tag("RequestExecutor_UnableToParseJson",6,-1002,s.OX,p.status.toString(),p.responseText),(0,i.jl)().serverRequest(f.u.Query,o.method,null,o.url,-1002,o.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(p))}}},p.send("")}},e.prototype.executeOrQueueCrossDomainRequest=function(t,n){a.isBrowserIE()&&e.sIFrameInstanceCode[this.appWebProxyUrl]===d.o.TokenFactory||(e.sMessageListenerAttached=!!e.sMessageListenerAttached||u.ensureAttachMessageListener(e.internalOnMessage),e.fireDataWatchSentCallback(n),n.postMessageId=e.getPostMessageId(),this.canExecuteNow?this.executeCommandByIFrame(t,this.appWebProxyUrl,n):e.addToRequestExecutorQueue(this,n))},e.prototype.executeCommandByIFrame=function(t,n,r){var a={command:t,postMessageId:r.postMessageId,appWebProxyUrl:n,requestInfo:r,timeoutId:null},i=e.sPendingRequestInfo[n];null==i&&(i=[],e.sPendingRequestInfo[n]=i),e.sPostMessageIdToRequestInfoMap[a.postMessageId]=a,a.requestInfo.timeout>0&&(a.timeoutId=window.setTimeout((function(){return e.internalProcessIFrameRequestTimeoutCallback(a.postMessageId)}),a.requestInfo.timeout));var o=u.getFrameElement(e.sIFrameInstanceCode[n]);null!=o?e.sFrameLoaded[n]&&e.sFramePinged[n]?e.sendPostMessage(a):i.push(a):(i.push(a),o=e.createIFrame(n))},e.createIFrame=function(t){var n=e.sIFrameInstanceCode[t],r=u.getFrameID(n);switch(n){case d.o.OWA:(0,i.jl)().perfMarker("OwaIframeLoadStarted");break;case d.o.TokenFactory:(0,i.jl)().perfMarker("TokenFactoryIframeLoadStarted")}var a=document.createElement("iframe");a.src=t,a.id=r,a.name=r,a.style.display="none",a.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");a.addEventListener("load",(function(){e.internalProcessIFrameOnload(t)})),document.body.appendChild(a);var o=window.setTimeout((function(){delete e.sFrameLoadTimeoutId[t],e.processPingTimeoutOrIFrameLoadTimeout(t)}),this.IFrameLoadTimeout);return e.sFrameLoadTimeoutId[t]=o,a},e.prototype.executeQueryUsingXMLHttpRequest=function(t,n){var r=u.getXMLHttpRequest(),a=u.encodeUrlForXmlHttpRequest(n.url);r.open(n.method,a);var o=!1;if(null!=n.headers)for(var l=0,p=Object.keys(n.headers);l<p.length;l++){var d=p[l];null!=d&&(r.setRequestHeader(d,n.headers[d]),"x-requestdigest"===d.toLowerCase()&&(o=!0))}o||null==t||r.setRequestHeader("X-RequestDigest",t),n.binaryStringResponseBody&&(r.responseType="arraybuffer");var h=0;n.timeout>0&&(h=window.setTimeout((function(){return e.internalProcessXMLHttpRequestTimeoutCallback(r,n)}),n.timeout)),r.onreadystatechange=function(){return e.internalProcessXMLHttpRequestOnreadystatechange(r,n,h)};var g=n.body;if(n.binaryStringRequestBody&&(g=u.convertBinaryStringToXmlHttpRequestBody(n.body)),null!=this.beforeSendRequest&&this.beforeSendRequest(r,null,null),!c.W.isAllowedApi(a))return u.reportSimpleError(n,-1009,s.H1),void(0,i.jl)().serverRequest(f.u.Query,n.method,null,a,-1009);e.fireDataWatchSentCallback(n),n.requestSentTime=Date.now(),r.send(g)},e.sendPostMessage=function(t){u.validateField(t.postMessageId,"requestInfo.postMessageId",u.StringTypeString,!0),u.validateField(t.appWebProxyUrl,"requestInfo.appWebProxyUrl",u.StringTypeString,!0);var n=u.getFrameElement(e.sIFrameInstanceCode[t.appWebProxyUrl]);if(null==n)throw(0,i.jl)().tag("RequestExecutor_IFrameNull",6,-2002,s.Dm,t.appWebProxyUrl),new o.F(s.Dm,-2002);null==e.sPostMessageIdToRequestInfoMap&&(e.sPostMessageIdToRequestInfoMap={}),e.sPostMessageIdToRequestInfoMap[t.postMessageId]=t;var r={command:t.command,url:t.requestInfo.url,resource:t.requestInfo.resource,method:t.requestInfo.method,body:t.requestInfo.body,headers:t.requestInfo.headers,postMessageId:t.postMessageId,timeout:t.requestInfo.timeout,binaryStringRequestBody:t.requestInfo.binaryStringRequestBody,binaryStringResponseBody:t.requestInfo.binaryStringResponseBody,requestObject:t.requestInfo.requestObject,getPerformanceTrace:t.requestInfo.getPerformanceTrace},a=JSON.stringify(r),l=t.appWebProxyUrl;t.requestInfo.requestSentTime=Date.now(),g.e.isUnitTestMode||n.contentWindow.postMessage(a,l)},e.getPostMessageId=function(){return e.sPostMessageIdCount++,u.PostMessageIdPrefix+e.sPostMessageIdCount.toString()},e.internalProcessWindowLoad=function(){e.sWindowLoadCalled=!0;var t=e.sRequestExecutorQueue;e.sRequestExecutorQueue=null;var n=e.sRequestExecutorParameterQueue;if(e.sRequestExecutorParameterQueue=null,null!==t)for(var r=0;r<t.length;r++)t[r].executeAsync(n[r])},e.resetMessageListenerAttachedFlag=function(){e.sMessageListenerAttached=!1},e.internalProcessIFrameOnload=function(t){e.sFrameLoaded[t]=!0,null!=e.sFrameLoadTimeoutId[t]&&(window.clearTimeout(e.sFrameLoadTimeoutId[t]),delete e.sFrameLoadTimeoutId[t]),u.ensureAttachMessageListener(e.internalOnMessage),null!=e.sFramePingTimeoutId[t]&&(window.clearTimeout(e.sFramePingTimeoutId[t]),delete e.sFramePingTimeoutId[t]);var n={requestObject:{upn:g.e.Instance.configuration.CurrentUserUpn,puid:g.e.Instance.configuration.CurrentUserPuid,shellConfig:{enableOpx:g.e.Instance.configuration.OpxEnabled}}},r=S("shellver");r&&window.O365ShellBootInfo&&(n.requestObject.overrideRequest=u.buildIframeResourceData(r,window.O365ShellBootInfo));var a={command:f.u.Ping,postMessageId:e.getPostMessageId(),appWebProxyUrl:t,timeoutId:-1,requestInfo:n};e.sPostMessageIdToRequestInfoMap[a.postMessageId]=a;var i=window.setTimeout((function(){delete e.sFrameLoadTimeoutId[t],e.processPingTimeout(a.postMessageId,t)}),e.IFramePingTimeout);a.timeoutId=i,g.e.isUnitTestMode||(e.sFramePingTimeoutId[t]=i),e.sendPostMessage(a)},e.internalOnMessage=function(t){if(null!=t){var n=t.origin,r=t.data;if(null!=n&&""!==n&&null!=r&&""!==r)try{var a=JSON.parse(r);e.isPostMessageResponseInfo(a)&&e.onResponseMessageReceived(n,a)}catch(t){}}},e.isPostMessageResponseInfo=function(e){var t=e;return null!=t.postMessageId&&null!=t.command},e.onResponseMessageReceived=function(t,n){var r=Date.now();if(null!=e.sPostMessageIdToRequestInfoMap&&null!=n.postMessageId){var a=e.sPostMessageIdToRequestInfoMap[n.postMessageId];if(null!=a){var o=u.getUrlDomainPart(t,!0),s=u.getUrlDomainPart(a.appWebProxyUrl,!0);if(o.toLowerCase()===s.toLowerCase()){var l=n.postMessageId,c=r-a.requestInfo.requestSentTime,p=n.command===f.u.Query&&0===n.errorCode&&3===n.readyState,d=n.command===f.u.Notification&&null==n.errorMessage;if(p||d||(delete e.sPostMessageIdToRequestInfoMap[l],null!=a.timeoutId&&(window.clearTimeout(a.timeoutId),a.timeoutId=0,delete a.timeoutId)),n.command===f.u.Ping)e.processPingMessage(a.appWebProxyUrl,n),e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,n),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,e.sIFrameInstanceCode[a.appWebProxyUrl].toString(),u.getUrlDomainPart(a.appWebProxyUrl),0===n.errorCode?200:n.errorCode,a.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0);else if(n.command===f.u.Query){var h={responseAvailable:n.responseAvailable,body:n.responseText||"",statusCode:n.statusCode,statusText:n.statusText,contentType:n.contentType,state:a.requestInfo.state,allResponseHeaders:n.allResponseHeaders,headers:u.parseResponseHeaders(n.allResponseHeaders),binaryStringResponseBody:n.binaryStringResponseBody},g=0,m=null;0!==n.errorCode?(g=n.errorCode,m=n.errorMessage):n.statusCode>=200&&n.statusCode<300||1223===n.statusCode||(g=-1003,m=n.statusCode),0===g?4===n.readyState?(h.performanceTrace=n.performanceTrace,null!=a.requestInfo.success&&a.requestInfo.success(h),e.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,h,0,null),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,e.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,n.statusCode,a.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0)):3===n.readyState&&null!=a.requestInfo.loading&&a.requestInfo.loading(h):4!==n.readyState&&0!==n.readyState&&null!=n.readyState||(h.performanceTrace=n.performanceTrace,null!=a.requestInfo.error&&a.requestInfo.error(h,g,m),(0,i.jl)().tag("RequestExecutor_IFrameError",4,g,m),e.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,h,g,m),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,e.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,g,a.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0))}else if(n.command===f.u.Storage||n.command===f.u.TokenPrefetch||n.command===f.u.OwaUserConfig){h={responseObject:n.responseObject},g=n.errorCode,m=n.errorMessage;0===g&&u.isNullOrEmptyString(m)?(null!=a.requestInfo.success&&a.requestInfo.success(h),e.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,h,0,null)):(null!=a.requestInfo.error&&a.requestInfo.error(h,g,m),e.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,h,g,m)),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,e.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,0!==g?g:200,a.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0)}else n.command===f.u.Notification?(0!==n.errorCode&&null!=a.requestInfo.error&&a.requestInfo.error({responseObject:n.responseObject},n.errorCode,n.errorMessage),e.NotificationCallback(JSON.stringify(n.responseObject)),e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,n)):n.command===f.u.RegisterOpxHost&&null!=a.requestInfo.success&&a.requestInfo.success(null)}}}},e.internalProcessXMLHttpRequestTimeoutCallback=function(t,n){t.onreadystatechange=function(){};try{t.abort()}catch(e){}u.reportSimpleError(n,-1001,s.fL,"XMLHttpRequest"),(0,i.jl)().serverRequest(f.u.Query,n.method,null,n.url,-1001),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,null,-1001,s.fL)},e.internalProcessXMLHttpRequestOnreadystatechange=function(t,n,r){if(4===t.readyState){var a=Date.now();0!==r&&window.clearTimeout(r),t.onreadystatechange=function(){};var o={state:n.state,responseAvailable:!0,body:n.binaryStringResponseBody?u.convertArrayBufferToBinaryString(t.response):t.responseText,statusCode:t.status,statusText:t.statusText,contentType:t.getResponseHeader("content-type"),allResponseHeaders:t.getAllResponseHeaders(),headers:u.parseResponseHeaders(t.getAllResponseHeaders()),performanceTrace:null},s=a-n.requestSentTime;if(n.getPerformanceTrace){var l=performance.getEntriesByName(n.url);null!=l&&l.length>0&&(o.performanceTrace=l[0])}t.status>=200&&t.status<300||1223===t.status?(null!=n.success&&n.success(o),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,o,0,null),(0,i.jl)().serverRequest(f.u.Query,n.method,null,n.url,o.statusCode,n.isTokenGeneratedFromWorkload,s,u.getXMLHttpResponseLength(t))):(null!=n.error&&n.error(o,-1003,t.statusText),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,o,-1003,t.statusText),(0,i.jl)().serverRequest(f.u.Query,n.method,null,n.url,t.status,n.isTokenGeneratedFromWorkload,s,u.getXMLHttpResponseLength(t)))}},e.isCurrentSiteInTrustOrLocalZone=function(){if(!e.isTrustedSiteEvaluated){if(a.isBrowserIE()){var t=window.status,n=window.status+(new Date).getTime();window.status=n,e.isTrustedSite=window.status===n,window.status=t}e.isTrustedSiteEvaluated=!0}return e.isTrustedSite},e.processPingTimeout=function(t,n){null!=e.sPostMessageIdToRequestInfoMap[t]&&(e.sFramePinged[n]||((0,i.jl)().tag("PingTimeout",0,e.sIFrameInstanceCode[n].toString()),e.sPostMessageIdToRequestInfoMap[t]=null,delete e.sPostMessageIdToRequestInfoMap[t],e.processPingTimeoutOrIFrameLoadTimeout(n)))},e.processPingTimeoutOrIFrameLoadTimeout=function(t){switch(e.sIFrameInstanceCode[t]){case d.o.OWA:(0,i.jl)().perfMarker("OwaIframeLoadFailed");break;case d.o.TokenFactory:(0,i.jl)().perfMarker("TokenFactoryIframeLoadFailed")}var n=u.getUrlDomainPart(t,!0);if(n.toLowerCase()===u.getUrlDomainPart(g.e.Instance.configuration.SuiteServiceUrl,!0)){var a=e.isCurrentSiteInTrustOrLocalZone()?l.v.SecurityZoneMismatched:l.v.IframeLoadError;h.t.Instance.blockSuiteServiceCalls(a,n)}var o=(0,r.Uw)(s.EE,n);e.reportFrameLoadError(t,o)},e.reportFrameLoadError=function(t,n,r){void 0===r&&(r=-1007),e.sFrameLoadError[t]=!0;var a=e.sPendingRequestInfo[t];e.sPendingRequestInfo[t]=[];var o=!1;if(o=e.isTrustedSiteEvaluated?e.isTrustedSite:e.isCurrentSiteInTrustOrLocalZone(),(0,i.jl)().tag("RequestExecutor_IFrameLoadError",4,r,n,"isTrustedSite: "+o),null!=e.sFrameLoadTimeoutId[t]&&(window.clearTimeout(e.sFrameLoadTimeoutId[t]),delete e.sFrameLoadTimeoutId[t]),e.removeIFrame(t),null!=a)for(var s=0,l=a;s<l.length;s++){var c=l[s],p=c.postMessageId;null!=e.sPostMessageIdToRequestInfoMap[p]&&(e.sPostMessageIdToRequestInfoMap[p]=null,delete e.sPostMessageIdToRequestInfoMap[p],null!=c.timeoutId&&window.clearTimeout(c.timeoutId),u.reportSimpleError(c.requestInfo,r,n),(0,i.jl)().serverRequest(c.command,c.requestInfo.method,e.sIFrameInstanceCode[t].toString(),c.requestInfo.url,-1007))}},e.removeIFrame=function(t){var n=u.getFrameElement(e.sIFrameInstanceCode[t]);null!=n&&null!=n.parentNode&&n.parentNode.removeChild(n),null!=e.sPendingRequestInfo&&delete e.sPendingRequestInfo[t],null!=e.sFrameLoadTimeoutId&&delete e.sFrameLoadTimeoutId[t],null!=e.sFrameLoaded&&delete e.sFrameLoaded[t],null!=e.sFramePinged&&delete e.sFramePinged[t],null!=e.sFramePingTimeoutId&&delete e.sFramePingTimeoutId[t],null!=e.sFrameLoadError&&delete e.sFrameLoadError[t]},e.processPingMessage=function(t,n){switch(e.sIFrameInstanceCode[t]){case d.o.OWA:(0,i.jl)().perfMarker("OwaIframeLoadCompleted");break;case d.o.TokenFactory:(0,i.jl)().perfMarker("TokenFactoryIframeLoadCompleted")}if(n.errorCode&&0!==n.errorCode)e.reportFrameLoadError(t,n.errorMessage,n.errorCode);else{e.sFramePinged[t]=!0;var r=e.sPendingRequestInfo[t];if(null!=r){e.sPendingRequestInfo[t]=[];for(var a=0,o=r;a<o.length;a++){var s=o[a];null!=e.sPostMessageIdToRequestInfoMap[s.postMessageId]&&e.sendPostMessage(s)}}}},e.addToRequestExecutorQueue=function(t,n){null===e.sRequestExecutorQueue&&(e.sRequestExecutorQueue=[]),null===e.sRequestExecutorParameterQueue&&(e.sRequestExecutorParameterQueue=[]),e.sRequestExecutorQueue.push(t),e.sRequestExecutorParameterQueue.push(n)},e.fireDataWatchSentCallback=function(t){null!==e.DataWatchSentCallback&&(e.DataWatchRequestId++,t.dataRequestId=e.DataWatchRequestId,e.DataWatchSentCallback(e.DataWatchRequestId,t))},e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo=function(t,n){if(null!=e.DataWatchReceivedCallback){var r={body:n.responseText,responseAvailable:n.responseAvailable,statusCode:n.statusCode,statusText:n.statusText,contentType:n.contentType,allResponseHeaders:n.allResponseHeaders,headers:u.parseResponseHeaders(n.allResponseHeaders),binaryStringResponseBody:n.binaryStringResponseBody,responseObject:n.responseObject,state:t.state,performanceTrace:n.performanceTrace};e.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,n.errorCode,n.errorMessage)}},e.fireDataWatchReceivedCallbackGivenResponseInfo=function(t,n,r,a){null!==e.DataWatchReceivedCallback&&null!=t.dataRequestId&&e.DataWatchReceivedCallback(t.dataRequestId,n,r,a)},e.DefaultTimeout=6e4,e.IFrameLoadTimeout=15e3,e.IFramePingTimeout=1e4,e.sPendingRequestInfo={},e.sFrameLoaded={},e.sFramePinged={},e.sFramePingTimeoutId={},e.sFrameLoadTimeoutId={},e.sFrameLoadError={},e.sPostMessageIdToRequestInfoMap={},e.sIFrameInstanceCode={},e.sFormDigestValueCache={},e.sFormDigestExpirationCache={},e.sPostMessageIdCount=0,e.sWindowLoadCalled=!1,e.sRequestExecutorQueue=[],e.sRequestExecutorParameterQueue=[],e.DataWatchSentCallback=null,e.DataWatchRequestId=0,e.DataWatchReceivedCallback=null,e}()},84185:function(e,t,n){"use strict";n.d(t,{Ou:function(){return l}});var r=n(62244),a=n(41018),i=n(79487),o=n(56597),s=n(17698),u="SuiteServiceProxy.aspx",l=function(){function e(){}return Object.defineProperty(e,"OwaInstance",{get:function(){return null==e.suiteSvcInstance?e.createOwaRequestExecutor():e.suiteSvcInstance},enumerable:!1,configurable:!0}),Object.defineProperty(e,"OauthTokenFactoryInstance",{get:function(){return null==e.tokenFactoryInstance?e.createOauthTokenFactoryRequestExecutor():e.tokenFactoryInstance},enumerable:!1,configurable:!0}),e.setOauthTokenFactoryInstanceForTesting=function(t){s.e.isUnitTestMode&&(e.tokenFactoryInstance=t)},e.resetAllInstancesForTesting=function(){e.tokenFactoryInstance=null,e.suiteSvcInstance=null},e.createOauthTokenFactoryRequestExecutor=function(){if(s.e.assertInitialized(),null!=s.e.Instance.configuration.TokenFactoryIframeOrigin){var t=(0,r.Uw)("{0}//{1}",window.location.protocol,window.location.host),n=(0,r.Uw)(e.TokenFactoryIframePath,encodeURIComponent(t),encodeURIComponent(s.e.Instance.configuration.ShellSID),encodeURIComponent(e.TokenFactoryIframeApiVersion),encodeURIComponent(s.e.Instance.configuration.ClientShellVersion));n+="&upn=".concat(encodeURIComponent(s.e.Instance.configuration.CurrentUserUpn));var a="https://consumer.suite.office.com"===s.e.Instance.configuration.TokenFactoryIframeOrigin;e.tokenFactoryInstance=new o.K(i.o.TokenFactory,s.e.Instance.configuration.TokenFactoryIframeOrigin,n,a)}return e.tokenFactoryInstance},e.createOwaRequestExecutor=function(){if(s.e.assertInitialized(),null!=s.e.Instance.suiteServiceHostPageBaseUrl&&s.e.Instance.configuration.UserHasExchangeLicense){var t=void 0;t=s.e.Instance.configuration.HintUserName?(0,r.Uw)("{0}?suiteServiceUserName={1}&{2}={3}&{4}",u,encodeURIComponent(s.e.Instance.configuration.CurrentUserUpn),e.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),e.SuiteServiceProxyIframeApiVersion):(0,r.Uw)("{0}?{1}={2}&{3}",u,e.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),e.SuiteServiceProxyIframeApiVersion),e.suiteSvcInstance=new o.K(i.o.OWA,s.e.Instance.suiteServiceHostPageBaseUrl,t),e.suiteSvcInstance.setBeforeSendRequestAction(a.W.onBeforeSendRequestSuiteService)}return e.suiteSvcInstance},e.TokenFactoryIframePath="/iframe/TokenFactoryIframe?origin={0}&shsid={1}&apiver={2}&cshver={3}",e.TokenFactoryIframeApiVersion="oneshell",e.SuiteServiceProxyIframeApiVersion="apiver=1",e.SuiteServiceReturnUrlParam="suiteServiceReturnUrl",e}()},39013:function(e,t,n){"use strict";n.d(t,{t:function(){return y}});var r=n(91011),a=n(9028),i=n(62244),o=n(32964),s=n(25889),u=n(9264),l=n(85884),c=n(2221),p=n(17698),d=function(){function e(e){this.service=e,this.NumMinutesToADReplication=2}return e.prototype.setTargetServerReceivedTime=function(e){if(!p.e.isUnitTestMode)throw new o.P("Operation not allowed if it is not a unit test",-2002);this.targetServerReceivedTime=e},e.prototype.beforeSuiteServiceCall=function(t){null!=this.targetServer&&((new Date).getTime()-this.targetServerReceivedTime.getTime()<=60*this.NumMinutesToADReplication*1e3&&(t[e.TargetServerHeader]=this.targetServer))},e.prototype.afterSuiteServiceSuccess=function(t){null==this.targetServer&&null!=t[e.TargetServerHeader]&&(this.targetServer=t[e.TargetServerHeader],this.targetServerReceivedTime=new Date)},e.prototype.afterSuiteServiceError=function(t,n){null!=t[y.XSuiteError]&&t[y.XSuiteError]===e.ShardNotFoundException?(this.service.blockSuiteServiceCalls(l.v.ShardNotDetected),n(c.convertErrorToException(null,-1010,l.v.ShardNotDetected.toString()))):n(t)},e.TargetServerHeader="X-TARGETSERVER",e.ShardNotFoundException="InvalidOrUnavailableMailboxException",e}(),f=n(56597),h=n(84185),g=n(84686),m=function(){function e(){var e=this;this.handleMessage=function(t){var n=!1;if(null!=t)for(var r=0;!n&&r<e.handlers.length;r++)if(t&&t.data&&t.origin){var a=e.handlers[r];if(a.validateOrigin(t.origin)){var i=t.data;a.validateMessage(i)&&(n=a.handleMessage(i))}}},this.handlers=[],(0,u.ensureAttachMessageListener)(this.handleMessage)}return e.prototype.registerHandler=function(e){this.handlers.push(e)},e}(),S=function(e,t,n){this.RequestExecutor=e,this.RequestInfo=t,this.ErrorCallback=n},y=function(){function e(){this.firstDataRequestSent=!1,this.startupCallbacks=[],this.owsStartupActionCompleted=!1,this.queuedCalls=[],this.messageDispatcher=new m}return Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ConnectionEstablished",{get:function(){return this.owsStartupActionCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AreSuiteServiceCallsBlocked",{get:function(){return null!=this.suiteServiceCallsBlockedReason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShouldQueueOwsCalls",{get:function(){return!this.owsStartupActionCompleted&&!p.e.Instance.configuration.IsOwa},enumerable:!1,configurable:!0}),e.prototype.registerPostMessageHandler=function(e){this.messageDispatcher.registerHandler(e)},e.prototype.setStartupActionCompleted=function(){this.owsStartupActionCompleted=!0;for(var e=0,t=this.queuedCalls;e<t.length;e++){var n=t[e];try{n.RequestExecutor.executeAsync(n.RequestInfo)}catch(e){}}this.queuedCalls=[],this.callStartupCallbacks()},e.setInstanceForTesting=function(e){p.e.isUnitTestMode&&(this.instance=e)},e.prototype.callOwaIframeAction=function(e,t,n){return void 0===n&&(n=!0),this.callOwaIframeActionWithAdditionalHeaders(e,t,null,n)},e.prototype.callOwaIframeResourceUrl=function(t,n,r){var i=this;return new Promise((function(o,l){a.throwOnNullOrEmpty(t,"resourceUrl"),a.throwOnUndefined(r,"method"),null!==i.owaCallsInterceptor||p.e.Instance.configuration.UserHasExchangeLicense||(i.owaCallsInterceptor=new d(i)),r===s.F.PUT&&a.throwOnUndefined(n,"data");var c={};null!==p.e.Instance.configuration.CurrentUserUpn&&(c[e.UPNAnchorMailboxHeaderKey]=p.e.Instance.configuration.CurrentUserUpn);var f=p.e.Instance.configuration.SuiteServiceUrl.replace(u.OwsRelativePath,t);null!=i.owaCallsInterceptor&&i.owaCallsInterceptor.beforeSuiteServiceCall(c);var h=l;null!=i.owaCallsInterceptor&&(h=function(e){i.owaCallsInterceptor.afterSuiteServiceError(e,l)}),i.callOwaIframeWithOrWithoutRetry(f,c,n,r).then((function(e){return o(""!==e?JSON.parse(e):"")})).catch(h)}))},e.prototype.callOwaIframeActionWithAdditionalHeaders=function(t,n,r,o){var u=this;return void 0===o&&(o=!0),new Promise((function(l,c){a.throwOnNullOrEmpty(t,"action"),a.throwOnUndefined(n,"data");var d=p.e.Instance.configuration.SuiteServiceUrl,f="suiteservice.svc",h=-1!==d.toLowerCase().indexOf(f,d.length-16)?"{0}/?action={1}":"{0}?action={1}",g=u.isUserInitiatedCall(t)?t:t+"&UA=0",m=(0,i.Uw)(h,d,g);null===r&&(r={}),r[e.ActionHeaderKey]=t,u.callOwaIframeWithOrWithoutRetry(m,r,n,s.F.POST,o).then((function(e){return l(""!==e?JSON.parse(e):"")})).catch(c)}))},e.prototype.prefetchAccessToken=function(e,t){void 0===t&&(t=null);var n={url:e,resource:t};return new Promise((function(e,t){n.error=function(e,n,r){t(c.convertErrorToException(e,n,r))},n.success=function(t){return e(t)};var r=h.Ou.OauthTokenFactoryInstance;null!=r&&r.prefetchOAuthAccessToken(n)}))},e.prototype.registerOpxHost=function(e,t,n){return void 0===n&&(n=f.K.DefaultTimeout),new Promise((function(r,a){var i={resource:e,url:t,error:function(e,t,n){a(c.convertErrorToException(e,t,n))},success:function(e){r()},timeout:n},s=h.Ou.OauthTokenFactoryInstance;null==s?a(new o.P("OauthTokenFactoryIframe",-1011)):s.registerOpxHost(i)}))},e.prototype.callOpxIframe=function(e){var t=h.Ou.OauthTokenFactoryInstance;if(null==t)throw new o.P("OauthTokenFactoryIframe",-1011);t.executeOpxRequest(e)},e.prototype.callEndpointWithOauthToken=function(e,t){return new Promise((function(n,r){null==e.body&&(e.body=""),null==e.method&&(e.method="GET"),null==e.headers&&(e.headers={}),e.resource===p.e.Instance.configuration.TokenFactoryIframeOrigin&&(e.headers["x-o365suiteuxshell-workloadid"]=p.e.Instance.configuration.WorkloadId),e.success=function(e){try{var a=void 0;a=null!=e.contentType&&e.contentType.indexOf("application/json")>-1?t?e:JSON.parse(e.body):t?e:e.body,n(a)}catch(e){return void r(new o.P("Invalid response format."))}},e.error=function(e,t,n){r(c.convertErrorToException(e,t,n))};var a=h.Ou.OauthTokenFactoryInstance;null!=a?p.e.Instance.configuration.IsPwa||0===a.mode?g.g.getToken(e).then((function(t){0===t.responseType&&(e.headers.Authorization="Bearer "+t.token,null!=p.e.Instance.configuration.ServiceWorkerCacheId&&null!=p.e.Instance.configuration.ServiceWorkerCacheId&&(e.headers["X-SW-OHP-UserCacheId"]=p.e.Instance.configuration.ServiceWorkerCacheId,e.headers["X-SW-OHP-FetchStrategy"]=p.e.Instance.configuration.ServiceWorkerFetchStrategy),e.isTokenGeneratedFromWorkload=!0,delete e.headers["x-o365suiteuxshell-workloadid"],a.executeCrossDomainRequestAsync(e,!0))})).catch((function(t){1===t.responseType&&a.executeCrossDomainRequestAsync(e)})):a.executeCrossDomainRequestAsync(e):r(new o.P("OauthTokenFactoryIframe",-1011))}))},e.prototype.callWebClientShellServiceFunction=function(e,t,n,r){var a=(0,i.Uw)("{0}/{1}",p.e.Instance.configuration.TokenFactoryIframeOrigin,"/"===e.charAt(0)?e.substr(1):e);null==n&&(n={}),"Content-Type"in n||(n["Content-Type"]="application/json;charset=UTF-8"),"Accept"in n||(n.Accept="application/json");var o={method:t,url:a,resource:p.e.Instance.configuration.TokenFactoryIframeOrigin,body:JSON.stringify(r),headers:n};return this.callEndpointWithOauthToken(o)},e.prototype.owaSessionStorageRequest=function(e){var t=this;return new Promise((function(n,r){if(a.throwOnUndefined(e,"data"),t.shouldBlockCall(4))r(new o.P("SuiteService",-1011));else{var i={url:p.e.Instance.suiteServiceHostPageBaseUrl,requestObject:e,timeout:3e4,success:function(e){return n(e.responseObject)},error:function(e,t,n){return r(new o.P(n,-2002))}},s=h.Ou.OwaInstance;null==s?r(new o.P("SuiteService",-1011)):s.executeStorageRequest(i)}}))},e.prototype.callOwaIframeWithOrWithoutRetry=function(t,n,r,a,i){var s=this;void 0===i&&(i=!0);var u={};if(null!=n)for(var l=0,d=Object.keys(n);l<d.length;l++){var f=d[l];u[f]=n[f]}u.Accept="application/json",u["Content-Type"]="application/json; charset=utf-8";var g=p.e.Instance.MailboxGuid,m=p.e.Instance.configuration.ShellSID,S=g||m,y=c.generateCorrelationId(S);u["X-OWA-CorrelationId"]=y;var v=JSON.stringify(r);return new Promise((function(r,l){if(null!=s.suiteServiceCallsBlockedReason){var p=new o.P(s.suiteServiceCallsBlockedReason,-1010);return l(p)}var d=h.Ou.OwaInstance;if(null!==d){s.firstDataRequestSent||(!0,s.firstDataRequestSent=!0);var f=function(e){null!=s.owaCallsInterceptor&&s.owaCallsInterceptor.afterSuiteServiceSuccess(e.headers),r(e.body)};s.owaHttpRequest(d,t,v,u,a).then(f).catch(i?function(r){449===r.HttpStatus?s.owaHttpRequest(d,t,v,u,a).then(f).catch((function(e){return s.executeErrorCallback(n,l,e)})):null!=r[e.XSuiteError]&&r[e.XSuiteError]===e.WrongServerException?(y=c.generateCorrelationId(S),u["X-OWA-CorrelationId"]=y,s.owaHttpRequest(d,t,v,u,a).then((function(e){f(e)})).catch((function(e){s.executeErrorCallback(n,l,e)}))):l(r)}:function(){l()})}else s.executeErrorCallback(n,l,c.convertErrorToException(null,-1011,"OwaIframe"))}))},e.prototype.owaHttpRequest=function(t,n,i,o,u){var p=this;return new Promise((function(d,f){if(a.throwOnNullOrUndefined(n,"url"),p.shouldBlockCall(p.getExchangeServiceToCall(n)))return f(c.convertErrorToException(null,-1010,p.suiteServiceCallsBlockedReason));var h=null,g={headers:o,url:n,method:u.toString(),body:u!==s.F.GET?i:void 0,success:function(e){var t=c.getOwaError(e.headers);if(null!=t)return p.checkAndHandleBlockingOwaErrors(t),void f(c.convertErrorToException(e,e.statusCode,t));try{d(e)}catch(e){}null!=h&&h()},error:function(t,n,a){var i=c.getOwaError(t.headers);null!=i&&p.checkAndHandleBlockingOwaErrors(i),t.statusCode!==e.HttpStatusCodeTokenExpired&&t.statusCode!==e.HttpStatusCodeUnauthorized||(p.blockSuiteServiceCalls(l.v.TokenExpired,n,a),(0,r.Lo)().invoke("AuthenticationExpired")),f(c.convertErrorToException(t,n,a))}};if(p.ShouldQueueOwsCalls)if(p.isStartupAction(o))h=function(){p.setStartupActionCompleted(),h=null};else if(2===p.getExchangeServiceToCall(g.url))return void p.queuedCalls.push(new S(t,g,f));t.executeAsync(g)}))},e.prototype.registerAuthenticationExpiredCallback=function(e){(0,r.Lo)().subscribe("AuthenticationExpired",e,!0)},e.prototype.registerCultureNotSetCallback=function(e){(0,r.Lo)().subscribe("CultureNotSet",e,!0)},e.prototype.guaranteeConnectionEstablished=function(e){this.ConnectionEstablished||p.e.Instance.configuration.IsOwa?e():this.startupCallbacks.push(e)},e.prototype.blockSuiteServiceCalls=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];
// the more important blocking reasons are evaluated first e.g. NoExoLicense etc
null!=this.suiteServiceCallsBlockedReason&&e!==l.v.ShardNotDetected||(this.suiteServiceCallsBlockedReason=e.toString(),(0,r.jl)().tag("RequestExecuter_SuiteServiceCallsBlocked",4,l.v[e],t))},e.prototype.stopBlockingCalls=function(){this.suiteServiceCallsBlockedReason=null},e.prototype.callStartupCallbacks=function(){for(var e=0,t=this.startupCallbacks;e<t.length;e++){var n=t[e];null!=n&&n()}this.startupCallbacks=[]},e.prototype.checkAndHandleBlockingOwaErrors=function(e){e.indexOf("OwaInvalidUserLanguageException")>-1?(this.blockSuiteServiceCalls(l.v.LanguageNotSet,e),(0,r.Lo)().invoke("CultureNotSet")):"InvalidMailbox"===e?this.blockSuiteServiceCalls(l.v.InvalidMailbox,e):"ShardMailbox"===e&&this.blockSuiteServiceCalls(l.v.ShardMailbox,e)},e.prototype.getExchangeServiceToCall=function(e){var t=null!=e?u.getUrlPath(e):null;if(t){var n=function(e,t){return e.substr(0,t.length)===t};if(n(t,u.SuiteServiceApiRelativePath))return 3;if(n(t,u.OwsRelativePath))return 2;if(n(t,u.DevFabricOwsRelativePath))return 2}var a=new Error("Cannot Acquire Exchange Service to Call");throw(0,r.jl)().exception("Service_ExchangeServiceAcquireFail",6,a,t),a},e.prototype.shouldBlockCall=function(t){return null!=this.suiteServiceCallsBlockedReason&&!(2!==t&&e.callBlockingReasonsSpecificToOws.indexOf(this.suiteServiceCallsBlockedReason))},e.prototype.executeErrorCallback=function(e,t,n){try{t(n)}catch(e){}if(!this.owsStartupActionCompleted&&this.isStartupAction(e)){var r=n.errorCode||0,a=-1005===r?l.v.CallerOriginNotAllowed:l.v.InitFailed;this.blockSuiteServiceCalls(a,r,n.message);for(var i=c.convertErrorToException(null,-1010,"App initialization failed, call canceled",r,n.message),o=0,s=this.queuedCalls;o<s.length;o++){var u=s[o];try{u.ErrorCallback(i)}catch(e){}}this.queuedCalls=[]}},e.prototype.isUserInitiatedCall=function(t){return e.userInitiatedCalls.indexOf(t.toLowerCase())>=0},e.prototype.isStartupAction=function(t){var n=p.e.Instance.configuration.StartupActionName;return null!=n&&n===t[e.ActionHeaderKey]},e.ActionHeaderKey="Action",e.UPNAnchorMailboxHeaderKey="X-UpnAnchorMailbox",e.XSuiteError=c.XSuiteError,e.HttpStatusCodeUnauthorized=401,e.HttpStatusCodeTokenExpired=440,e.WrongServerException="WrongServerException",e.instance=new e,e.callBlockingReasonsSpecificToOws=[l.v.LanguageNotSet.toString(),l.v.InitFailed.toString(),l.v.InvalidMailbox.toString(),l.v.ShardMailbox.toString()],e.userInitiatedCalls=["getowauserconfiguration"],e}()},17698:function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var r=function(){function e(e){this.suiteServiceHostPageBaseUrl=e.SuiteServiceUrl.substring(0,e.SuiteServiceUrl.lastIndexOf("/")),this.configuration=e}return e.Initialize=function(t){this.instance=new e(t)},Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),e.assertInitialized=function(){if(null===e.Instance)throw new Error("SessionData not initialized.")},e.isUnitTestMode=!1,e}()},84686:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r=n(91011),a=n(17698),i=function(){function e(){}return e.getToken=function(e){return new Promise((function(t,n){if(a.e.Instance.configuration.GetTokenRequestDictionary){var i=a.e.Instance.configuration.GetTokenRequestDictionary(),o=function(e){e?t({token:e,responseType:0}):((0,r.jl)().tag("GetAccessToken_Empty",6),n({responseType:2}))},s=function(e){(0,r.jl)().exception("GetAccessToken_Failed",6,e),n({responseType:2,exception:e})};if(i[e.resource]){var u=i[e.resource];"function"==typeof u?u().then((function(e){o(e)})).catch((function(e){s(e)})):u.then((function(e){o(e)})).catch((function(e){s(e)}))}else n({responseType:1})}else n({responseType:1})}))},e}()},15312:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var r,a=n(77224),i=n(62244),o=n(9264),s='{ "kty": "oct", "k": "{0}", "extractable": true }',u=void 0!==typeof btoa,l=function(){function e(){}return e.loadCryptoModule=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){return[2,new Promise((function(e){void 0!==r?e():null!=window.crypto?(r=window.crypto,e()):n.e("msrcrypto").then(n.t.bind(n,95384,23)).then((function(t){r=t,e()}))}))]}))}))},e.computeSHA256=function(t,n){return void 0===n&&(n=!0),(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.loadCryptoModule()];case 1:return a.sent(),[2,new Promise((function(a,i){try{var o=e.textToUInt8Array(t,n),s=r.subtle.digest({name:"SHA-256"},o);s.then((function(t){if(e.verifyResult(t,i)){var n=Array.prototype.map.call(new Uint8Array(t),(function(e){return("00"+e.toString(16)).slice(-2)})).join("");a(e.toBase64(n))}}),(function(t){e.verifyResult(t,i)&&i(t.toString())}))}catch(e){i(e.toString())}}))]}}))}))},e.encryptAES=function(t,n,o){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.loadCryptoModule()];case 1:return a.sent(),[2,new Promise((function(a,u){try{var l=(0,i.Uw)(s,e.base64ToBase64Url(t)),c=r.subtle.importKey("jwk",JSON.parse(l),{name:"AES-CBC"},!0,["encrypt","decrypt"]);c.then((function(t){try{var i=t,s=e.textToUInt8Array(e.base64ToString(n),!1),l=e.textToUInt8Array(o,!0),c={name:"AES-CBC",iv:s},p=r.subtle.encrypt(c,i,l);p.then((function(t){try{e.verifyResult(t,u)&&a(e.toBase64(e.bytesToText(t,!1)))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t)}))}catch(e){u(e.toString())}}))]}}))}))},e.decryptAES=function(t,n,o){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.loadCryptoModule()];case 1:return a.sent(),[2,new Promise((function(a,u){try{var l=(0,i.Uw)(s,e.base64ToBase64Url(t)),c=r.subtle.importKey("jwk",JSON.parse(l),{name:"AES-CBC"},!0,["encrypt","decrypt"]);c.then((function(t){try{var i=t,s=e.textToUInt8Array(e.base64ToString(n),!1),l=e.textToUInt8Array(e.base64ToString(o),!1),c={name:"AES-CBC",iv:s},p=r.subtle.decrypt(c,i,l);p.then((function(t){try{e.verifyResult(t,u)&&a(e.bytesToText(t,!0))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}))]}}))}))},e.textToUInt8Array=function(e,t){e=t?encodeURI(e):e;for(var n=[],r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new Uint8Array(n)},e.bytesToText=function(e,t){var n=(0,o.convertArrayBufferToBinaryString)(e);return t?decodeURI(n):n},e.base64ToBase64Url=function(e){return e.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")},e.verifyResult=function(e,t){return null!=e||(t("result undefined"),!1)},e.base64ToString=function(e){if(!u)return r.base64ToString(e);for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return atob(e)},e.toBase64=function(e,t){if(!u)return r.toBase64(e);var n="";return t||(t=!1),n=btoa(e),t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):n},e}()},32964:function(e,t,n){"use strict";n.d(t,{F:function(){return i},P:function(){return a}});var r=n(77224),a=function(e,t,n){if(void 0===e&&(e=""),this.message=e,this.errorCode=t,this.errorInfo=n,this.name="ShellException",null!=n)for(var r=0,a=Object.keys(n);r<a.length;r++){var i=a[r];this[i]=n[i]}},i=function(e){function t(t,n,r){void 0===t&&(t="");var a=e.call(this,t,n,r)||this;return a.message=t,a.errorCode=n,a.errorInfo=r,a.name="RequestExecutorException",a}return(0,r.__extends)(t,e),t}(a)},25889:function(e,t,n){"use strict";n.d(t,{F:function(){return r}});var r=function(){function e(){}return e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE",e}()},89990:function(e,t,n){"use strict";n.d(t,{DP:function(){return f},Dm:function(){return h},EE:function(){return o},H1:function(){return d},JP:function(){return g},OH:function(){return u},OX:function(){return c},UU:function(){return l},YG:function(){return s},e1:function(){return a},fL:function(){return r},lq:function(){return i},vK:function(){return p}});var r="Request was aborted or timed out",a="Browser not supported",i="Invalid field or parameter {0}",o="Cannot access {0}",s="Binary data not supported",u="Invalid operation",l="Session storage error",c="Unable to parse json",p="Status:{0}, Content-type:{1}",d="Access denied",f="Timeout due to trusted sites",h="Could not find IFrame element.",g="Message listener is not attached."},9264:function(e,t,n){"use strict";n.r(t),n.d(t,{BooleanTypeString:function(){return p},DevFabricOwsRelativePath:function(){return y},FunctionTypeString:function(){return d},NumberTypeString:function(){return f},OwaIFrameID:function(){return h},OwsRelativePath:function(){return S},PostMessageIdPrefix:function(){return v},StringTypeString:function(){return c},SuiteServiceApiRelativePath:function(){return m},TokenFactoryIFrameID:function(){return g},buildIframeResourceData:function(){return R},buildUrl:function(){return O},checkBrowserBinaryDataSupport:function(){return B},convertArrayBufferToBinaryString:function(){return U},convertBinaryStringToXmlHttpRequestBody:function(){return F},createInvalidParameterException:function(){return w},encodeUrlForXmlHttpRequest:function(){return G},endsWith:function(){return q},ensureAttachMessageListener:function(){return W},getCurrentWindowLocation:function(){return D},getFrameElement:function(){return $},getFrameID:function(){return ee},getUrlAuthorityPart:function(){return k},getUrlDomainPart:function(){return x},getUrlPath:function(){return L},getXMLHttpRequest:function(){return P},getXMLHttpResponseLength:function(){return te},isFullUrl:function(){return I},isNullOrEmptyString:function(){return A},parseQueryString:function(){return N},parseResponseHeaders:function(){return _},reportSimpleError:function(){return j},startsWith:function(){return H},urlEncodeCore:function(){return Y},validateField:function(){return b},validateFullUrl:function(){return T},validateRequestInfo:function(){return E}});var r=n(62244),a=n(91011),i=n(37005),o=n(56597),s=n(32964),u=n(89990),l=n(79487),c="string",p="boolean",d="function",f="number",h="o365shellowaframe",g="o365shellwcssframe",m="O365SuiteService/api/",S="owa/service.svc",y="SuiteService.svc",v="SP.RequestExecutor",C="https://";function b(e,t,n,a){if(a){if(null==e||typeof e!==n)throw new s.F((0,r.Uw)(u.lq,t),-2001)}else if(null!=e&&typeof e!==n)throw new s.F((0,r.Uw)(u.lq,t),-2001)}function I(e){return e.substr(0,C.length).toLowerCase()===C}function T(e,t){if(!I(e))throw w(t)}function D(){return window.location.href}function w(e){return new s.F((0,r.Uw)(u.lq,e),-2001)}function A(e){return""===e||null==e}function O(e,t){if(T(e,"baseUrl"),I(t))return t;if("/"===t.charAt(0)){var n=e.indexOf("://");return(n=e.indexOf("/",n+3))>0&&(e=e.substr(0,n)),e+t}return"/"!==e.charAt(e.length-1)&&(e+="/"),e+t}function x(e,t){void 0===t&&(t=!1),t&&T(e,"url");var n=e.indexOf("://");return(n=e.indexOf("/",n+3))>0&&(e=e.substr(0,n)),e.substr(0,C.length).toLowerCase()===C&&":443"===e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),e}function L(e){var t=x(e),n=e.indexOf("?");return n>t.length+1?e.substring(t.length+1,n):e.substring(t.length+1,e.length)}function k(e){return(e=x(e)).substr(0,C.length).toLowerCase()===C&&(e=e.substr(C.length)),e.toLowerCase()}function R(e,t){var n=(0,i.BL)(t.ShellResources.crossdomainproxyiframe),r=(0,i.BL)(t.ShellResources.msaltokenfactoryiframe);return{version:e,crossdomainproxyJsHash:n.hash,msaltokenfactoryJsHash:r.hash,resourceCatalogHostUrl:t.ResourceCatalogHostUrl}}function P(){if(!("XMLHttpRequest"in window))throw new s.F(u.e1,-2003);return new XMLHttpRequest}function E(e){if(null==e)throw w("requestInfo");if(b(e.url,"requestInfo.url",c,!0),b(e.body,"requestInfo.body",c,!1),b(e.success,"requestInfo.success",d,!1),b(e.error,"requestInfo.error",d,!1),b(e.timeout,"requestInfo.timeout",f,!1),b(e.method,"requestInfo.method",c,!1),b(e.binaryStringRequestBody,"requestInfo.BinaryRequestBody",p,!1),b(e.binaryStringResponseBody,"requestInfo.BinaryResponseBody",p,!1),A(e.method)?e.method="GET":e.method=e.method.toUpperCase(),null==e.timeout&&(e.timeout=o.K.DefaultTimeout),e.timeout<0)throw w("requestInfo.timeout");if(A(e.url))throw w("requestInfo.url")}function U(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t}function F(e){var t=null;if(typeof e===c){for(var n=new ArrayBuffer(e.length),r=new Uint8Array(n),a=0;a<e.length;a++)r[a]=255&e.charCodeAt(a);var i=new Blob([n]);t=i||n}return t}function N(e){var t="",n=e.indexOf("?");return n>0&&(t=e.substr(n+1,e.length)),t}function _(e){var t={};if(null!=e)for(var n=new RegExp("\r?\n"),r=0,a=e.split(n);r<a.length;r++){var i=a[r];if(null!=i){var o=i.indexOf(":");if(o>0){var s=i.substr(0,o),u=i.substr(o+1);s=M(s),u=M(u),t[s.toUpperCase()]=u}}}return t}function M(e){return e.replace(/^\s+|\s+$/g,"")}function H(e,t){return 0===e.lastIndexOf(t,0)}function q(e,t){var n=e.lastIndexOf(t);return-1!==n&&n===e.length-t.length}function B(){if(!("ArrayBuffer"in window))throw(0,a.jl)().tag("RequestExecutor_ArrayBufferNotSupported",6,-2003,u.YG),new s.F(u.YG,-2003);if(!("Uint8Array"in window))throw(0,a.jl)().tag("RequestExecutor_Uint8ArrayNotSupported",6,-2003,u.YG),new s.F(u.YG,-2003);if(!("BlobBuilder"in window)&&!("MozBlobBuilder"in window)&&!("Blob"in window))throw(0,a.jl)().tag("RequestExecutor_BlobBuilderNotSupported",6,-2003,u.YG),new s.F(u.YG,-2003)}function W(e){if(window.addEventListener)return window.addEventListener("message",e,!1),!0;throw new s.F(u.JP,-2002)}function j(e,t,n,r){if(null!=e.error){var i={state:e.state,body:""};r&&(n="".concat(n," target: ").concat(r)),e.error(i,t,n)}else(0,a.jl)().tag("RequestExecutor_NoErrorCallback",6,t.toString(),n)}function G(e){return Y(e,!0,!0)}var K=224,z=192,V=240,Z=128,Q=55296,X=64512,J=65536;function Y(e,t,n){var r="";if(A(e)||void 0===e||0===e.length)return"";for(var a=0;a<e.length;a++){var i=e.charCodeAt(a),o=e.charAt(a);if(t&&("#"===o||"?"===o)){r+=e.substr(a);break}if(i<=127)n||i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||i>=32&&i<=95&&" \"%<>'&".indexOf(o)<0?r+=o:i<=15?r+="%0"+i.toString(16).toUpperCase():i<=127&&(r+="%"+i.toString(16).toUpperCase());else if(i<=2047)r+="%"+(z|i>>6).toString(16).toUpperCase(),r+="%"+(Z|63&i).toString(16).toUpperCase();else if((i&X)!==Q)r+="%"+(K|i>>12).toString(16).toUpperCase(),r+="%"+(Z|(4032&i)>>6).toString(16).toUpperCase(),r+="%"+(Z|63&i).toString(16).toUpperCase();else if(a<e.length-1){i=(1023&i)<<10,a++,i|=1023&e.charCodeAt(a),r+="%"+(V|(i+=J)>>18).toString(16).toUpperCase(),r+="%"+(Z|(258048&i)>>12).toString(16).toUpperCase(),r+="%"+(Z|(4032&i)>>6).toString(16).toUpperCase(),r+="%"+(Z|63&i).toString(16).toUpperCase()}}return r}function $(e){return document.getElementById(ee(e))}function ee(e){switch(e){case l.o.OWA:return h;case l.o.TokenFactory:return g;default:return(0,a.jl)().tag("RequestExecutor_UnsupportedFrameCodeSpecified",6),""}}function te(e){return"arraybuffer"===e.responseType?e.response?e.response.byteLength:0:e.responseText?e.responseText.length:0}},85884:function(e,t,n){"use strict";var r;n.d(t,{v:function(){return r}}),function(e){e[e.NoExoLicense=1]="NoExoLicense",e[e.Brs=2]="Brs",e[e.TokenExpired=3]="TokenExpired",e[e.LanguageNotSet=4]="LanguageNotSet",e[e.InitFailed=5]="InitFailed",e[e.SecurityZoneMismatched=6]="SecurityZoneMismatched",e[e.IframeLoadError=7]="IframeLoadError",e[e.CallerOriginNotAllowed=8]="CallerOriginNotAllowed",e[e.InvalidMailbox=9]="InvalidMailbox",e[e.ShardMailbox=10]="ShardMailbox",e[e.ShardNotDetected=11]="ShardNotDetected",e[e.Pwa=12]="Pwa"}(r||(r={}))},41018:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});var r=n(9264),a=n(92030),i=(n(78453),function(){function e(){}return e.onBeforeSendRequestSuiteService=function(e,t,n){if(null!=n&&null!=n.userMailboxType&&null!=t&&-1!==r.parseQueryString(t.url.toLowerCase()).indexOf("getowauserconfiguration"))try{JSON.parse(n.userMailboxType)}catch(e){}var i="X-OWA-CANARY",o="X-OWA-CANARY-DEBUG",s=(0,a.e)(i),u=(0,a.e)(o);return null!=s&&e.setRequestHeader(i,s),null!=u&&e.setRequestHeader(o,u),null},e.validateOriginWithAllowedEndpoints=function(t,n){for(var a=[],i=0;i<n.length;i++)a[i]=n[i].host;return e.validateOrigin(r.getUrlAuthorityPart(t),a)},e.validateOrigin=function(e,t){if(null==t||e.length>253)return!1;for(var n=!1,r=0;r<t.length;r++)if(""!==t[r]&&new RegExp(t[r],"i").test(e)){n=!0;break}return n},e.validatePathWithAllowedEndpoints=function(e,t){if(r.isNullOrEmptyString(e))return!1;for(var n=!1,a=r.getUrlAuthorityPart(e),i=r.getUrlPath(e),o=0,s=t;o<s.length;o++){var u=s[o];if(new RegExp(u.host,"i").test(a)){if(null==u.paths)return!1;for(var l=0,c=u.paths;l<c.length;l++){var p=c[l];if(new RegExp(p,"i").test(i)){n=!0;break}}break}}return n},e.validatePathWithAllowedResources=function(e,t,n){if(null==e||r.isNullOrEmptyString(t)||null==n)return!1;for(var a=!1,i=r.getUrlAuthorityPart(e),o=r.getUrlAuthorityPart(t),s=0,u=n;s<u.length;s++){var l=u[s],c=!1;if("^"===l.resource.charAt(0))c=new RegExp(l.resource,"i").test(i);else c=r.getUrlAuthorityPart(l.resource)===i;if(c){if(null==l.hosts)return!1;for(var p=0,d=l.hosts;p<d.length;p++){var f=d[p],h=!1;if("^"===f.charAt(0))h=new RegExp(f,"i").test(o);else h=r.getUrlAuthorityPart(f)===o;if(h){a=!0;break}}break}}return a},e.isAllowedApi=function(t){if(null==t)return!1;var n=r.getUrlPath(t);if(n in e.allowedPath){if(!e.allowedPath[n])return!0;if(r.parseQueryString(t).replace("&UA=0","")in e.allowedListOfApi)return!0}else if(r.startsWith(n,r.SuiteServiceApiRelativePath))return!0;return("owa/ev.owa2"===n||"ev.owa2"===n)&&e.checkAllowedPgmParameters(t)},e.checkAllowedPgmParameters=function(t){if(r.isNullOrEmptyString(t)||""===t.trim())return!1;var n=t.split("?");if(2===n.length){var a=n[1];if(r.isNullOrEmptyString(a)||""===a.trim())return!1;for(var i=0,o=a.split("&");i<o.length;i++){var s=o[i].split("=");if(2!==s.length)return!1;if(!(s[0]in e.AllowedPgmQueryStringParametersList))return!1}return!0}return!1},e.createAllowedPgmParamters=function(){return{ecnsq:!0,brwnm:!0,cid:!0,syncFnshRq:!0,ns:!0,ev:!0,Fn:!0,UA:!0,"UX-E4E-CANARY":!0,"X-OWA-CANARY":!0,"X-OWA-CANARY-DEBUG":!0,"X-E4E-CANARY-DEBUG":!0}},e.createAllowedApiList=function(){return{"action=GetReminders":!0,"action=GetOwaUserConfiguration":!0,"action=SetNotificationSettings":!0,"action=FindItem":!0,"action=GetUserAvailabilityInternal":!0,"action=GetCalendarFolders":!0,"action=ProcessSuiteStorage":!0,"action=SubscribeToNotification":!0,"action=PerformReminderAction":!0,"action=GetOwaUserOofSettings":!0,"action=SetUserTheme":!0,"action=SetUserLocale":!0,"action=UnsubscribeToNotification":!0,"action=GetDaysUntilPasswordExpiration":!0,"action=GetModernGroups":!0,"action=GetModernGroup":!0,"action=GetModernGroupUnseenItems":!0,"action=GetCalendarFolderConfiguration":!0,"action=SubscribeToGroupUnseenNotification":!0,"action=SubscribeToGroupNotification":!0,"action=GetSocialActivityNotifications":!0,"action=GetSocialActivityNotifications2":!0,"action=MarkSocialActivityNotificationsAsSeen":!0,"action=MarkSocialActivityNotificationsAsSeen2":!0,"action=GetBingHelpSearchResults":!0,"action=GetMailboxRegionalConfiguration":!0,"action=SetMailboxRegionalConfiguration":!0,"format=json":!0,"api-version=1":!0,"action=TestAddReminders":!0,"action=TestDeleteAllReminders":!0,"action=TestAddItems":!0,"action=TestDeleteAllItems":!0,"action=TestAddCalendarFolders":!0,"action=TestAddCalendarGroups":!0,"action=TestDeleteAllCalendarFolders":!0,"action=TestDeleteAllCalendarGroups":!0,"action=TestAddUserAvailability":!0,"action=TestDeleteAllUserAvailability":!0,"action=TestAddOwaUserOofSettings":!0,"action=TestDeleteNotifications":!0,"action=TestAddNotifications":!0,"action=TestGetSettings":!0}},e.createAllowedPath=function(){var e;return(e={})[r.OwsRelativePath]=!0,e["SuiteService.svc/"]=!0,e["SuiteService.svc"]=!0,e["owa/ev.owa2"]=!0,e["ev.owa2"]=!0,e["Microsoft.Online.BOX.Admin.UI.SystemAlert.GetAlerts.model"]=!0,e["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model"]=!0,e["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model"]=!0,e["api/myapps/GetAllApps"]=!1,e["api/myapps/GetAppDetails"]=!1,e["api/myapps/GetCompleteAppData"]=!1,e["api/myapps/ExecuteAppCustomAction"]=!1,e["api/myapps/ActivatePendingProvisioningApps"]=!1,e["owa/service.svc/s/GetPersonaPhoto"]=!1,e["api/settings/cards"]=!1,e["api/settings/cards/data"]=!1,e["api/settings/theme"]=!1,e["api/settings/darkmode"]=!1,e["api/settings/language"]=!1,e["api/settings/contactPreferences"]=!1,e["api/NotificationsSettings/User"]=!1,e["api/settings/SPO/MySiteUrl"]=!1,e["api/settings/regiontimezone"]=!1,e["api/profile/photo"]=!1,e["v1.0/me/photo/$value"]=!1,e["api/storage/CustomerContent/Tenant/CustomSupportData"]=!0,e},e.allowedPath=e.createAllowedPath(),e.allowedListOfApi=e.createAllowedApiList(),e.AllowedPgmQueryStringParametersList=e.createAllowedPgmParamters(),e}())},2221:function(e,t,n){"use strict";n.r(t),n.d(t,{XSuiteError:function(){return d},convertErrorToException:function(){return v},generateCorrelationId:function(){return g},genericServiceExceptionLog:function(){return b},genericServiceRejection:function(){return I},getOwaError:function(){return S},getOwaServerName:function(){return m},isCallsBlockedException:function(){return C}});var r=n(62244),a=n(91011),i=n(17698),o=n(32964),s=function(){function e(e){this.value=e}return e.newSuid=function(){var t=(new Date).getTime();return e.disambiguationIndex=99===e.disambiguationIndex?0:e.disambiguationIndex+1,new e(100*t+e.disambiguationIndex)},e.disambiguationIndex=-1,e}(),u="X-OWA-ERROR",l="X-OWA-CORRELATIONID",c="X-FESERVER",p="X-BESERVER",d="X-SUITE-ERROR",f="FE_{0}_BE_{1}",h=[l,c,p,u,d];function g(e){return e+"_"+s.newSuid().value.toString()}function m(){return(0,r.Uw)(f,i.e.Instance.OwaFrontEndServerName,i.e.Instance.OwaBackEndServerName)}function S(e){return null==e?null:(null!=e[c]&&(i.e.Instance.OwaFrontEndServerName=e[c]),null!=e[p]&&(i.e.Instance.OwaBackEndServerName=e[p]),e[u])}var y="errorCode";function v(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];var i=function(e){var t={};if(null!=e&&(t.HttpStatus=e.statusCode,null!=e.headers))for(var n=0,r=h;n<r.length;n++){var a=r[n];null!=e.headers[a]&&(t[a]=e.headers[a])}return t}(e);i[y]=t;for(var s=0,u=0,l=r;u<l.length;u++){var c=l[u];i["arg"+s]=c,s++}return new o.P(n,t,i)}function C(e){return-1010===e.errorCode||-1007===e.errorCode}function b(e,t,n){if(n){var i=n.errorCode||"",o=n.errorInfo&&n.errorInfo.HttpStatus?n.errorInfo.HttpStatus:"",s=n[u]||n[d]||"",h=null!=n[c]&&null!=n[p]?(0,r.Uw)(f,n[c],n[p]):"",g=n[l]||"";(0,a.jl)().exception(e,t,n,i,o,s,h,g)}else(0,a.jl)().exception(e,t,n)}function I(e,t,n,r){C(n)&&b(e,t,n),r(n)}},99964:function(e,t,n){"use strict";n.d(t,{J:function(){return l}});var r=n(9264),a=n(92030),i=n(32964),o=n(89990),s=n(15312),u="$",l=function(){function e(){}return e.processRequest=function(t,n){var u,l,c={},p=(0,a.e)("SuiteServiceProxyKey");if(r.isNullOrEmptyString(p)){if(p=(0,a.e)("ClientStorageCookie"),r.isNullOrEmptyString(p))throw new i.P(o.UU,-2007);p=decodeURIComponent(p)}var d=p.split("&");if(2!==d.length)throw new i.P(o.UU,-2007);if(u=d[0],l=d[1],r.isNullOrEmptyString(t.UserId))throw new i.P(o.UU,-2004);var f=window.sessionStorage;if(null==f)throw new i.P(o.UU,-2005);try{var h=t.UserId;s.F.computeSHA256(h).then((function(r){f.setItem("CurrentUserId",r),e.doClearAll(t,c,f),e.doDeletes(t,c,f),e.doWritesAndReads(t,u,l,f,c,n)})).catch((function(e){var t=null==e?o.UU:e;c.ResetError=new i.P(t,-2008),n(c)}))}catch(e){c.ResetError=e,n(c)}},e.doClearAll=function(t,n,r){try{if(!0===t.ClearAll){var a=Object.keys(r);e.doDeletes({Deletes:a},n,r)}}catch(e){n.ClearError=e}},e.doDeletes=function(e,t,n){try{if(null!=e.Deletes)for(var r=0,a=e.Deletes;r<a.length;r++){var i=a[r];n.removeItem(i)}}catch(e){t.DeleteError=e}},e.doWritesAndReads=function(t,n,r,a,i,o){try{null!=t.Writes?e.encryptWrites(n,r,t.Writes,0,a,(function(){e.doReads(t,n,r,a,i,o)}),(function(s){i.WriteError=s,e.doReads(t,n,r,a,i,o)})):e.doReads(t,n,r,a,i,o)}catch(s){i.WriteError=s,e.doReads(t,n,r,a,i,o)}},e.doReads=function(t,n,r,a,i,o){try{if(null!=t.Reads){e.decryptReads(n,r,t.Reads,0,{},a,(function(e){i.Reads=e,o(i)}),(function(e){i.ReadError=e,o(i)}))}}catch(e){i.ReadError=e,o(i)}},e.encryptWrites=function(t,n,r,a,l,c,p){null!=r&&a<r.length?null==t?(l.setItem(r[a].Key,r[a].Value),e.encryptWrites(t,n,r,a+1,l,c,p)):s.F.encryptAES(t,n,u+r[a].Value+u).then((function(i){l.setItem(r[a].Key,i),e.encryptWrites(t,n,r,a+1,l,c,p)})).catch((function(e){var t=null==e?o.UU:e;p(new i.P(t,-2009))})):c()},e.decryptReads=function(t,n,a,o,l,c,p,d){if(null!=a&&o<a.length){var f=a[o],h=c.getItem(f);null===h?e.decryptReads(t,n,a,o+1,l,c,p,d):(null===t&&(l[f]=h,e.decryptReads(t,n,a,o+1,l,c,p,d)),s.F.decryptAES(t,n,h).then((function(i){null==i||!r.startsWith(i,u)||!r.endsWith(i,u)||i.length<2?e.doClearAll({ClearAll:!0},{},c):l[f]=i.substr(1,i.length-2),e.decryptReads(t,n,a,o+1,l,c,p,d)})).catch((function(r){"OperationError"===r?(e.doClearAll({ClearAll:!0},{},c),e.decryptReads(t,n,a,o+1,l,c,p,d)):d(new i.P(r))})))}else p(l)},e}()},20851:function(e,t,n){"use strict";n.d(t,{Pp:function(){return s.P},FH:function(){return p.F},uJ:function(){return h.u},Ou:function(){return a.Ou},xX:function(){return u},t6:function(){return i.t},vj:function(){return d.v},LU:function(){return f},es:function(){return o.e},fO:function(){return c},$_:function(){return S}});var r=n(56597),a=n(84185),i=n(39013),o=n(17698),s=n(32964),u=(n(41018),n(9264)),l=n(89990),c=function(){function e(){}return e.checkScope=function(t,n){if(null!=t&&!(0,u.startsWith)(t,n+e.DictionaryStringPartsSeparator))throw new s.P(l.H1,-2010)},e.SuiteScope="O365S",e.DictionaryStringPartsSeparator="//",e}(),p=n(25889),d=n(85884),f=(n(99964),n(15312),n(2221)),h=n(78453),g=null;try{window.MSA&&window.MSA.MeControl&&(g=window.MSA.MeControl.UserStateModel)}catch(e){}var m=g;(function(){function e(){}e.createUserStateModel=function(e){return null!=window.MSA?new m(e):null}})(),function(){function e(){}e.MSA="msa",e.AAD="aad",e.MSAFed="msaFed"}();function S(){"complete"===document.readyState?r.K.internalProcessWindowLoad():window.onload=r.K.internalProcessWindowLoad}},62452:function(e,t,n){"use strict";var r,a;n.d(t,{A:function(){return a},C:function(){return r}}),function(e){e.LifeCycle="LifeCycle",e.DataProviderResponseNotification="DataProviderResponseNotification",e.ChallengeToken="ChallengeToken"}(r||(r={})),function(e){e.GetConfig="GetConfig",e.RefreshToken="RefreshToken",e.PageReady="PageReady",e.Closed="Closed",e.FatalError="FatalError"}(a||(a={}))},78453:function(e,t,n){"use strict";var r;n.d(t,{u:function(){return r}}),function(e){e.Ping="Ping",e.Query="Query",e.OwaUserConfig="OwaUserConfig",e.TokenPrefetch="TokenPrefetch",e.Storage="Storage",e.Notification="Notification",e.UserState="UserState",e.SignalR="SignalR",e.IncomingOpxMessage="IncomingOpxMessage",e.OutgoingOpxMessage="OutgoingOpxMessage",e.RegisterOpxHost="RegisterOpxHost"}(r||(r={}))},51932:function(e,t,n){"use strict";n.d(t,{AQ:function(){return c},UN:function(){return d},W3:function(){return f},e9:function(){return p},o0:function(){return u},yX:function(){return l}});var r,a=n(81494),i=n(91011),o=n(72607),s=n(51031),u={IsVirtual:!0,ParallelView:!0,Style:"o365shell",CanCollapse:!0,SuppressBackgroundRinging:!0};function l(e,t){!t&&swc&&(e?swc.API.triggerEvent(a.X_.ApiRecentsShown):swc.API.triggerEvent(a.X_.ApiRecentsHidden))}function c(e,t){!t&&swc&&swc.SDK.Recents.refreshDOM(e)}function p(e,t,n){!n&&swc?(swc.API.registerEvent(a.X_.ApiRecentsReady,t),swc.create(a.PO.Recents,{},e)):n&&(r=e)}function d(e,t){TeamsClient&&TeamsClient.client&&TeamsClient.client.conversations.get().then((function(n){n.render(r).then(e),n.subscribe((function(e){e.type===s.q.ConversationOpened&&t(!1,o.vP)}))}))}function f(e,t){swc&&swc.getPresence().then((function(t){t.setMyStatus(e.key)})).catch((function(e){(0,i.jl)().exception("UserPresence_SetMyStatus_Exception",6,e),t()}))}},81494:function(e,t,n){"use strict";var r,a,i;n.d(t,{PO:function(){return i},X_:function(){return r},l$:function(){return a}}),function(e){e.ChatCoreReady="swc:core:ready",e.ChatAPIReady="swc:ready",e.ApiRecentsReady="recentsReady",e.ApiRecentsShown="recentsShown",e.ApiRecentsHidden="recentsHidden",e.ApiUnreadConversationUpdate="unreadConversationsUpdate",e.ApiStartChat="startChat",e.ApiOnCallStart="onCallStart",e.ApiRecentItemsLoaded="recentItemsLoaded",e.ApiOnRecentItemSelected="onRecentItemSelected"}(r||(r={})),function(e){e.ChatRecents="skype-recents",e.ChatWrapper="chat-wrapper"}(a||(a={})),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(i||(i={}))},51031:function(e,t,n){"use strict";var r,a;n.d(t,{k:function(){return r},q:function(){return a}}),function(e){e[e.UnreadCounterUpdate=0]="UnreadCounterUpdate"}(r||(r={})),function(e){e.TeamsChatAPIReady="ms-teams-sdk-loaded",e.TeamsChatAuthFailed="ms-teams-sdk-auth-failed",e.ConversationOpened="conversationOpened",e.KeyPressed="keyPressed"}(a||(a={}))},40719:function(e,t,n){"use strict";n.d(t,{Ak:function(){return l},D:function(){return a},M3:function(){return u},P7:function(){return i},YI:function(){return s},nZ:function(){return o},q:function(){return r}});var r="suiteux-chat.UPDATE_IS_CHAT_RECENTS_INITIALIZED",a="suiteux-chat.UPDATE_IS_CHAT_API_INITIALIZED",i="suiteux-chat.UPDATE_IS_CHAT_API_PREAUTH_COMPLETED",o="suiteux-chat.UPDATE_UNREAD_CONVERSATION_COUNT",s="suiteux-chat.UPDATE_IS_TEAMS_CHAT_ACTIVATED",u="suiteux-chat.UPDATE_IS_TEAMS_CHAT_AUTH_FAILED",l="suiteux-chat.UPDATE_INIT_CHAT_IN_FIRST_CLICK"},6037:function(e,t,n){"use strict";n.d(t,{Ou:function(){return T.Ou},xV:function(){return a.x},Zo:function(){return i.Z},tw:function(){return r.t},BH:function(){return g.B},Eg:function(){return o.E},GI:function(){return s.G},ri:function(){return T.ri},Q:function(){return T.Q},lD:function(){return h},hs:function(){return T.hs},C1:function(){return T.C1},__:function(){return T.__},Eb:function(){return v},Zp:function(){return M},yw:function(){return U.yw},aM:function(){return _.aM},y3:function(){return A},mI:function(){return O},iv:function(){return R.i},Jb:function(){return I.Jb},Mq:function(){return _.Mq},RF:function(){return P},vo:function(){return E},M1:function(){return x},Y5:function(){return F.Y5},GS:function(){return k},g6:function(){return C},Uw:function(){return y.Uw},ef:function(){return L.e},Wu:function(){return y.Wu},xH:function(){return y.xH},pG:function(){return b},Vz:function(){return w},nJ:function(){return U.nJ},Te:function(){return U.Te},ir:function(){return U.ir},YA:function(){return D.Y},NN:function(){return N},gJ:function(){return I.gJ},uS:function(){return I.uS}});var r=n(33836),a=n(73225),i=n(57931),o=(n(31089),n(6867)),s=n(53106),u=n(77224),l=n(64731),c=n(27676),p=n(88818),d=n(58930),f=n(35439),h=function(e){function t(t){var n=e.call(this,t)||this;return n.setRef=function(e){return n.searchControl=e},n.SearchBarKey=function(e){var t=e.currentTarget.value;n.setState((function(){return{currentSearchText:t,showDismissButton:!0}})),n.props.onSearch(t)},n.DismissDefaultText=function(){n.state.clearTextOnFocus?n.setState((function(){return{currentSearchText:"",showDismissButton:!1}})):n.setState((function(){return{showDismissButton:!0,clearTextOnFocus:!0}}))},n.DefaultSearchText=function(){""===n.state.currentSearchText?n.setState((function(){return{currentSearchText:n.props.defaultText,showDismissButton:!1}})):n.setState((function(){return{clearTextOnFocus:!1}}))},n.ButtonClearText=function(){n.searchControl.focus(),n.searchControl.placeholder="",n.setState((function(){return{currentSearchText:"",showDismissButton:!1}})),n.props.onSearch("")},n.moveCursor=function(){n.searchControl.focus()},n.props.currentSearchText?n.state={currentSearchText:n.props.currentSearchText,showDismissButton:!0,clearTextOnFocus:!1}:n.state={currentSearchText:n.props.defaultText,showDismissButton:!1,clearTextOnFocus:!0},n}return(0,u.__extends)(t,e),t.prototype.getSearchResultAriaLabel=function(){return(0,y.xH)(this.state.currentSearchText)?"":(0,y.Uw)(c.b.SearchBoxResultAriaLabel,"".concat(this.props.searchResultCount))},t.prototype.render=function(){var e=(0,d.j)(),t=(0,f.E)();return l.createElement("div",{className:(0,R.i)(p.SearchControl,t?p.SearchControlZoomMargin:null,e.neutral.foregroundAlt.background)},l.createElement("div",{"aria-live":"polite",style:{position:"absolute",left:"-999em",top:"0em"}},this.getSearchResultAriaLabel()),this.state.showDismissButton?l.createElement("button",{onClick:this.ButtonClearText,"aria-label":c.b.SearchBoxClearButtonText,title:c.b.SearchBoxClearButtonText},l.createElement(g.B,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--".concat("ChromeClose"),fontSize:"12"})):l.createElement("button",{onClick:this.moveCursor,tabIndex:-1,"aria-hidden":!0},l.createElement(g.B,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--".concat("Search"),fontSize:"12"})),l.createElement("input",{className:(0,R.i)(p.inputBox,e.neutral.dark.font),type:"text",onFocus:this.DismissDefaultText,value:this.state.currentSearchText,onChange:this.SearchBarKey,onBlur:this.DefaultSearchText,ref:this.setRef,placeholder:this.props.defaultText,id:"appLauncherSearch",autoComplete:"off","aria-label":this.props.ariaLabel||this.props.defaultText}))},t}(l.Component),g=n(87317),m=n(50115),S=n(91011),y=n(62244),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,u.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,a,i,o,s,u=(0,d.j)();if(null!=this.props.unseenItemCount&&0!==this.props.unseenItemCount){var c=null!==(r=this.props.badgeCharacter)&&void 0!==r?r:(0,y.Tn)(this.props.unseenItemCount),p=(0,R.i)(m.unseenCount,u.accent.border,((e={})[u.badge]=!this.props.isParentHovered,e),((t={})[m.emptyBadge]=""===this.props.badgeCharacter,t),((n={})[m.emptyBadgeDarkMode]=""===this.props.badgeCharacter&&this.props.isDarkMode,n)),f={};return(null===(a=this.props.badgeColors)||void 0===a?void 0:a.badgeColor)&&(f.backgroundColor=this.props.badgeColors.badgeColor),(null===(i=this.props.badgeColors)||void 0===i?void 0:i.badgeFontColor)&&(f.color=this.props.badgeColors.badgeFontColor),this.props.isParentHovered&&(f.boxSizing="border-box",f.border="1px solid",(null===(o=this.props.badgeColors)||void 0===o?void 0:o.badgeHoverColor)?f.backgroundColor=this.props.badgeColors.badgeHoverColor:f.backgroundColor=(0,S.q4)().getThemeData().AccentHover||"white",(null===(s=this.props.badgeColors)||void 0===s?void 0:s.badgeFontHoverColor)?f.color=this.props.badgeColors.badgeFontHoverColor:f.color="#106EBE"),l.createElement("div",{className:(0,R.i)(m.unseenitems,this.props.badgeStyles)},l.createElement("span",{style:f,className:p},c,this.props.children))}return null},t}(l.Component),C=n(81348),b=n(7920),I=n(46676),T=n(36198),D=n(80054),w={notificationsEnabled:!1,toastsMuted:!1,bellHeaderButtonInLayout:!0,isSubscriptionReady:!1,systemNotificationsDisabled:!0,notifications:[]},A=(n(3533),{timestamp:null,appsUpdateTimeSpan:null,appDataCache:null,moreAppDataAvailable:null,doNotCallGetAllAppsUntil:null}),O={isChatAPIInitialized:null,isChatRecentsPaneInitialized:!1,isChatAPIPreAuthCompleted:!1,unreadBadgeValue:0,chatEnabled:!1,chatWebLink:null,webChatSDKUrl:null,isTeamsChatActivated:!1,isTeamsChatAuthFailed:!1,chatButtonRenderedCallback:null,isConsumerShell:!1},x={activeButtonId:"",customFlexPanes:{},customFlexPaneHash:void 0,customHeaderButtonFlexPaneTriggers:{},customHeaderButtons:[],badgeValues:{},badgeColors:{},badgeLabels:{},badgeCharacters:{},customFlexpaneWidth:void 0},L=(n(12406),n(65527),n(62293));n(56279);function k(e,t,n){void 0===n&&(n=0);for(var r=-1,a=n;a<e.length;a++)if(t(e[a])){r=a;break}return r}var R=n(49876),P=n(86614),E=n(9028),U=n(1995),F=n(84159);function N(e,t,n){return void 0===n&&(n=","),e=e?e.toLowerCase().trim():"",(t?t.toLowerCase().split(n):[]).some((function(t){return t.trim()===e}))}var _=n(26403),M=n(66337)},9028:function(e,t,n){"use strict";function r(e,t){if(null===e)throw new Error("Error: ".concat(t," is null."))}function a(e,t){if(void 0===e)throw new Error("Error: ".concat(t," is undefined."))}function i(e,t){r(e,t),a(e,t)}function o(e,t){if(i(e,t),0===e.length)throw new Error("Error: ".concat(t," is an empty string."))}function s(e,t){if(i(e,t),0===e.length)throw new Error("Error: ".concat(t," is a null or empty array."))}n.r(t),n.d(t,{throwOnNull:function(){return r},throwOnNullOrEmpty:function(){return o},throwOnNullOrEmptyArray:function(){return s},throwOnNullOrUndefined:function(){return i},throwOnUndefined:function(){return a}})},56003:function(e,t,n){"use strict";n.d(t,{Gj:function(){return o},P2:function(){return u},WA:function(){return i},r2:function(){return a},wW:function(){return s}});var r=n(91011),a="OPX",i="https://outlook.office.com",o=[i,"https://to-do.office.com","https://outlook-sdf.office.com"];function s(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}function u(){var e="hiddenOpxContainer",t=document.getElementById(e);if(!t){var n=(0,r.aH)();if(n){var a=document.getElementById(n.top);a&&((t=document.createElement("div")).id=e,t.style.display="none",a.appendChild(t))}}return t}},98630:function(e,t,n){"use strict";n.d(t,{rP:function(){return r},tL:function(){return i},yo:function(){return a}});var r=6e4,a=60*r,i=24*a},26403:function(e,t,n){"use strict";n.d(t,{Mq:function(){return i},aM:function(){return a},w6:function(){return o}});var r=n(91011);function a(e,t,n){var r="?";return e.indexOf(r)>-1&&(r="&"),e+r+t+"="+n}function i(e){return e?encodeURI(e).replace(/#/g,"%23"):""}function o(e,t){if(null==e)return!0;if((e=(e=e.toLowerCase()).trim()).startsWith("https://")||!0===e.startsWith("http://"))return!0;var n=e.indexOf("://"),a=null;return-1!==n&&(a=e.substring(0,n)),(0,r.jl)().tag("Unsafe URL: "+{beforeColonUrl:a},6),!t}},97260:function(e,t,n){"use strict";n.d(t,{L:function(){return a}});var r=n(30720);function a(e){return{type:r.k,dttProps:e}}},30720:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var r="suiteux-dtt.UPDATE_PROPS"},84735:function(e,t,n){"use strict";function r(e){return null!=e&&0!==e.length&&e.some((function(e){return a(e)}))}function a(e){return!(null==e||i(e.Id)||i(e.Text)||i(e.Url)&&null==e.Action)}function i(e){return""===e||null==e}n.d(t,{l:function(){return a},q:function(){return r}})},5719:function(e,t,n){"use strict";var r;n.d(t,{l:function(){return r}}),function(e){e[e.SystemAlert=0]="SystemAlert",e[e.ReminderNotification=1]="ReminderNotification"}(r||(r={}))},78031:function(e,t,n){"use strict";n.r(t);var r=n(91011),a=n(64731),i=n(25445),o=n(2979),s=n(6037),u=n(64252),l=n(46676),c=n(59633),p=n(77224),d=n(2221),f=n(25190),h=n(15315),g=n(62244),m=n(71684),S=n(27676),y=n(79502),v=n(60331),C=n(20851);function b(e){return new Promise((function(t,n){var a=(0,s.Uw)("/api/myapps/GetIcon?appDataJson={0}",encodeURIComponent(JSON.stringify({Id:e.Id,CollectorId:e.CollectorId,Properties:e.Properties})));y.nR.Instance.Service.callWebClientShellServiceFunction(a,"GET",null,null).then((function(e){t(e)})).catch((function(e){C.LU.isCallsBlockedException(e)||(0,r.jl)().exception("AppsManager_GetAppIcon_Failed",6,e),n(e)}))}))}var I="AppsPinnedData",T=["FirstParty","SharePoint","Graph","LineOfBusiness","Dynamics"],D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastAppsPinnedDataWriteTimestampKey=new v.Qt("User","Suite","LastAppsPinnedDataWriteTimestamp"),t.cachedAppsDataKey=new v.Qt("User","Suite","CachedAppsData"),t}return(0,p.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;window.O365Shell.OnSuiteAPILoaded((function(){e.initializeInternal()}))},t.prototype.componentDidUpdate=function(e){this.props.appsPinnedData&&e.appsPinnedData&&this.props.appsPinnedData!==e.appsPinnedData&&((!this.props.appsPinnedData.timestamp||!e.appsPinnedData.timestamp||this.props.appsPinnedData.timestamp>=e.appsPinnedData.timestamp)&&this.hasAppsPinnedDataChanged(e.appsPinnedData)&&this.saveCustomization())},t.prototype.render=function(){return null},t.prototype.initializeInternal=function(){var e=this,t=this.props.appsPinnedData;this.props.disableSessionStorageCache?this.updateAppsFromStorage():null!=t?Date.now()-this.props.timestamp<6e4?this.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync().then((function(n){n&&t.timestamp<n?e.readAppsPinnedData(1):e.updateApps(t,!0)})).catch((function(){e.readAppsPinnedData(3)})):this.readAppsPinnedData(2):this.readAppsPinnedData(0);var n=(0,r.Lo)();n.subscribe("AppIconRequested",(function(t){b(t).then((function(n){e.props.onSetImageDataUrl(t.CollectorId,t.Id,"data:".concat(n.MimeType,";base64,").concat(n.Base64EncodedImage))})).catch((function(){}))})),n.subscribe("AppDataDetailsRequested",(function(t){t.Id===m.tx?e.props.onSetAppDataDetails({CollectorId:"none",Details:S.b.M365AppTileDetails,EulaUrl:null,HomepageUrl:null,PrivacyUrl:null,SupportUrl:null,Publisher:null,Permissions:null,Id:m.tx}):e.getAppDataDetailsAsync(t).then((function(n){n.CollectorId=t.CollectorId,e.props.onSetAppDataDetails(n)})).catch((function(){}))}),!0),n.subscribe("AppsReset",(function(){e.props.onSetAppsPinnedData({apps:[]})})),n.subscribe("AppsUpdate",(function(){e.updateAppsFromCollectors()}))},t.prototype.readAppsPinnedData=function(e){var t=this;this.readAppsPinnedDataFromStorageAsync().then((function(e){t.updateApps(e,!0)})).catch((function(){t.updateApps(t.props.appsPinnedData,!1),(0,r.jl)().tag("AppsManager_ReadAppsPinnedDataFromStorageReason",1,e)}))},t.prototype.updateApps=function(e,t){var n=this;e&&e!==this.props.appsPinnedData&&void 0!==e.apps&&this.props.onSetAppsPinnedData(e),t&&this.props.onEnableCustomization(),this.readCachedAppsFromSessionStorageAsync().then((function(e){if(e)if(Date.now()-e.timestamp>n.props.appsUpdateTimeSpan||e.cultureName!==n.props.cultureName)n.updateAppsFromStorage();else{var t=!0;n.props.appDataCache&&!n.props.moreAppDataAvailable&&n.props.timestamp>=e.timestamp&&(t=!1),t&&n.updateMyApps(e.apps,1)}else n.updateAppsFromStorage()})).catch((function(){n.updateAppsFromStorage()}))},t.prototype.updateAppsFromStorage=function(){var e=this;this.props.appDataCache&&!this.props.moreAppDataAvailable?this.updateAppsFromCollectors():this.readAppDataCacheFromStorageAsync().then((function(t){e.onReadAppDataCacheSucceeded(t)})).catch((function(){e.updateAppsFromCollectors()}))},t.prototype.onReadAppDataCacheSucceeded=function(e){for(var t={},n=function(n){var a=e[n];if(a&&a.Apps)t[n]=a.Apps;else{var i=r.props.appsData.filter((function(e){return e.CollectorId===n}));i.length>0&&(t[n]=i)}},r=this,a=0,i=T;a<i.length;a++){n(i[a])}this.onAppDataDictionaryFetched(t,2),this.updateAppsFromCollectors()},t.prototype.updateAppsFromCollectors=function(){var e=this;this.props.doNotCallGetAllAppsUntil&&this.props.doNotCallGetAllAppsUntil>Date.now()||this.getAllAppsFromCollectorsAsync().then((function(t){e.onGetAllAppsSucceeded(t)})).catch((function(){e.invokeAppsUpdatedEvent(null,0,3)}))},t.prototype.onGetAllAppsSucceeded=function(e){if(0!==Object.keys(e).length){for(var t=function(t){if(!e[t]){var r=n.props.appsData.filter((function(e){return e.CollectorId===t}));r.length>0&&(e[t]=r)}},n=this,r=0,a=T;r<a.length;r++){t(a[r])}this.onAppDataDictionaryFetched(e,3)}},t.prototype.onAppDataDictionaryFetched=function(e,t){e.FirstParty&&(e.FirstParty=this.getFirstPartyAppsFromAppsData(this.props.appsData,e.FirstParty)),this.updateMyApps(e,t),this.writeCachedAppsToSessionStorageAsync({timestamp:Date.now(),apps:e,cultureName:this.props.cultureName}).catch((function(){}))},t.prototype.getFirstPartyAppsFromAppsData=function(e,t){for(var n=[],r=0,a=e.filter((function(e){return"FirstParty"===e.CollectorId}));r<a.length;r++){var i=a[r],o=(0,f.Bl)(t,"FirstParty",i.Id);null!=o&&(i.AlternateNames=o.AlternateNames,i.DateInstalled=o.DateInstalled),n.push(i)}if(!n.some((function(e){return"Partner"===e.Id}))){var s=(0,f.Bl)(t,"FirstParty","Partner");null!=s&&n.push(s)}return n},t.prototype.updateMyApps=function(e,t){var n=this.aggregateAppDatas(e);this.props.onSetAppsData(n,t)},t.prototype.invokeAppsUpdatedEvent=function(e,t,n){var a={Apps:e,DataSource:t,FailureReason:n},i=null!=e?"AppsRetrievalSucceeded":"AppsRetrievalFailed";(0,r.Lo)().invoke(i,a)},t.prototype.hasAppsPinnedDataChanged=function(e){if(void 0===this.props.appsPinnedData.apps)return!1;var t=this.props.appsPinnedData.apps,n=e.apps;if(t.length!==n.length)return!0;for(var r=0;r<t.length;r++)if(t[r].CollectorId!==n[r].CollectorId||t[r].Id!==n[r].Id)return!0;return!1},t.prototype.saveCustomization=function(){var e=this,t=this.props.appsPinnedData.apps.map((function(e){return e.Id}));(0,r.jl)().tag("AppsManager_SavingAppsCustomizationData",1,t.join());var n=Date.now();if("number"==typeof n)this.props.appsPinnedData.timestamp=n,this.props.appsPinnedData.cultureName=this.props.cultureName,this.writeAppsPinnedDataToStorageAsync(this.props.appsPinnedData).then((function(){e.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(e.props.appsPinnedData.timestamp).catch((function(){}))})).catch((function(){}));else{var a=null;try{a=Date.now.toString()}catch(e){}(0,r.jl)().tag("AppsManager_InvalidDateNowFunction",6,n,a)}},t.prototype.aggregateAppDatas=function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var a=r[n];e[a]&&t.push.apply(t,e[a])}return t},t.prototype.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync=function(){var e=this;return new Promise((function(t,n){var a=y.nR.Instance.WebShellStorage.createWebShellStorageRequest();a.requestRead(e.lastAppsPinnedDataWriteTimestampKey),y.nR.Instance.WebShellStorage.readSessionStorage(a).then((function(n){n.hasValue(e.lastAppsPinnedDataWriteTimestampKey)?t(n.getValue(e.lastAppsPinnedDataWriteTimestampKey)):t(null)})).catch((function(e){(0,r.jl)().exception("AppsManager_ReadLastAppsPinnedDataWriteTimestamp_Failed",6,e),n(e)}))}))},t.prototype.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync=function(e){var t=this;return new Promise((function(n,r){var a=y.nR.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,t.lastAppsPinnedDataWriteTimestampKey),y.nR.Instance.WebShellStorage.writeSessionStorage(a).then((function(){n(void 0)})).catch((function(e){(0,d.genericServiceRejection)("AppsManager_WriteLastAppsPinnedDataWriteTimestamp_Failed",6,e,r)}))}))},t.prototype.readAppsPinnedDataFromStorageAsync=function(){return new Promise((function(e,t){y.nR.Instance.WebShellStorage.readStorage(v.gD.User,v.rq.SystemMetadata,I).then((function(t){var n=t.value;n&&"string"==typeof n.timestamp&&(n.timestamp=(0,h.s)(n.timestamp).getTime()),e(n)})).catch((function(e){(0,d.genericServiceRejection)("AppsManager_ReadPinnedAppsData_Failed",6,e,t)}))}))},t.prototype.writeAppsPinnedDataToStorageAsync=function(e){if(e&&e.apps){var t=e.apps.length;e.apps=(0,f.Mj)(e.apps),t>e.apps.length&&(0,r.jl)().tag("AppsManager_WriteAppsPinnedData_Deduped",4,t,e.apps.length)}return new Promise((function(t,n){y.nR.Instance.WebShellStorage.writeStorage(v.gD.User,v.rq.SystemMetadata,I,e).then((function(){t(void 0)})).catch((function(e){(0,d.isCallsBlockedException)(e)||(0,r.jl)().exception("AppsManager_WriteAppsPinnedData_Failed",6,e),n(e)}))}))},t.prototype.readAppDataCacheFromStorageAsync=function(){var e=this;return new Promise((function(t,n){var a=(0,g.Uw)("/api/myapps/GetAppDataCache?hasMailboxInCloud={0}&culture={1}",e.props.hasMailboxInCloud.toString(),e.props.cultureName);y.nR.Instance.Service.callWebClientShellServiceFunction(a,"GET",null,null).then((function(e){t(e)})).catch((function(e){(0,d.isCallsBlockedException)(e)||(0,r.jl)().exception("AppsManager_ReadAppDataCacheFromWCSS_Failed",6,e),n(e)}))}))},t.prototype.getAllAppsFromCollectorsAsync=function(){var e=this;return new Promise((function(t,n){var a=(0,g.Uw)("/api/myapps/GetAllApps?culture={0}",e.props.cultureName);y.nR.Instance.Service.callWebClientShellServiceFunction(a,"GET",null,null).then((function(e){t(e)})).catch((function(e){(0,d.isCallsBlockedException)(e)||(0,r.jl)().exception("AppsManager_AppCollectorFetch_Failed",6,e),n(e)}))}))},t.prototype.readCachedAppsFromSessionStorageAsync=function(){var e=this;return new Promise((function(t,n){var a=y.nR.Instance.WebShellStorage.createWebShellStorageRequest();a.requestRead(e.cachedAppsDataKey),y.nR.Instance.WebShellStorage.readSessionStorage(a).then((function(n){n.hasValue(e.cachedAppsDataKey)?t(n.getValue(e.cachedAppsDataKey)):t(void 0)})).catch((function(e){(0,d.isCallsBlockedException)(e)||(0,r.jl)().exception("AppsManager_ReadCacheAppsData_Failed",6,e,e.errorCode),n(e)}))}))},t.prototype.writeCachedAppsToSessionStorageAsync=function(e){var t=this;return new Promise((function(n,r){var a=y.nR.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,t.cachedAppsDataKey),y.nR.Instance.WebShellStorage.writeSessionStorage(a).then((function(){n(void 0)})).catch((function(e){(0,d.genericServiceRejection)("AppsManager_WriteCacheAppsData_Failed",6,e,r)}))}))},t.prototype.getAppDataDetailsAsync=function(e){var t=this;return new Promise((function(n,a){var i=(0,g.Uw)("/api/myapps/GetAppDetails?culture={0}",t.props.cultureName),o={CollectorId:e.CollectorId,Id:e.Id,Title:e.Title,Properties:e.Properties};y.nR.Instance.Service.callWebClientShellServiceFunction(i,"POST",null,o).then((function(e){n(e)})).catch((function(e){(0,d.isCallsBlockedException)(e)||(0,r.jl)().exception("Apps_FetchDetailsForCollector_Failed",6,e),a(e)}))}))},t}(a.Component),w=(0,o.connect)((function(e){return{appsData:e.appsDataState.apps,appsPinnedData:e.appLauncherState.appsPinnedData,cultureName:e.userState.cultureName,timestamp:e.appsManagerState.timestamp,appsUpdateTimeSpan:e.appsManagerState.appsUpdateTimeSpan,hasMailboxInCloud:e.userState.hasMailboxInCloud,appDataCache:e.appsManagerState.appDataCache,moreAppDataAvailable:e.appsManagerState.moreAppDataAvailable,doNotCallGetAllAppsUntil:e.appsManagerState.doNotCallGetAllAppsUntil,disableSessionStorageCache:(0,c.So)(e.shellInitDataState.clientData.WorkloadId,e.shellInitDataState.navBarData.CurrentMainLinkElementID)}}),(function(e){return{onSetAppsData:function(t,n){e((0,l.Cj)(t,n))},onSetAppsPinnedData:function(t){e((0,u.$W)(t))},onEnableCustomization:function(){e((0,u.wc)())},onSetImageDataUrl:function(t,n,r){e((0,l.bv)(t,n,r))},onSetAppDataDetails:function(t){e((0,u.lH)(t))}}}))(D);function A(e,t){return t?(0,p.__assign)((0,p.__assign)({},e),{appsUpdateTimeSpan:t.AppsUpdateTimeSpan,timestamp:t.Timestamp,appDataCache:t.AppDataCache,moreAppDataAvailable:t.MoreAppDataAvailable,doNotCallGetAllAppsUntil:t.DoNotCallGetAllAppsUntil}):e}var O={appsManagerState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=A(s.y3,n.clientData)}return t.type===s.ri?A(e,t.shellClientData):e}},x=n(32217),L=n(90711),k=(0,s.ef)(),R=function(){function e(){this.callbackPairings=[]}return e.prototype.IsCustomizationEnabled=function(){return k.getState().appLauncherState.isCustomizable},e.prototype.IsPinned=function(e,t){return null!=L.K2(k.getState().appLauncherState.pinnedAppTiles,e,t)},e.prototype.Pin=function(e,t){var n;"string"==typeof e?n=f.Bl(k.getState().appsDataState.apps,e,t):((0,r.jl)().tag("AppLauncher_PinnedCalledWithAppData",1),n=f.Bl(k.getState().appsDataState.apps,e.CollectorId,e.Id)),n&&k.dispatch((0,x.iR)(n))},e.prototype.Unpin=function(e,t){k.dispatch((0,x.v5)(e,t))},e.prototype.Reset=function(){(0,r.Lo)().invoke("AppsReset")},e.prototype.Update=function(){(0,r.Lo)().invoke("AppsUpdate")},e.prototype.OnAppsUpdated=function(e){var t=this,n=function(n){e(t.deepCloneAppsUpdatedEventArgs(n))},a=(0,r.Lo)(),i=a.subscribe("AppsRetrievalSucceeded",n,!0),o=a.subscribe("AppsRetrievalFailed",n,!0);return this.callbackPairings.push({successCallbackToken:i,failureCallbackToken:o}),i},e.prototype.RemoveOnAppsUpdated=function(e){for(var t=0,n=(0,r.Lo)(),a=0,i=this.callbackPairings;a<i.length;a++){var o=i[a];if(o.successCallbackToken===e){n.unsubscribe("AppsRetrievalSucceeded",o.successCallbackToken),n.unsubscribe("AppsRetrievalFailed",o.failureCallbackToken);break}t++}t<this.callbackPairings.length&&this.callbackPairings.splice(t,1)},e.prototype.GetAuthenticatedAppIcon=function(e,t){null==e.FontIconCss&&null==e.IconAnonymousUrl?b(e).then(t).catch((function(){t(null)})):t(null)},e.prototype.deepCloneAppsUpdatedEventArgs=function(e){var t=JSON.parse(JSON.stringify(e));if(t.Apps)for(var n=0,r=t.Apps;n<r.length;n++){var a=r[n];"FirstParty"===a.CollectorId&&(a.Id=f._X(a.Id,"add"))}return t},e}();function P(e,t){if(e.IsAuthenticated&&t.Timestamp>0){(0,r.Lo)().unsubscribe("ShellDataUpdated",P);var n=(0,s.ef)();i.render(a.createElement(o.Provider,{store:n},a.createElement(w,null)),document.createElement("div"))}}var E,U=n(84159);n(5719);var F=n(3073),N=n(48212),_=n(72607),M=n(73750),H=n(70163),q=n(82548),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,p.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&(0,r.jl)().perfMarker("HelpTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:S.b.Help_Title,affordanceMenuItemText:S.b.Help,iconID:this.props.flipHelpIcon?"HelpMirrored":"Help",iconFontSize:q.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?a.createElement(H.sO,(0,p.__assign)({},e)):a.createElement(H.b,(0,p.__assign)({},e))},t}(a.Component),W=(0,o.connect)((function(e,t){var n,r;return{isAvailable:!(null===(r=null===(n=e.shellInitDataState)||void 0===n?void 0:n.clientData)||void 0===r?void 0:r.HelpPaneDisabled),id:t&&t.id,isActive:e.flexPaneState&&"Help"===e.flexPaneState.activeProviderKey,flipHelpIcon:e.headerState&&e.headerState.flipHelpIcon,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),(0,r.jl)().click("Help","NavBar",null,null,"Active state: ".concat(n.isActive,", Render context: ").concat(n.renderContext)),e((0,s.uS)(t&&t.currentTarget&&t.currentTarget.id));var a=(0,r.aH)();!a||null!=a.OnHelpButtonClick&&a.OnHelpButtonClick()||e((0,N.yG)("Help")),n.onClick&&n.onClick(t)}}}),(function(e,t,n){var r=(0,p.__assign)((0,p.__assign)({},n),e);return(0,p.__assign)((0,p.__assign)((0,p.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(B),j=null;function G(e,t){var n;n=t.EnableVNextFeedback?(0,F.k)((function(){return j().then((function(e){return e.FeedbackButtonPanelConnector}))})):(0,F.k)((function(){return j().then((function(e){return e.FeedbackFlexPaneConnector}))})),(0,s.ef)().dispatch((0,N.wd)({component:n,key:"Feedback",width:N.yh}))}var K=n(90684);function z(e,t){var a=function(){return n.e("otellogging").then(n.bind(n,37698))};t.AriaTelemetryEnabled&&(!t.IsConsumerShell&&t.PUID?(0,K.C)(t)&&t.TID&&a().then((function(n){n.initializeLogging(e,t),(0,r.Lo)().unsubscribe("ShellDataUpdated",z)})):a().then((function(n){n.initializeLogging(e,t),(0,r.Lo)().unsubscribe("ShellDataUpdated",z)})))}var V=n(32825);var Z=!1;function Q(e,t){if(!Z&&t&&t.FootprintTelemetryEnabled){if(Z=!0,!s.Zp.isMobileClient()&&!(0,s.NN)(t.WorkloadId,t.FootprintWorkloadExcludeList)){var n="https://r4.res.office365.com/footprint/v3.2/scripts/fp-min.js";window.O365ShellContext.TrustedResources.add(n),(a=n,new Promise((function(e,t){var n=encodeURI(a),r=document.createElement("script");r.src=window.O365ShellContext.TrustedTypesPolicies[V.GD].createScriptURL(n),r.type="text/javascript",r.crossOrigin="anonymous",r.onerror=function(e){t({ResourceName:a,Details:e.message})},r.onload=function(){e(null)},document.body.appendChild(r)}))).then((function(){var n,a="",i=(0,c.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),o="gallatin",s=(0,g.pn)((null===(n=t.Environment)||void 0===n?void 0:n.toLowerCase())||"",o)?o:"";t.IsConsumerShell?a="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa":t.TID&&(a=t.TID);try{var u=["config.fp.measure.office.com/conf/v2/o365se".concat(s,"/fpconfig.min.json"),"r4.res.office365.com/footprint/v3.2/scripts/fpconfig.json"];Footprint.start("O365se"+s,u,1e4,JSON.stringify([{TenantId:a,AppId:i}]))}catch(e){(0,r.jl)().tag("Footprint_StartFailed",6,e||"")}})).catch((function(e){(0,r.jl)().tag("Footprint_LoadFailed",4,e.ResourceName,e.Details)}))}(0,r.Lo)().unsubscribe("ShellDataUpdated",Q)}var a}var X=n(49472),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,p.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&(0,r.jl)().perfMarker("SettingsTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:S.b.Settings,affordanceMenuItemText:S.b.Settings,iconID:"Settings",iconFontSize:q.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?a.createElement(H.sO,(0,p.__assign)({},e)):a.createElement(H.b,(0,p.__assign)({},e))},t}(a.Component),Y=n(14643),$=(0,o.connect)((function(e,t){var n=!1;e.shellInitDataState.layout&&(n=!!e.shellInitDataState.clientData.SettingsPaneEnabled&&(0,Y.F)((0,p.__assign)((0,p.__assign)({},e.shellInitDataState.clientData),{CurrentMainLinkElementID:e.shellInitDataState.navBarData.CurrentMainLinkElementID}),null,e.settingsFlexPaneState.workloadSettingLinks).length>0);return{isAvailable:n,id:t&&t.id,isActive:e.flexPaneState&&"Settings"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),(0,r.jl)().click("Settings","NavBar",null,null,"Active state: ".concat(n.isActive,", Render context: ").concat(n.renderContext)),n.onClick&&n.onClick(t),e((0,s.uS)(t.currentTarget&&t.currentTarget.id)),e((0,N.yG)("Settings"))}}}),(function(e,t,n){var r=(0,p.__assign)((0,p.__assign)({},n),e);return(0,p.__assign)((0,p.__assign)((0,p.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(J),ee=n(84735),te=n(63481),ne=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,re=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,ae=/[^-+\dA-Z]/g;function ie(e,t,n,r){if(1!==arguments.length||"string"!=typeof e||/\d/.test(e)||(t=e,e=void 0),(e=e||0===e?e:new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var a=(t=String(oe[t]||t||oe.default)).slice(0,4);"UTC:"!==a&&"GMT:"!==a||(t=t.slice(4),n=!0,"GMT:"===a&&(r=!0));var i=function(){return n?"getUTC":"get"},o=function(){return e[i()+"Date"]()},s=function(){return e[i()+"Day"]()},u=function(){return e[i()+"Month"]()},l=function(){return e[i()+"FullYear"]()},c=function(){return e[i()+"Hours"]()},p=function(){return e[i()+"Minutes"]()},d=function(){return e[i()+"Seconds"]()},f=function(){return e[i()+"Milliseconds"]()},h=function(){return n?0:e.getTimezoneOffset()},g=function(){return ce(e)},m={d:function(){return o()},dd:function(){return ue(o())},ddd:function(){return se.dayNames[s()]},DDD:function(){return le({y:l(),m:u(),d:o(),_:i(),dayName:se.dayNames[s()],short:!0})},dddd:function(){return se.dayNames[s()+7]},DDDD:function(){return le({y:l(),m:u(),d:o(),_:i(),dayName:se.dayNames[s()+7]})},m:function(){return u()+1},mm:function(){return ue(u()+1)},mmm:function(){return se.monthNames[u()]},mmmm:function(){return se.monthNames[u()+12]},yy:function(){return String(l()).slice(2)},yyyy:function(){return ue(l(),4)},h:function(){return c()%12||12},hh:function(){return ue(c()%12||12)},H:function(){return c()},HH:function(){return ue(c())},M:function(){return p()},MM:function(){return ue(p())},s:function(){return d()},ss:function(){return ue(d())},l:function(){return ue(f(),3)},L:function(){return ue(Math.floor(f()/10))},t:function(){return c()<12?se.timeNames[0]:se.timeNames[1]},tt:function(){return c()<12?se.timeNames[2]:se.timeNames[3]},T:function(){return c()<12?se.timeNames[4]:se.timeNames[5]},TT:function(){return c()<12?se.timeNames[6]:se.timeNames[7]},Z:function(){return r?"GMT":n?"UTC":de(e)},o:function(){return(h()>0?"-":"+")+ue(100*Math.floor(Math.abs(h())/60)+Math.abs(h())%60,4)},p:function(){return(h()>0?"-":"+")+ue(Math.floor(Math.abs(h())/60),2)+":"+ue(Math.floor(Math.abs(h())%60),2)},S:function(){return["th","st","nd","rd"][o()%10>3?0:(o()%100-o()%10!=10)*o()%10]},W:function(){return g()},WW:function(){return ue(g())},N:function(){return pe(e)}};return t.replace(ne,(function(e){return e in m?m[e]():e.slice(1,e.length-1)}))}var oe={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},se={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(e).padStart(t,"0")},le=function(e){var t=e.y,n=e.m,r=e.d,a=e._,i=e.dayName,o=e.short,s=void 0!==o&&o,u=new Date,l=new Date;l.setDate(l[a+"Date"]()-1);var c=new Date;c.setDate(c[a+"Date"]()+1);return u[a+"FullYear"]()===t&&u[a+"Month"]()===n&&u[a+"Date"]()===r?s?"Tdy":"Today":l[a+"FullYear"]()===t&&l[a+"Month"]()===n&&l[a+"Date"]()===r?s?"Ysd":"Yesterday":c[a+"FullYear"]()===t&&c[a+"Month"]()===n&&c[a+"Date"]()===r?s?"Tmw":"Tomorrow":i},ce=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-r);var a=(t-n)/6048e5;return 1+Math.floor(a)},pe=function(e){var t=e.getDay();return 0===t&&(t=7),t},de=function(e){return(String(e).match(re)||[""]).pop().replace(ae,"").replace(/GMT\+0000/g,"UTC")},fe=n(9028),he="UTC",ge="tzone://Microsoft/Utc",me=function(){function e(){this.timeZones=null,this.timeZoneOffsets=[]}return Object.defineProperty(e.prototype,"isInitialized",{get:function(){return null!=this.timeZones&&this.timeZoneOffsets.length>0},enumerable:!1,configurable:!0}),e.prototype.initializeTimeZoneConverter=function(e){this.timeZoneOffsets=e,this.timeZones={}},e.prototype.convert=function(e,t,n){if(null===this.timeZones)throw Error("LoadTimeZoneOffsets must be called before convert.");if(e===ge&&(e=he),t===ge&&(t=he),null==n||e===t)return n;var r=be.parseISO8601DateTime(n),a=0;e===he?(a=this.findOffsetInUTC(t,r),r=r.addMinutes(a)):t===he?(a=this.findOffsetInLocal(e,r),r=r.addMinutes(0-a)):(a=this.findOffsetInLocal(e,r),r=r.addMinutes(0-a),a=this.findOffsetInUTC(t,r),r=r.addMinutes(a));var i=-1===n.indexOf(".")?be.generateISO8601DateTimeString(r):be.generateISO8601DateTimeMsString(r);if(t===he)i+="Z";else{var o=Math.abs(a),s=Math.floor(o/60),u=o%60;i+=(a<0?"-":"+")+(s<10?"0"+s:s.toString())+":"+(u<10?"0"+u:u.toString())}return i},e.prototype.findOffsetInLocal=function(e,t){var n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(var r=0,a=n;r<a.length;r++){var i=a[r];if(t.compare(i.localStart)>=0&&t.compare(i.localEnd)<0)return i.offset}throw new Error("Could not find an offset for this time stamp")},e.prototype.findOffsetInUTC=function(e,t){var n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(var r=0,a=n;r<a.length;r++){var i=a[r];if(t.compare(i.utcStart)>=0&&t.compare(i.utcEnd)<0)return i.offset}throw new Error("Could not find an offset for this time stamp")},e.prototype.ConvertDateTimeMembersTimeZone=function(e,t,n,r,a,i){throw new Error("Unimplemented.")},e.prototype.getTimeZoneRanges=function(e){var t=this.timeZones[e];return null==t&&(this.loadOffsetsForTimezone(e),t=this.timeZones[e]),t},e.prototype.loadOffsetsForTimezone=function(e){for(var t,n=0,a=this.timeZoneOffsets;n<a.length;n++){var i=a[n];if(e===i.TimeZoneId){t=i.OffsetRanges;break}}if(t&&0!==t.length){var o=t.map((function(e){return{utcStart:be.parseISO8601DateTime(e.UtcTime),offset:e.Offset}}));o.forEach((function(e,t){if(0===t?(e.utcStart=be.MinValue,e.localStart=be.MinValue):e.localStart=e.utcStart.addMinutes(e.offset),t+1===o.length)e.utcEnd=be.MaxValue,e.localEnd=be.MaxValue;else{var n=o[t+1];e.utcEnd=n.utcStart,e.localEnd=e.utcEnd.addMinutes(Math.max(e.offset,n.offset))}})),this.timeZones[e]=o}else(0,r.jl)().tag("TimeZoneConverter_NoIncomingOffsetRanges",6,e)},e}(),Se={TimeFormat:"hh:mm tt",DateFormat:"MM/dd/yyyy",TimeZone:"Pacific Standard Time",UserCulture:"default",WeekStartDay:0,FirstWeekOfYear:0,get TimeZoneOffsets(){return[{TimeZoneId:this.TimeZone,OffsetRanges:[{UtcTime:"1970-01-01T00:00:00Z",Offset:-180}]}]}},ye=function(){function e(e){var t=e.UserOptions||{},n=t.MailboxTimeZoneOffset;this.timeFormat=t.TimeFormat||Se.TimeFormat,this.dateFormat=t.DateFormat||Se.DateFormat,this.timeZone=t.TimeZone||Se.TimeZone,this.userCulture=null!=e.SessionSettings?e.SessionSettings.UserCulture:Se.UserCulture,this.weekStartDay=null!=t.WeekStartDay?t.WeekStartDay:Se.WeekStartDay,this.firstWeekOfYear=null!=t.FirstWeekOfYear?t.FirstWeekOfYear:Se.FirstWeekOfYear,this.timeZoneConverter=new me,this.timeZoneConverter.initializeTimeZoneConverter(null!=n?n:Se.TimeZoneOffsets)}return Object.defineProperty(e,"Instance",{get:function(){return null==e.instance&&(e.instance=new e({})),e.instance},enumerable:!1,configurable:!0}),e.populate=function(t){e.instance=new e(t)},e}(),ve=n(98630),Ce=864e13,be=function(){function e(t,n,r,a,i,o,s,u){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),n<0||n>11||r<0||r>31||a<0||a>23||i<0||i>59||o<0||o>59||s<0||s>999)throw new Error("Date part out of range.");this.localTime=new Date(Date.UTC(t,n,r,a,i,o,s)),this.utcOffsetInMinutes=null==u?e.timeZoneConverter.findOffsetInLocal(e.timeZone,e.fromNativeDateTime(this.localTime)):u,e.throwIfDateOutOfRange(this)}return Object.defineProperty(e.prototype,"date",{get:function(){return this.localTime.getUTCDate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return this.localTime.getUTCMonth()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"year",{get:function(){return this.localTime.getUTCFullYear()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hour",{get:function(){return this.localTime.getUTCHours()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.localTime.getUTCSeconds()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minute",{get:function(){return this.localTime.getUTCMinutes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"millisecond",{get:function(){return this.localTime.getUTCMilliseconds()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"timeZone",{get:function(){return ye.Instance.timeZone},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Now",{get:function(){var t=e.timeZoneConverter.convert(he,e.timeZone,e.generateISO8601DateTimeMsStringWithOffset(e.UTCNow));return e.parseISO8601DateTime(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"timeZoneConverter",{get:function(){return ye.Instance.timeZoneConverter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UTCNow",{get:function(){return e.fromNativeDateTime(new Date).toUTC()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"now",{get:function(){var t=e.timeZoneConverter.convert(he,e.timeZone,e.generateISO8601DateTimeMsStringWithOffset(e.UTCNow));return e.parseISO8601DateTime(t)},enumerable:!1,configurable:!0}),e.fromNativeDateTime=function(t){return new e(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),-t.getTimezoneOffset())},e.prototype.format=function(t){return ie(this.localTime,e.getDateFormatMask(t),!0)},e.parseISO8601DateTime=function(t){void 0===t&&(t="");var n=e.isoRegex.exec(t);if(null==n||15!==n.length)throw new Error((0,g.Uw)("Unexpected datetime format (value: {0}).",t));var r=parseInt(n[1],10),a=parseInt(n[2],10),i=parseInt(n[3],10),o=0,s=0,u=0,l=0,c=0;return null!=n[5]&&null!=n[6]&&null!=n[7]&&(o=parseInt(n[5],10),s=parseInt(n[6],10),u=parseInt(n[7],10),null!=n[9]&&(l=parseInt(n[9],10))),null!=n[10]&&"Z"!==n[10].toUpperCase()&&(c+=60*parseInt(n[13],10),c+=parseInt(n[14],10),"-"===n[12]&&(c=-c)),new e(r,a-1,i,o,s,u,l,c)},e.generateISO8601DateTimeString=function(t){return e.generateISO8601DateTimeMsString(t,!1)},e.generateISO8601DateTimeMsString=function(e,t){void 0===t&&(t=!0);var n="yyyy-MM-dd'T'HH:mm:ss"+(t?".l":"");return e.format(n)},e.generateISO8601DateTimeMsStringWithOffset=function(t){return e.generateISO8601DateTimeMsString(t)+t.getUtcOffsetDisplayString()},e.prototype.getUtcOffsetDisplayString=function(){if(0===this.utcOffsetInMinutes)return"Z";var e=Math.floor(Math.abs(this.utcOffsetInMinutes)/60),t=Math.abs(this.utcOffsetInMinutes)%60,n=this.utcOffsetInMinutes<0?"-":"+";return(0,g.Uw)("{0}{1}:{2}",n,Ie(e,2),Ie(t,2))},e.areDatePartsEqual=function(e,t){return null===e&&null===t||null!==e&&null!=t&&0===e.compareDatePart(t)},e.prototype.compare=function(e){return fe.throwOnNullOrUndefined(e,"other"),this.localTime.getTime()-e.localTime.getTime()},e.prototype.clone=function(){var t=new e(0,0,0,0,0,0,0,0);return t.localTime.setTime(this.localTime.getTime()),t.utcOffsetInMinutes=this.utcOffsetInMinutes,t},e.prototype.addMilliseconds=function(t){e.throwIfNotNumber(t);var n=this.clone(),r=n.localTime.getTime()+t;return n.localTime.setTime(r),e.throwIfDateOutOfRange(n),n},e.prototype.Subtract=function(e){return fe.throwOnNullOrUndefined(e,"value"),this.localTime.getTime()-e.localTime.getTime()},e.prototype.addSeconds=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(1e3*t)},e.prototype.addMinutes=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*ve.rP)},e.prototype.addHours=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*ve.yo)},e.prototype.addDays=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*ve.tL)},e.prototype.toUTC=function(){if(0===this.utcOffsetInMinutes)return this;var e=this.addMinutes(-this.utcOffsetInMinutes);return e.utcOffsetInMinutes=0,e},e.prototype.getNativeDateTime=function(){return new Date(this.toUTC().getUTCMilliseconds())},e.prototype.getUTCMilliseconds=function(){return this.toUTC().localTime.getTime()},e.prototype.GetMilliseconds=function(){return this.localTime.getTime()},e.prototype.compareDatePart=function(t){return e.getDatePartHashValue(this)-e.getDatePartHashValue(t)},e.throwIfNotNumber=function(e){if("number"!=typeof e)throw Error("Argument must be of type number, but is type "+typeof e)},e.throwIfDateOutOfRange=function(t){if(!e.isValidDate(t))throw new Error("The resulting DateTime is less than MinValue or greater than MaxValue")},e.isValidDate=function(e){return null!=e&&!isNaN(e.localTime.getTime())&&e.localTime.getTime()>=-864e13&&e.localTime.getTime()<=Ce},e.getDatePartHashValue=function(e){return e.date+(e.month<<5)+(e.year<<9)},e.getDateFormatMask=function(e){var t=!1;return e.replace(/[mMtT']/g,(function(e){if(t)return t="'"!==e,e;switch(e){case"'":return t=!0,e;case"m":return"M";case"M":return"m";case"t":return"T";case"T":return"t";default:return e}}))},e.isoRegex=/^(\d{4})-(\d{2})-(\d{2})(T(\d{2}):(\d{2}):(\d{2})([,\.](\d{3})\d*){0,1}){0,1}(Z|(([-\+])(\d{2}):?(\d{2}))){0,1}$/,e.MaxValue=new e(275760,8,13,0,0,0,0,0),e.MinValue=new e(-271821,3,20,0,0,0,0,0),e}();function Ie(e,t){for(var n=e.toString();n.length<t;)n="0"+n;return n}var Te=n(42810),De=n(30534);function we(e,t,n,a){return e?(0,p.__assign)((0,p.__assign)({},e),{workloadData:n,workloadSettingLinksTitle:e.workloadSettingLinksTitle||a&&a.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:(0,p.__spreadArray)((0,p.__spreadArray)([],t.CurrentWorkloadSettingsSubLinks||[],!0),a&&a.workloadSettingsSubLinks||[],!0)}):(0,p.__assign)((0,p.__assign)({},e),{themeCardState:{selectedThemeId:(0,r.q4)().getCurrentThemeId(),themeData:[],preferOfficeTheme:(0,r.q4)().getThemeState().preferOfficeTheme,fullBleedThemesEnabled:n&&n.EduThemingEnabled&&(n.ActiveExperiences||"").split(",").some((function(e){return"edu"===e.toLowerCase()})),showMonarchColorThemes:n&&n.ShowMonarchColorThemes},languageAndRegionCardState:{selectedLanguage:"",selectedDateFormat:"",selectedTimeFormat:"",selectedTimeZone:"",languageChoices:[],timeZoneChoices:[],dateFormatChoices:[],timeFormatChoices:[],savedLanguage:"",savedDateFormat:"",savedTimeFormat:"",savedTimeZone:""},aboutCardState:{correlationID:a&&a.correlationID?a.correlationID:S.b.NotAvailable,sessionID:a&&a.sessionID?a.sessionID:S.b.NotAvailable,version:a.version?a.version:S.b.NotAvailable},workloadData:n,workloadId:n&&n.WorkloadId?n.WorkloadId:"",expandO365Settings:!1,workloadSettingLinksTitle:a&&a.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:(0,p.__spreadArray)((0,p.__spreadArray)([],t.CurrentWorkloadSettingsSubLinks||[],!0),a&&a.workloadSettingsSubLinks||[],!0),cards:[]})}function Ae(e){var t=-1!==e.indexOf("HH");return new be(2018,8,1,t?21:9,5).format(e).replace("Sep",S.b.SeptemberAbbrev).replace("September",S.b.September)}var Oe={settingsFlexPaneState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=we(null,n.navBarData,n.clientData,n.renderSettings)}switch(t.type){case s.ri:var a=t;return we(e,a.navBarData,a.shellClientData,a.renderSettings);case De.do:return function(e,t){var n=t,r=(0,s.GS)(e.workloadSettingLinks,(function(e){return e.Id===n.newWorkloadSettingLink.Id}));if(!(0,ee.l)(n.newWorkloadSettingLink))return e;var a=r>=0?(0,p.__assign)((0,p.__assign)({},e),{workloadSettingLinks:(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],e.workloadSettingLinks.slice(0,r),!0),[n.newWorkloadSettingLink],!1),e.workloadSettingLinks.slice(r+1),!0)}):(0,p.__assign)((0,p.__assign)({},e),{workloadSettingLinks:e.workloadSettingLinks.concat(n.newWorkloadSettingLink)});return a}(e,t);case De.w0:return function(e,t){var n=t,r=(0,s.GS)(e.workloadSettingLinks,(function(e){return e.Id===n.settingLinkID}));if(r>=0)return(0,p.__assign)((0,p.__assign)({},e),{workloadSettingLinks:(0,p.__spreadArray)((0,p.__spreadArray)([],e.workloadSettingLinks.slice(0,r),!0),e.workloadSettingLinks.slice(r+1),!0)});return e}(e,t);case De.K4:return function(e,t){var n=t,r=n.newWorkloadSettingsLinks.filter((function(e){return(0,ee.l)(e)}));if(0===r.length)return e;return(0,p.__assign)((0,p.__assign)({},e),{workloadSettingLinks:r})}(e,t);case De.SL:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{cards:n.cardData})}(e,t);case s.hs:return function(e,t){var n=t,a=(0,r.q4)().getUserPersonalizationAllowed(),i=(0,Te.bp)(n.themeData||[],e.themeCardState.selectedThemeId,e.themeCardState.preferOfficeTheme,a);return(0,p.__assign)((0,p.__assign)({},e),{themeCardState:(0,p.__assign)((0,p.__assign)({},e.themeCardState),{themeData:i})})}(e,t);case s.Ou:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{themeCardState:(0,p.__assign)((0,p.__assign)({},e.themeCardState),{selectedThemeId:n.themeInfo.ThemeId||te.fy,preferOfficeTheme:n.themeInfo.PreferOfficeTheme})})}(e,t);case De.Cr:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage,savedLanguage:n.selectedLanguage})})}(e,t);case De.EF:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{languageChoices:n.languageChoices.map((function(e){return{id:e.Locale,text:e.DisplayName,language:e.Locale}}))})})}(e,t);case De.J5:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage})})}(e,t);case De.lj:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{selectedTimeZone:n.timeZoneChoice,selectedDateFormat:n.dateFormatChoice,selectedTimeFormat:n.timeFormatChoice,savedTimeZone:n.timeZoneChoice,savedDateFormat:n.dateFormatChoice,savedTimeFormat:n.timeFormatChoice})})}(e,t);case De.rg:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{timeZoneChoices:n.timeZoneChoices.map((function(e){return{id:e.alias,text:e.displayName}}))})})}(e,t);case De.$w:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{selectedTimeZone:n.selectedTimeZone})})}(e,t);case De.$I:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{dateFormatChoices:n.dateFormatChoices.map((function(e){return{id:e,text:Ae(e)}}))})})}(e,t);case De.Oy:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{selectedDateFormat:n.selectedDateFormat})})}(e,t);case De.i1:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{timeFormatChoices:n.timeFormatChoices.map((function(e){return{id:e,text:Ae(e)}}))})})}(e,t);case De.sI:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},e.languageAndRegionCardState),{selectedTimeFormat:n.selectedTimeFormat})})}(e,t);case De.NS:return function(e){var t=e.languageAndRegionCardState;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},t),{savedLanguage:t.selectedLanguage,savedTimeZone:t.selectedTimeZone,savedDateFormat:t.selectedDateFormat,savedTimeFormat:t.selectedTimeFormat})})}(e);case De.M9:return function(e){var t=e.languageAndRegionCardState;return(0,p.__assign)((0,p.__assign)({},e),{languageAndRegionCardState:(0,p.__assign)((0,p.__assign)({},t),{selectedLanguage:t.savedLanguage,selectedTimeZone:t.savedTimeZone,selectedDateFormat:t.savedDateFormat,selectedTimeFormat:t.savedTimeFormat})})}(e);case De.Vx:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{parentCardId:n.cardId})}(e,t);case De.nl:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{expandO365Settings:n.isExpanded})}(e,t);default:return e}}},xe=n(55309),Le=function(){function e(){}return e.prototype.AddOrUpdateWorkloadSettingLink=function(e){(0,s.ef)().dispatch((0,xe.jG)(e))},e.prototype.RemoveWorkloadSettingLink=function(e){(0,s.ef)().dispatch((0,xe.N0)(e))},e.prototype.SetWorkloadSettingsLinks=function(e){(0,s.ef)().dispatch((0,xe.eV)(e))},e}();function ke(e,t){var n=(0,r.aH)().layout,a=(0,s.ef)().getState().settingsFlexPaneState.workloadSettingLinks;if(!n){var i=t.SettingsPaneEnabled&&(0,Y.F)((0,p.__assign)((0,p.__assign)({},t),{CurrentMainLinkElementID:e.CurrentMainLinkElementID}),null,a).length>0,o=document.getElementById(_.JT);o&&i&&(o.style.display="block")}}var Re=n(24695),Pe=n(51932),Ee=n(40719);function Ue(e,t,n){return(0,p.__assign)((0,p.__assign)({},e),{webChatSDKUrl:t.WebChatSDKUrl||null,chatWebLink:t.ChatWebLink||null,chatEnabled:!!t.ChatEnabled&&!s.Zp.isMobileClient(),isConsumerShell:t.IsConsumerShell,chatButtonRenderedCallback:n.chatButtonRenderedCallback})}var Fe={chatState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=Ue(s.mI,n.clientData||{},n.renderSettings||{})}switch(t.type){case s.ri:var r=t;return Ue(e,r.shellClientData,r.renderSettings);case s.__:return function(e,t){var n=t;e.isConsumerShell&&(0,Pe.yX)(n.isRecentsOpen,e.isTeamsChatActivated);return(0,p.__assign)((0,p.__assign)({},e),{isChatRecentsPaneOpen:n.isRecentsOpen})}(e,t);case Ee.q:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{isChatRecentsPaneInitialized:n.isRecentsInitialized})}(e,t);case Ee.D:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{isChatAPIInitialized:n.isChatAPIInitialized})}(e,t);case Ee.nZ:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{unreadBadgeValue:n.unreadBadgeValue})}(e,t);case Ee.YI:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{isTeamsChatActivated:n.isTeamsChatActivated})}(e,t);case Ee.Ak:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{initChatOnFirstClick:n.initChatOnFirstClick})}(e,t);case Ee.M3:return function(e,t){return(0,p.__assign)((0,p.__assign)({},e),{isTeamsChatAuthFailed:!0})}(e);case Ee.P7:return function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{isChatAPIPreAuthCompleted:n.isChatAPIPreAuthCompleted})}(e,t);default:return e}}};var Ne=!1;function _e(e,t){if(t.ChatEnabled&&!Ne){Ne=!0;var u=(0,s.ef)(),l=(0,r.aH)()&&(0,r.aH)().layout;if(l)l.centerCustomizationRegion&&(0,s.Y5)("ChatIcon",l.centerCustomizationRegion.children)&&n.e("chat").then(n.bind(n,51907)).then((function(e){var t=e.ChatHeaderButtonConnector;(0,r.Lo)().invoke("LazyComponentLoaded",Re.U,t),e.initializeChatComponent()}));else{var c=document.getElementById(_.en);c&&n.e("chat").then(n.bind(n,51907)).then((function(e){e.initializeChatComponent();var t=e.ChatIconConnector;i.render(a.createElement(o.Provider,{store:u},a.createElement(t,null)),c)}))}}}var Me=n(31047),He=n(85620),qe=function(e){function t(t){var n=e.call(this,t)||this;return n.preventEscPropagation=function(e){27===e.keyCode&&e.stopPropagation()},n.state={isShyHeaderActive:!1},(0,r.Lo)().subscribe("ShyHeaderActivated",(function(e){n.setState({isShyHeaderActive:e})}),!0),n}return(0,p.__extends)(t,e),t.prototype.onComponentVisible=function(){e.prototype.onComponentVisible.call(this),(0,r.jl)().impression("CustomFlexPane","FlexPane",0,void 0,"Loaded"),this.props.onFlexPaneOpen&&this.props.onFlexPaneOpen(),this.customRenderContainer&&this.props.render&&this.props.render(this.customRenderContainer)},t.prototype.onComponentHide=function(){e.prototype.onComponentHide.call(this),this.props.onFlexPaneClose&&this.props.onFlexPaneClose()},t.prototype.componentWillUnmount=function(){this.customRenderContainer&&i.unmountComponentAtNode(this.customRenderContainer),e.prototype.componentWillUnmount.call(this)},t.prototype.render=function(){var e,t=this;return a.createElement(N.Ou,{isActive:this.props.isActive,title:this.props.flexPaneTitle(),customTitle:this.props.customTitle,flexPaneProviderID:this.props.flexPaneProviderID,className:this.props.className},a.createElement("div",{id:"CustomFlexPane_".concat(this.props.flexPaneProviderID),role:"region",className:(0,s.iv)(He.flexPaneContentContainer,He.flexPaneContentContainerForThinHeader,(e={},e[He.flexPaneContentContainerForShyHeader]=this.state.isShyHeaderActive,e)),onKeyDown:this.props.customEscapeKeyHandling&&this.preventEscPropagation,ref:function(e){return t.customRenderContainer=e}}))},t}(N.yJ),Be=(0,o.connect)((function(e,t){var n=e.extensibilityState.customFlexPanes[t.flexPaneProviderID];return n?(0,p.__assign)((0,p.__assign)({},t),{className:n.containerClassName,flexPaneTitle:function(){return"function"==typeof n.flexPaneTitle?n.flexPaneTitle():n.flexPaneTitle},customTitle:n.customTitle,render:n.render,customEscapeKeyHandling:n.customEscapeKeyHandling,onFlexPaneOpen:n.onFlexPaneOpen,onFlexPaneClose:n.onFlexPaneClose,triggerControlID:n.triggerControlID}):((0,r.jl)().tag("UnrecognizedCustomFlexPane",6,t.flexPaneProviderID),null)}))(qe),We=n(85266),je=n(78822);function Ge(e){return!!e&&"iconFontName"in e}var Ke="ShellFabricMDL2IconsLite,ShellFabricMDL2Icons",ze=function(e){function t(t){var n=e.call(this,t)||this;return n.setClickableElement=function(e){n.headerButtonElement=e},n.onClick=function(e){n.props.isStateless&&n.props.onShow&&n.props.onShow(e.currentTarget.getBoundingClientRect()),n.props.onClick&&n.props.onClick(e)},n.state={isHovered:!1},n}return(0,p.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.isActive&&!e.isActive&&null!=this.headerButtonElement?this.props.onShow&&this.props.onShow(this.headerButtonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide&&this.props.onHide()},t.prototype.getArialLabel=function(){var e,t="function"==typeof this.props.ariaLabel?this.props.ariaLabel():this.props.ariaLabel;return void 0!==this.props.badgeValue&&0!==this.props.badgeValue?(0,s.Uw)(null!==(e=this.props.badgeLabel)&&void 0!==e?e:S.b.UnreadBadge_Count,"".concat(t),"".concat(this.props.badgeValue)):t},t.prototype.render=function(){var e=this,t={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getArialLabel(),affordanceMenuItemText:"function"==typeof this.props.affordanceMenuItemText?this.props.affordanceMenuItemText():this.props.affordanceMenuItemText,iconData:this.props.iconData?Ge(this.props.iconData)?{iconFontName:this.props.iconData.iconFontName,iconFontFamily:this.props.iconData.iconFontFamily||Ke,iconFontSize:q.GX.toString()}:this.props.iconData:{iconFontName:this.props.iconFontName,iconFontFamily:this.props.iconFontFamily||Ke,iconFontSize:q.GX.toString()},isActive:this.props.isActive,isDarkModeEnabled:!!this.props.isDarkMode,onClick:this.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged,setClickableElement:this.setClickableElement,buttonText:this.props.buttonText,responsiveStep:this.props.responsiveStep,hideButton:this.props.hideButton,isNoninteractive:this.props.isNoninteractive,badgeLabel:this.props.badgeLabel};return 0===this.props.renderContext?a.createElement(H.sO,(0,p.__assign)({},t),a.createElement(s.Eb,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:je.headerButtonBadgePosition,badgeColors:this.props.badgeColors,badgeCharacter:this.props.badgeCharacter,isDarkMode:!!this.props.isDarkMode})):a.createElement(H.b,(0,p.__assign)({},t),a.createElement(s.Eb,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:We.affordanceContextMenuItemBadgePosition,badgeColors:this.props.badgeColors,badgeCharacter:this.props.badgeCharacter,isDarkMode:!!this.props.isDarkMode}))},t}(a.Component),Ve=(0,o.connect)((function(e,t){return(0,p.__assign)((0,p.__assign)({},t),{badgeValue:e.extensibilityState.badgeValues[t.id],badgeColors:e.extensibilityState.badgeColors[t.id],isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId,flexPaneProviderID:e.extensibilityState.customHeaderButtonFlexPaneTriggers[t.id],badgeLabel:e.extensibilityState.badgeLabels[t.id],isDarkMode:e.themeState.IsDarkMode,badgeCharacter:e.extensibilityState.badgeCharacters[t.id]})}),(function(e,t){return{onClickDispatch:function(n,r){r.stopPropagation(),t.onClick&&t.onClick(r),t.isStateless||e((0,s.uS)(r.currentTarget&&r.currentTarget.id)),n&&e((0,N.yG)(n))}}}),(function(e,t){return(0,p.__assign)((0,p.__assign)((0,p.__assign)({},e),t),{onClick:function(n){t.onClickDispatch(e.flexPaneProviderID,n)}})}))(ze),Ze="suiteux-extensibility.SET_BADGE_VALUE",Qe="suiteux-extensibility.SET_BADGE_COLOR",Xe="suiteux-extensibility.SET_BADGE_LABEL",Je="suiteux-extensibility.SET_BADGE_CHARACTER",Ye=n(44066),$e=n(36198);function et(e,t,n,r){var a=(0,p.__assign)({},e);t&&t.flexPaneCollection&&t.flexPaneCollection.forEach((function(e){var t=e;t.render&&(a.customFlexPanes[t.flexPaneID]=t)})),n&&(a.customFlexPanes[n.flexPaneID]=n),r&&(a.customFlexpaneWidth=r);var i=Object.keys(a.customFlexPanes).sort();return a.customFlexPaneHash=(0,s.Wu)(JSON.stringify(i)),a}var tt={extensibilityState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=et(s.M1,n.layout)}switch(t.type){case s.C1:return function(e,t){var n=t.buttonId;e.activeButtonId===n&&(n="");return(0,p.__assign)((0,p.__assign)({},e),{activeButtonId:n})}(e,t);case s.Q:return et(e,t.shellLayout);case"suiteux-extensibility.UPDATE_CUSTOMHEADERBUTTON":return function(e,t){for(var n=(0,p.__assign)({},e),r=function(r){var a=t.buttonData[r],i=(0,s.GS)(e.customHeaderButtons,(function(e){return e.id===a.id}));i>=0?n.customHeaderButtons=(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],e.customHeaderButtons.slice(0,i),!0),[a],!1),e.customHeaderButtons.slice(i+1),!0):(n.customHeaderButtons=(0,p.__spreadArray)([],e.customHeaderButtons,!0),n.customHeaderButtons.unshift(a))},a=0;a<t.buttonData.length;a++)r(a);return n}(e,t);case $e.yk:var r=t;return et(e,null,r.customFlexpane,r.customFlexpaneWidth);case $e.FK:return function(e,t){var n=(0,p.__assign)({},e);delete n.customFlexPanes[t];var r=Object.keys(n.customFlexPanes).sort();return n.customFlexPaneHash=(0,s.Wu)(JSON.stringify(r)),n}(e,t.customFlexpaneID);case Ye.Ve:return function(e,t){var n=e;t.newProvider.shellControlID&&e.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]!==t.newProvider.key&&((n=(0,p.__assign)((0,p.__assign)({},e),{customHeaderButtonFlexPaneTriggers:(0,p.__assign)({},e.customHeaderButtonFlexPaneTriggers)})).customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]=t.newProvider.key);return n}(e,t);case Ze:return function(e,t){var n=e;e.badgeValues[t.buttonID]!==t.badgeValue&&((n=(0,p.__assign)((0,p.__assign)({},e),{badgeValues:(0,p.__assign)({},e.badgeValues)})).badgeValues[t.buttonID]=t.badgeValue);return n}(e,t);case Xe:return function(e,t){var n=(0,p.__assign)({},e);e.badgeLabels[t.buttonID]!==t.badgeLabel&&(n.badgeLabels[t.buttonID]=t.badgeLabel);return n}(e,t);case Qe:return function(e,t){var n=e;e.badgeColors[t.buttonID]!==t.badgeColors&&((n=(0,p.__assign)((0,p.__assign)({},e),{badgeColors:(0,p.__assign)({},e.badgeColors)})).badgeColors[t.buttonID]=t.badgeColors);return n}(e,t);case Je:return function(e,t){var n=e;e.badgeCharacters[t.buttonID]!==t.badgeCharacter&&((n=(0,p.__assign)((0,p.__assign)({},e),{badgeCharacters:(0,p.__assign)({},e.badgeCharacters)})).badgeCharacters[t.buttonID]=t.badgeCharacter);return n}(e,t);default:return e}}},nt=n(31089),rt=n(42573),at=n(58930),it=function(e){function t(t){var n=e.call(this,t)||this;return n.onEntryPointClick=function(){n.props.isStateless?n.props.onShow(n.buttonElement.getBoundingClientRect()):n.props.onToggleButtonState(n.props.id)},n}return(0,p.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.isActive&&!e.isActive&&this.buttonElement?this.props.onShow(this.buttonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide()},t.prototype.render=function(){var e,t=this,n=(0,at.j)(),r=(0,s.iv)(this.props.isNoninteractive?je.nonInteractiveButton:je.button,rt.customHeaderButton,this.props.isNoninteractive?n.nonInteractiveButton:n.headerButton,((e={})[n.activeHeaderButton]=this.props.isActive,e)),i=this.props.iconData;return this.props.isNoninteractive?a.createElement(nt.u,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},a.createElement("div",{className:rt.customHeaderButtonWrapper},a.createElement("span",{className:(0,s.iv)(r),role:"presentation",id:"CustomHeader_".concat(this.props.id),ref:function(e){return t.buttonElement=e},onClick:null,"aria-label":this.props.ariaLabel,style:Ge(i)?{fontFamily:i.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},Ge(i)?a.createElement(s.BH,{fontSize:"16",fontValue:i.iconFontName}):i.element))):a.createElement(nt.u,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},a.createElement("div",{className:rt.customHeaderButtonWrapper},a.createElement("button",{className:(0,s.iv)(r),type:"button",role:"button",id:"CustomHeader_".concat(this.props.id),ref:function(e){return t.buttonElement=e},onClick:this.onEntryPointClick,"aria-label":this.props.ariaLabel,style:Ge(i)?{fontFamily:i.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},Ge(i)?a.createElement(s.BH,{fontSize:"16",fontValue:i.iconFontName}):i.element)))},t}(a.Component),ot=(0,o.connect)((function(e,t){return(0,p.__assign)((0,p.__assign)({},t),{isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId})}),(function(e){return{onToggleButtonState:function(t){e((0,s.uS)(t))}}}))(it),st=[];function ut(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=(0,s.ef)(),u=function(t){var n=e[t];if("object"!=typeof n||Array.isArray(n))return"continue";var r=(0,s.GS)(st,(function(e){return e.id===n.id}));r>=0?st=(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],st.slice(0,r),!0),[n],!1),st.slice(r+1),!0):st.push(n)},l=0;l<e.length;l++)u(l);if(n.getState().shellInitDataState.layout){var c=(0,r.bf)();c.DefaultLayoutState.CustomHeaderButtons=st,(0,r.Lo)().invoke("ShellLayoutUpdated",c.GetDefaultLayout())}else{var d=(0,p.__spreadArray)([],st,!0).reverse().map((function(e){var t;return a.createElement(ot,{key:e.id,id:e.id,iconData:null!==(t=e.iconData)&&void 0!==t?t:{iconFontName:e.iconFontName,iconFontFamily:e.iconFontFamily},onHide:e.onHide,onShow:e.onShow,isStateless:e.isStateless,ariaLabel:"function"==typeof e.ariaLabel?e.ariaLabel():e.ariaLabel})})),f=document.getElementById("O365_CustomHeaderButtonsContainer");f.style.height="48px",i.render(a.createElement(o.Provider,{store:n},a.createElement("div",{className:rt.customHeaderButtonsContainer},d)),f)}}var lt=n(58866),ct=(0,s.ef)(),pt=function(){function e(){}return e.prototype.AddOrUpdateCustomHeaderButton=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;n++){var a=e[n];(0,r.jl)().tag("AddOrUpdateCustomHeaderButton",1,a.id,a.iconData?Ge(a.iconData)?a.iconData.iconFontName:"SVG element":a.iconFontName)}ut.apply(void 0,e)},e.prototype.AddOrUpdateCustomFlexpane=function(e,t){var n=(0,s.ef)();n.dispatch((0,lt.xG)(e.flexPaneID)),null!=n.getState().extensibilityState.customFlexPanes[e.flexPaneID]&&n.dispatch((0,l.sp)(e.flexPaneID)),n.dispatch((0,l.p8)(e,t))},e.prototype.UpdateButtonState=function(e,t){var n=(0,s.ef)(),r=n.getState().extensibilityState;r.activeButtonId!==e||t?r.activeButtonId!==e&&t&&n.dispatch((0,s.uS)(e)):n.dispatch((0,s.uS)(""))},e.prototype.SetCustomHeaderButtonBadgeValue=function(e,t){ct.dispatch(function(e,t){return{type:Ze,buttonID:e,badgeValue:t}}(e,t))},e.prototype.SetCustomHeaderButtonBadgeColor=function(e,t){ct.dispatch(function(e,t){return{type:Qe,buttonID:e,badgeColors:t}}(e,t))},e.prototype.SetCustomHeaderButtonBadgeLabel=function(e,t){ct.dispatch({type:Xe,buttonID:e,badgeLabel:t})},e.prototype.SetCustomHeaderButtonBadgeCharacter=function(e,t){ct.dispatch(function(e,t){return{type:Je,buttonID:e,badgeCharacter:t}}(e,t))},e}();var dt=!1,ft=function(){function e(){}return e.prototype.Init=function(e,t,n,a,i){dt||(dt=!0,this.Timeout=e,this.SigninState=t,this.Controls=n,this.SessionId=a,this.DisableTrackEvents=i,(0,r.Lo)().subscribe("ShellDataUpdated",ht,!0))},e}();function ht(e,t){t.PUID?(t.AuthAbtEnabled&&(dt=!0,window.LoadAbtPromptJs={Download:gt},n.e("abt").then(n.bind(n,75030)).then((function(n){var r=null==n?void 0:n.Environment.WorldWide;(0,g.pn)(t.Environment.toLowerCase(),"tbprod")?r=null==n?void 0:n.Environment.Trailblazer:(0,g.pn)(t.Environment.toLowerCase(),"pfprod")&&(r=null==n?void 0:n.Environment.Pathfinder),null==n||n.AbtMainOperations.initializeAbt({market:e.CultureName||"en-US",workloadName:(0,c.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),environment:r,userId:t.PUID,authType:t.IsConsumerShell?null==n?void 0:n.AuthType.Msa:null==n?void 0:n.AuthType.Aad,timeout:window.O365Shell.Abt.Timeout,trackEvents:!window.O365Shell.Abt.DisableTrackEvents,enableLogging:!0,sessionId:window.O365Shell.Abt.SessionId,tenantId:t.TID,signInState:window.O365Shell.Abt.SigninState,controls:window.O365Shell.Abt.Controls,allowedCookieFailureTimes:2})}))),(0,r.Lo)().unsubscribe("ShellDataUpdated",ht)):(0,r.jl)().tag("ABT_NoPUIDFound",4,null,null)}function gt(e){n.e("abtprompt").then(n.t.bind(n,1561,23)).then((function(t){e&&e()}))}var mt=n(16358),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,p.__extends)(t,e),t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:S.b.FeatureFlags_Title,affordanceMenuItemText:S.b.FeatureFlags_Title,iconID:"FeatureFlagsLogo",iconFontSize:q.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?a.createElement(H.sO,(0,p.__assign)({},e)):a.createElement(H.b,(0,p.__assign)({},e))},t}(a.Component),yt=(0,o.connect)((function(e,t){return{id:t&&t.id,isAvailable:!0,isActive:e.flexPaneState&&"FeatureFlags"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),n.onClick&&n.onClick(t),e((0,s.uS)(t.currentTarget&&t.currentTarget.id)),e((0,N.yG)("FeatureFlags"))}}}),(function(e,t,n){var r=(0,p.__assign)((0,p.__assign)({},n),e);return(0,p.__assign)((0,p.__assign)((0,p.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(St),vt="suiteux-mecontrol.UPDATE_WORKLOAD_FEATURE_FLAG_LIST";var Ct=function(){function e(){}return e.prototype.AddFeatureFlags=function(e){e?(0,s.ef)().dispatch(function(e){return{type:vt,workloadFeatureFlagList:e}}(e)):(0,r.jl)().tag("FeatureFlags_Shim_FeatureFlags_Param_Invalid",6)},e.prototype.SubscribeToFeatureFlagStatusChange=function(e){return(0,r.Lo)().subscribe("FeatureFlagChanged",e,!1)},e}();var bt={featureFlagsState:function(e,t){return e||(e={enabled:!1,workloadFeatureFlagList:{}}),t.type===vt?function(e,t){var n=t;return(0,p.__assign)((0,p.__assign)({},e),{workloadFeatureFlagList:n.workloadFeatureFlagList})}(e,t):e}};function It(e,t){if(t.FeatureFlagsEnabled){var a=(0,F.k)((function(){return n.e("featureflags").then(n.bind(n,4318)).then((function(e){return e.FeatureFlagsFlexPanePanelConnector}))})),i=(0,r.aH)().layout,o={component:a,key:"FeatureFlags",width:N.yh};if(i)(0,r.Lo)().invoke("LazyComponentLoaded",mt.$,yt),o.nativeControlID="FeatureFlags";else o.btnId=_.F_;(0,s.ef)().dispatch((0,N.wd)(o))}}var Tt,Dt,wt,At,Ot,xt,Lt,kt,Rt,Pt,Et,Ut,Ft,Nt,_t=n(33836),Mt=n(90932),Ht=n(44482),qt="O365_ShyHeader",Bt=2e3;function Wt(e,t,n){Tt=(0,r.Lo)(),Dt=window.matchMedia("(max-height: ".concat(t,"px)")),kt=0,Rt=0,Ft=n,Pt=e,window.addEventListener(_t.t.RESIZE,jt),Pt.addEventListener(_t.t.MOUSEENTER,Vt),Pt.addEventListener(_t.t.MOUSELEAVE,Zt),Pt.addEventListener(_t.t.FOCUS,Qt,!0),Pt.addEventListener(_t.t.BLUR,Xt,!0),Tt.subscribe("ContextMenuPopup",Jt),Tt.subscribe("ShyHeaderActivated",Yt,!0),jt()}function jt(){$t()?(0!==kt&&window.clearTimeout(kt),kt=window.setTimeout((function(){$t()&&null!=Pt&&null!=Ft&&(Nt||function(){if(null!=Ft&&null!=Pt){var e=(0,at.j)();(Et=(0,q.nV)("".concat(Mt.shyHeader," o365cs-base ").concat(e.navbar),qt)).setAttribute("tabindex","0"),Ut=(0,q.nV)(Mt.shyHeaderOverlay);var t=(0,q.nV)("".concat(Mt.shyHeaderGripper," ").concat(e.shyHeader));Et.appendChild(Ut),Et.appendChild(t),Ft.appendChild(Et),Et.addEventListener(_t.t.MOUSEDOWN,Kt),Et.addEventListener(_t.t.FOCUS,zt),(0,q.nj)(Pt,Mt.headerAnimations),(0,q.nj)(Ft,Mt.workloadDivAnimations),Nt=!0}}(),(0,q.bO)(Pt,Mt.headerSlideIn),(0,q.bO)(Ft,Mt.workloadDivSlideIn),(0,q.nj)(Pt,Mt.headerSlideOut),(0,q.nj)(Ft,Mt.workloadDivSlideOut),Pt.onanimationend=function(e){"headerSlideOutFrames"===e.animationName&&(Tt.invoke("ShyHeaderActivated",!0),wt=!0)})}),Bt)):Dt.matches&&!Lt||Gt()}function Gt(e){wt&&null!=Et&&null!=Pt&&null!=Ft&&(Et.style.visibility="hidden",Et.style.display="none",Ut.style.visibility="hidden",Ut.style.display="none",Pt.style.display="flex",(0,q.bO)(Pt,Mt.headerSlideOut),(0,q.bO)(Ft,Mt.workloadDivSlideOut),(0,q.nj)(Pt,Mt.headerSlideIn),(0,q.nj)(Ft,Mt.workloadDivSlideIn),Pt.onanimationend=function(t){"headerSlideInFrames"===t.animationName&&(Tt.invoke("ShyHeaderActivated",!1),wt=!1,e&&document.getElementById(Ht.pG).focus())})}function Kt(e){Ot=!0}function zt(e){Gt(!Ot),Ot=!1}function Vt(e){At=!0}function Zt(e){At=!1,jt()}function Qt(e){xt=!0}function Xt(e){xt=!1,0!==Rt&&window.clearTimeout(Rt),Rt=window.setTimeout((function(){xt||jt()}),50)}function Jt(e){Lt=e,e||jt()}function Yt(e){e&&null!=Et&&null!=Pt&&(Et.style.visibility="visible",Et.style.display="flex",Ut.style.visibility="visible",Ut.style.display="flex",Pt.style.display="none")}function $t(){return Dt.matches&&!wt&&!At&&!xt&&!Lt}var en=n(35439);function tn(){(0,r.Lo)().invoke("FlexPane400ZoomActivated",(0,en.E)())}var nn=!1,rn=!1;function an(e,t){if(!nn){var n=(0,r.aH)();if(n&&n.supportShyHeaderMode){var a=document.getElementById(n.top);Wt(document.getElementById(_.WZ),n.shyHeaderActivationHeight?n.shyHeaderActivationHeight:en.J,a),nn=!0}}rn||(window.addEventListener(_t.t.RESIZE,tn),rn=!0)}var on=n(53090),sn=n(62293),un=n(94425),ln=n(40607),cn=n(40255),pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,p.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&(0,r.jl)().perfMarker("MyDayTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:S.b.MyDay,affordanceMenuItemText:S.b.MyDay,iconID:"EventToDoLogo",iconFontSize:q.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?a.createElement(ln.s,(0,p.__assign)({},e)):a.createElement(cn.b,(0,p.__assign)({},e))},t}(a.Component),dn=(0,o.connect)((function(e,t){var n;return{isAvailable:e.shellInitDataState.clientData.OpxEnabled&&e.shellInitDataState.clientData.MyDayOpxEnabled,id:null==t?void 0:t.id,isActive:"MyDay"===(null===(n=e.flexPaneState)||void 0===n?void 0:n.activeProviderKey),controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){var a;t.stopPropagation(),(0,r.jl)().click("MyDay","NavBar",null,null,"Active state: ".concat(n.isActive,", Render context: ").concat(n.renderContext)),e((0,s.uS)(null===(a=t.currentTarget)||void 0===a?void 0:a.id)),e((0,lt.yG)("MyDay")),n.onClick&&n.onClick(t)}}}),(function(e,t,n){var r=(0,p.__assign)((0,p.__assign)({},n),e);return(0,p.__assign)((0,p.__assign)((0,p.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(pn);function fn(e,t){if(t.OpxEnabled&&t.MyDayOpxEnabled&&!(0,c.So)(t.WorkloadId,e.CurrentMainLinkElementID)){(0,r.Lo)().unsubscribe("ShellDataUpdated",fn);var a={component:(0,F.k)((function(){return n.e("myday").then(n.bind(n,14075)).then((function(e){return e.MyDayFlexPaneConnector}))})),key:"MyDay",width:on.y};(0,r.Lo)().invoke("LazyComponentLoaded",un.q,dn),a.nativeControlID="MyDay",(0,sn.e)().dispatch((0,lt.wd)(a))}}var hn=n(97260),gn=n(96917),mn="LazyDocumentTitleComponentName",Sn=((0,gn.Q)(mn),!1),yn=function(){function e(){}return e.prototype.SetProps=function(e){(Sn?Promise.resolve():n.e("dtt").then(n.bind(n,56082)).then((function(e){Sn=!0,(0,r.Lo)().invoke("LazyComponentLoaded",mn,e.DocumentTitleConnector)}))).then((function(){return(0,s.ef)().dispatch((0,hn.L)(e))}))},e}();var vn,Cn,bn,In,Tn,Dn,wn,An,On,xn,Ln=n(31833),kn=function(){function e(){}return e.prototype.UpdateAccount=function(e,t,n){if(window.MastInteraction)try{window.MastInteraction.UpdateAccount(e,t,n)}catch(e){(0,r.jl)().exception("MAST_UpdateAccount_Failed",6,e)}},e.prototype.SetActiveAccount=function(e){if(window.MastInteraction)try{window.MastInteraction.SetActiveAccount(e)}catch(e){(0,r.jl)().exception("MAST_SetActiveAccount_Failed",6,e)}},e.prototype.UpdateMastConfiguration=function(e){if(window.MastInteraction)try{window.MastInteraction.UpdateConfiguration(e)}catch(e){(0,r.jl)().exception("MAST_UpdateConfiguration_Failed",6,e)}},e.prototype.Init=function(){(0,r.Lo)().subscribe("ShellDataUpdated",Rn,!0)},e}();function Rn(e,t){var a,i=(0,r.aH)();if(!t.DisableAccountSwitchingGlobally&&t.AccountSwitchingEnabled&&i.shellAuthProviderConfig){vn=null===(a=null==e?void 0:e.SignOutLink)||void 0===a?void 0:a.Url;var o,s=i.shellAuthProviderConfig.login_Hint,u={authenticatedState:1,upn:s||t.UPN,idp:t.IsConsumerShell?"msa":"aad"},l={isMSAAccount:t.IsConsumerShell,puid:t.PUID,upn:t.UPN},c=_n(t.AppHeaderLinkText);void 0===c.postAccountSwitchRedirectUri&&(o={modifySwitchAccountRedirectUriFunction:Un}),void 0===c.postLogoutRedirectUri&&(o=(0,p.__assign)((0,p.__assign)({},o),{modifySignoutRedirectUriFunction:Fn})),o=(0,p.__assign)((0,p.__assign)({},o),{afterSwitchAccountPromptCallbackFunction:Pn,afterSignOutPromptCallbackFunction:En}),window.LoadMastPromptJs={Download:Nn},n.e("mast").then(n.bind(n,95020)).then((function(n){new n.MultiAccountSessionTracker(c,o),Cn.UpdateAccount(t.PUID,u,!0),window.addEventListener("message",Mn.bind(self,l,e.SignOutLink),!1),(0,r.Lo)().subscribe("AppNameChanged",Hn,!0)})).catch((function(e){return(0,r.jl)().exception("MASTPackage_DownLoad_Failed",6,e)})),(0,r.Lo)().unsubscribe("ShellDataUpdated",Rn)}}function Pn(){(0,r.jl)().click("SwitchPopup","Mast"),(0,Ln.x)().catch((function(e){(0,r.jl)().exception("MAST_Switch_ClearSessionStorage_Failed",6,e)}))}function En(){(0,r.jl)().click("SignOutPopup","Mast"),(0,Ln.x)().catch((function(e){(0,r.jl)().exception("MAST_Signout_ClearSessionStorage_Failed",6,e)}))}function Un(e,t,n){var a=(0,r.aH)().shellAuthProviderConfig;if(a&&a.appSwitchToUrl&&"function"==typeof a.appSwitchToUrl){var i={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0},nextAccount:{type:"msa"===t.idp?"msa":"aad",login_hint:t.upn,memberName:t.upn,authenticatedState:"signedIn",cid:void 0}};return a.appSwitchToUrl(i)}return n||void 0}function Fn(e,t){var n=(0,r.aH)().shellAuthProviderConfig;if(n&&"function"==typeof n.appSignOutUrl){var a={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0}};return n.appSignOutUrl(a)}}function Nn(e){n.e("mastprompt").then(n.t.bind(n,23009,23)).then((function(){e&&e()})).catch((function(e){return(0,r.jl)().exception("MASTPromptPackage_DownLoad_Failed",6,e)}))}function _n(e){var t=(0,r.aH)(),n=void 0,a=!0,i=t.shellAuthProviderConfig,o=i.appSwitchToUrl||i.appSignInUrl;o&&"string"==typeof o?n=o:a=!1;var s=i.appSignOutUrl;return{appFriendlyName:e,enablePageRedirect:!0,postLogoutRedirectUri:s&&"string"==typeof s?s:vn,postAccountSwitchRedirectUri:n,mastPromptLocalizedStrings:{appFriendlyName:e,switchAccountTitle:S.b.SwitchAccountTitle,switchAccountDescriptionWithUpn:S.b.SwitchAccountDescriptionWithUpn,switchAccountDescriptionWithoutUpn:S.b.SwitchAccountDescriptionWithoutUpn,switchAccountSubDescription:"",switchAccountButtonText:S.b.SwitchAccountButtonText,signOutTitle:S.b.SignOutTitle,signOutDescriptionWithUpn:S.b.SignOutDescriptionWithUpn,signOutDescriptionWithoutUpn:S.b.SignOutDescriptionWithoutUpn,signOutSubDescription:"",signOutButtonText:S.b.SignOutButtonText},appendLoginHint:a,enableConsoleLogging:!1,enableAutomaticPopup:!t.shellDataOverrides.DisableMASTPopup}}function Mn(e,t,n){var a,i,o,s;if("SwitchAccountRedirect"===(null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.request))(null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.url)?((0,r.jl)().click("Switch","Mast"),window.removeEventListener("message",Mn.bind(n,e,t),!1),(0,r.Lo)().invoke("AccountSwitchInitiated",e)):(0,r.jl)().tag("MAST_MissingSwitchUrl",4);else if("SignOutBackToLanding"===(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.request))if(null===(s=null==n?void 0:n.data)||void 0===s?void 0:s.url){(0,r.jl)().click("SignOut","Mast"),window.removeEventListener("message",Mn.bind(n,e,t),!1),null!=t.Action&&t.Action();var u={triggerEvent:n};(0,r.Lo)().invoke("SignOut",u)}else(0,r.jl)().tag("MAST_MissingSignOutUrl",4)}function Hn(e){var t=_n(e);Cn.UpdateMastConfiguration(t)}(Tn=(0,s.ef)().getState()).userState.isConsumer||s.YA.register(O),bn=new R,In=window.O365Shell.Apps,window.O365Shell.Apps=bn,In.applyCalls(bn),Tn.userState.isConsumer||(0,r.Lo)().subscribe("ShellDataUpdated",P,!0),E=(0,r.Lo)().subscribe("ShellDataUpdated",(function(e,t){if(t.NotificationsEnabled){(0,r.Lo)().unsubscribe("ShellDataUpdated",E);var a=function(){return n.e("notifications").then(n.bind(n,55168)).catch((function(e){return(0,r.jl)().exception("NotificationsPackage_LoadFail",6,e)}))},i=(0,r.aH)();i&&i.layout?i.layout.centerCustomizationRegion&&(0,U.Y5)("NotificationBellIcon",i.layout.centerCustomizationRegion.children)&&a():a()}}),!0),function(){j=function(){return n.e("extraflexpane").then(n.bind(n,39075))};var e=window.O365Shell.NFD;e.registerShimCallback&&e.registerShimCallback((function(){j()}),["OpenHelp","OpenFeedback"]);var t=(0,F.k)((function(){return j().then((function(e){return e.HelpFlexPanePanelConnector}))})),a=(0,r.aH)(),i={component:t,key:"Help",width:N.yh,overrideOnClick:a.OnHelpButtonClick};a.layout?((0,r.Lo)().invoke("LazyComponentLoaded",M.d,W),i.nativeControlID="HelpIcon"):i.btnId=_.rm,(0,s.ef)().dispatch((0,N.wd)(i)),(0,r.Lo)().subscribe("ShellDataUpdated",G,!0)}(),(0,r.Lo)().subscribe("ShellDataUpdated",z,!0),(0,r.Lo)().subscribe("ShellDataUpdated",Q,!0),function(){var e,t;s.YA.register(Oe),e=new Le,t=window.O365Shell.Settings,window.O365Shell.Settings=e,t.applyCalls(e);var a=(0,F.k)((function(){return n.e("extraflexpane").then(n.bind(n,80424)).then((function(e){return e.SettingsFlexPanePanelConnector}))}));(0,r.Lo)().subscribe("ShellDataUpdated",ke,!0);var i=(0,r.aH)().layout,o={component:a,key:"Settings",width:N.yh};i?((0,r.Lo)().invoke("LazyComponentLoaded",X.F,$),o.nativeControlID="SettingsIcon"):o.btnId=_.JT,(0,s.ef)().dispatch((0,N.wd)(o))}(),s.YA.register(Fe),(0,r.Lo)().subscribe("ShellDataUpdated",_e,!0),function(){var e,t;s.YA.register(tt),e=new pt,t=window.O365Shell.Extensibility,window.O365Shell.Extensibility=e,t.applyCalls(e);var n,a=(0,s.ef)();function i(){var e=a.getState();n!==e.extensibilityState.customFlexPaneHash&&Object.keys(e.extensibilityState.customFlexPanes).forEach((function(t){if(!e.flexPaneState.registeredProviders.some((function(e){return e.key===t}))){var n=e.extensibilityState.customFlexPanes[t],r=e.extensibilityState.customFlexpaneWidth?e.extensibilityState.customFlexpaneWidth:N.yh;a.dispatch((0,N.wd)({component:Be,btnId:n.triggerControlID,shellControlID:n.triggerControlID,key:t,width:r}))}}));n=e.extensibilityState.customFlexPaneHash}i(),(0,r.Lo)().invoke("LazyComponentLoaded",Me.B,Ve),a.subscribe(i)}(),(0,C.$_)(),function(){var e=function(){return n.e("diagnostics").then(n.bind(n,44721))},t=window.O365Shell.Diagnostics;t.registerShimCallback&&t.registerShimCallback((function(){e()}),["GetServiceDiagnostics","GetClientDiagnostics"]),window.O365ShellContext.DiagnosticsEnabled&&e()}(),function(){var e=new ft,t=window.O365Shell.Abt;window.O365Shell.Abt=e,t.applyCalls(e);var n=(0,r.aH)();n.abtTimeout&&window.O365Shell.Abt.Init(n.abtTimeout,n.abtSigninState,n.abtControls,n.abtSessionId,n.abtDisableTrackEvents)}(),s.YA.register(bt),Dn=new Ct,wn=window.O365Shell.FeatureFlags,window.O365Shell.FeatureFlags=Dn,wn.applyCalls(Dn),(0,r.Lo)().subscribe("ShellDataUpdated",It,!0),(0,r.Lo)().subscribe("ShellDataUpdated",an,!0),(An=(0,r.aH)())&&An.layout&&An.layout.centerCustomizationRegion&&(0,U.Y5)("MyDay",An.layout.centerCustomizationRegion.children)&&(0,r.Lo)().subscribe("ShellDataUpdated",fn,!0),On=new yn,xn=window.O365Shell.DTT,window.O365Shell.DTT=On,xn&&xn.applyCalls(On),(0,r.aH)().shellAuthProviderConfig&&(Cn=new kn).Init(),(0,r.Lo)().invoke("PlusLoaded"),(0,r.jl)().perfMarker("shell_plus_executioncomplete")},40647:function(e,t,n){"use strict";var r;n.d(t,{K:function(){return r}}),function(e){e.Theme="theme",e.LanguageAndRegion="languageandregion",e.NavBarDataLinks="navbardatalinks",e.ChangePassword="changepassword",e.ContactPreferences="contactpreferences",e.AboutBase="aboutbase",e.About="about",e.DarkMode="darkmode",e.CPNIPin="cpnipin"}(r||(r={}))},55309:function(e,t,n){"use strict";n.d(t,{$y:function(){return S},AF:function(){return u},CR:function(){return c},FF:function(){return g},Jf:function(){return h},N0:function(){return i},Q5:function(){return s},R6:function(){return d},eV:function(){return o},gR:function(){return f},i7:function(){return y},iM:function(){return m},jG:function(){return a},nf:function(){return p},qe:function(){return v},rw:function(){return l},zS:function(){return C},zt:function(){return b}});var r=n(30534);function a(e){return{type:r.do,newWorkloadSettingLink:e}}function i(e){return{type:r.w0,settingLinkID:e}}function o(e){return{type:r.K4,newWorkloadSettingsLinks:e}}function s(e){return{type:r.SL,cardData:e}}function u(e){return{type:r.Cr,selectedLanguage:e}}function l(e){return{type:r.EF,languageChoices:e}}function c(e){return{type:r.$w,selectedTimeZone:e}}function p(e,t,n){return{type:r.lj,timeZoneChoice:e,dateFormatChoice:t,timeFormatChoice:n}}function d(e){return{type:r.rg,timeZoneChoices:e}}function f(e){return{type:r.J5,selectedLanguage:e}}function h(e){return{type:r.Oy,selectedDateFormat:e}}function g(e){return{type:r.$I,dateFormatChoices:e}}function m(e){return{type:r.sI,selectedTimeFormat:e}}function S(e){return{type:r.i1,timeFormatChoices:e}}function y(){return{type:r.NS}}function v(){return{type:r.M9}}function C(e){return{type:r.Vx,cardId:e}}function b(e){return{type:r.nl,isExpanded:e}}},30534:function(e,t,n){"use strict";n.d(t,{$I:function(){return m},$w:function(){return p},Cr:function(){return l},EF:function(){return c},J5:function(){return h},K4:function(){return s},M9:function(){return a},NS:function(){return r},Oy:function(){return g},SL:function(){return u},Vx:function(){return v},do:function(){return i},i1:function(){return y},lj:function(){return d},nl:function(){return C},rg:function(){return f},sI:function(){return S},w0:function(){return o}});var r="suiteux-settings.SAVE_SELECTIONS",a="suiteux-settings.CANCEL_SELECTIONS",i="suiteux-settings.ADDORUPDATE_WORKLOADSETTINGLINK",o="suiteux-settings.REMOVE_WORKLOADSETTINGLINK",s="suiteux-settings.SET_WORKLOADSETTINGSLINKS",u="suiteux-settings.INITIALCARDS_AVAILABLE",l="suiteux-settings.LANGUAGECHOICE_AVAILABLE",c="suiteux-settings.LANGUAGECHOICES_AVAILABLE",p="suiteux-settings.SELECTEDTIMEZONE_CHANGED",d="suiteux-settings.TIMEZONEANDFORMATSCHOICE_AVAILABLE",f="suiteux-settings.TIMEZONECHOICES_AVAILABLE",h="suiteux-settings.SELECTEDLANGUAGE_CHANGED",g="suiteux-settings.SELECTEDDATEFORMAT_CHANGED",m="suiteux-settings.DATEFORMATCHOICES_AVAILABLE",S="suiteux-settings.SELECTEDTIMEFORMAT_CHANGED",y="suiteux-settings.TIMEFORMATCHOICES_AVAILABLE",v="suiteux-settings.NAVIGATE_TO_CARD",C="suiteux-settings.O365_SETTINGS_EXPANDED"},14643:function(e,t,n){"use strict";n.d(t,{F:function(){return g}});var r=n(77224),a=n(59633),i=n(84735),o=n(91011);var s,u=n(40647),l=[u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences,u.K.NavBarDataLinks],c=[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences],p={default:[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],iwapp:[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],exchange:[],exchangeadmin:c,officepwa:[u.K.Theme,u.K.DarkMode,u.K.AboutBase,u.K.NavBarDataLinks],botdesigner:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365:c,dynamics365ci:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365fraudprotection:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365powerplatform:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365productinsights:[u.K.NavBarDataLinks,u.K.ChangePassword,u.K.ContactPreferences],adminportal:[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences,u.K.CPNIPin],flow:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],teamsappstudio:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences],microsoftstream:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],todo:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],microsoftclipchamp:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences],powerappsportal:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],vivagoals:[],promptlibbie:[],vivalearning:[u.K.NavBarDataLinks,u.K.Theme,u.K.DarkMode],protectioncenter:c,wordonline:l,powerpointonline:l,excelonline:l,visioonline:l,onenoteonline:l,wac:l},d=n(27676),f=((s={})[u.K.NavBarDataLinks]={EnableConsumer:!0},s[u.K.Theme]={Title:d.b.Themes,EnableConsumer:!0},s[u.K.ChangePassword]={Title:d.b.Password,Description:d.b.PasswordDescription,EnableConsumer:!1,ChangePasswordCardData:[{WorkloadId:"dynamics365businesscentral",QueryStringData:[{Key:"ru",Value:"https://businesscentral.dynamics.com?redirectedfromsignup=1"}]}]},s[u.K.ContactPreferences]={Title:d.b.ContactPreferences,Description:d.b.ContactPreferencesDescription,EnableConsumer:!1},s[u.K.LanguageAndRegion]={Title:d.b.LanguageAndTimeZone,Description:d.b.LanguageAndTimeZoneDescription,EnableConsumer:!1},s[u.K.AboutBase]={Title:d.b.About,EnableConsumer:!0,ChildCardIds:[u.K.About]},s[u.K.About]={Title:d.b.About,EnableConsumer:!0},s[u.K.DarkMode]={Title:d.b.DarkThemeTitle,EnableConsumer:!1},s[u.K.CPNIPin]={Title:d.b.CPNIPinCardTitle,EnableConsumer:!1},s),h="default";function g(e,t,n){var s,l,c=((s={})[u.K.LanguageAndRegion]=function(e){return!e.UseSimplifiedLanguageCard&&1==(1&e.UserType)&&!(0,a.o5)(e.WorkloadId)}(e),s[u.K.NavBarDataLinks]=function(e){return!(0,i.q)(e)}(n),s[u.K.Theme]=function(e){var t=(0,o.q4)().getThemeState().disableTheming;return e.IsConsumerShell?!(e.CSSExperiencesEnabled&&e.ConsumerThemingEnabled):!!t}(e),s[u.K.ContactPreferences]=function(e){return!e.ShowContactPreferencesCard}(e),s);l=e.CurrentMainLinkElementID&&"shellofficedotcom"===e.CurrentMainLinkElementID.toLowerCase()?"iwapp":e.CurrentMainLinkElementID&&"shellofficepwa"===e.CurrentMainLinkElementID.toLowerCase()?"officepwa":e.CurrentMainLinkElementID&&"shellstream"===e.CurrentMainLinkElementID.toLowerCase()?"microsoftstream":e.CurrentMainLinkElementID&&"clipchamp"===e.CurrentMainLinkElementID.toLowerCase()?"microsoftclipchamp":e.WorkloadId.toLowerCase();var d=null!=t?f[t].ChildCardIds:p[l]?p[l]:p[h],g=e.IsConsumerShell;return d?d.filter((function(t){return!e.IsGuestMode||t===u.K.NavBarDataLinks})).filter((function(e){return!g||f[e].EnableConsumer})).filter((function(e){return!c[e]})).map((function(e){return(0,r.__assign)({Id:e},f[e])})):[]}},13663:function(e,t,n){"use strict";n.d(t,{n:function(){return _}});var r,a=n(77224),i=n(20851),o=n(91011),s=n(9028),u=n(6037),l=n(28949),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.initializeComponent=function(){},t.prototype.getMruDocuments=function(e,t){var n=this;return new Promise((function(r,a){var s=(0,u.Uw)("{0}?rs={1}&show={2}&sort=date",n.SuiteApi.Configuration.MruOauthEndpointUrl,n.SuiteApi.Configuration.CultureName,e.toString());null!=t&&(s+="&apps="+t);var l={method:i.FH.GET,resource:n.SuiteApi.Configuration.MruOauthResourceUrl,url:s};n.SuiteApi.Service.callEndpointWithOauthToken(l).then((function(e){(0,o.jl)().perfMarker("shell_mru_fetch_complete"),r(e)})).catch((function(e){i.LU.genericServiceRejection("Documents_GetMRUDocuments_Failed",6,e,a)}))}))},t.prototype.prefetchMruAccessToken=function(){null!=this.SuiteApi.Configuration.MruOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.MruOauthResourceUrl)},t.prototype.initializeGraphApi=function(){null!=this.SuiteApi.Configuration.GraphOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthEndpointUrl,this.SuiteApi.Configuration.GraphOauthResourceUrl)},t.prototype.createNewDocument=function(e){var t=this,n={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},r={method:i.FH.POST,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthEndpointUrl,headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(n)};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(r).then(e).catch((function(e){i.LU.genericServiceRejection("Documents_CreateNewDocument_Failed",4,e,n)}))}))},t.prototype.getDocumentUrl=function(e,t){var n,r=this;return new Promise((function(a,i){null!=e?r.createNewDocument(e).then((function(e){null!=e&&null!=e.webUrl?-1===(n=e.webUrl.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf("action=editnew")&&(n=(0,u.aM)(n,"action","editnew")):n=t,a(n)})).catch((function(e){return i(e)})):a(n=t)}))},t}(l.V),p=n(81235),d=n(62452),f=n(9264);!function(e){e.UpdateConfig="UpdateConfig",e.UpdateToken="UpdateToken",e.ChangeTheme="ChangeTheme",e.UpdateData="UpdateData"}(r||(r={}));var h=n(56003),g=function(e){function t(){var t=e.call(this)||this;return t.opxFrameToComponentMap={},t.opxComponentData={},t.opxTimers={},t.opxOutstandingOpxQueries={},t.currentOpxQueryID=0,t.OpxInitializationTimeout=15e3,t.handleIncomingOpxMessage=function(e){var n,r=!1,a=t.opxFrameToComponentMap[e.instanceId];if(null!=a)switch(e.notificationType){case d.C.LifeCycle:switch(e.asyncContext){case d.A.GetConfig:var i=null===(n=t.opxComponentData[a])||void 0===n?void 0:n.opxComponentConfiguration;null!=i&&(r=t.onGetConfigRequest(e.instanceId,i));break;case d.A.RefreshToken:r=t.onRefreshTokenRequest(e.instanceId);break;case d.A.Closed:r=t.onOpxClosedRequest(a);break;case d.A.PageReady:case d.A.FatalError:r=t.onReadyOrError(a,e)}break;case d.C.ChallengeToken:r=t.onRefreshTokenRequest(e.instanceId);break;case d.C.DataProviderResponseNotification:var o=e.asyncContext;if(o.success){var s=t.opxOutstandingOpxQueries[e.instanceId];if(s)Object.keys(s).filter((function(e){return s[e].queryType===o.type})).forEach((function(e){s[e].onQueryComplete(o.response)}))}}return r},t.validateIncomingOpxMessage=function(e){return e.apiName===h.r2},t.validateIncomingOpxMessageOrigin=function(e){return e.toLowerCase()===t.SuiteApi.Configuration.TokenFactoryIframeOrigin},t.onGetConfigRequest=function(e,n){return t.SuiteApi.Service.callOpxIframe({opxHostUrl:t.opxHostUrl,targetOpxInstance:e,message:{eventType:r.UpdateConfig,asyncResult:n}}),!0},t.onRefreshTokenRequest=function(e){return t.SuiteApi.Service.callOpxIframe({opxHostUrl:t.opxHostUrl,targetOpxInstance:e,message:{eventType:r.UpdateToken,asyncResult:null}}),!0},t.onOpxClosedRequest=function(e){var t=null;if(e===p.x.MyDay)t="MyDay";return null!=t&&window.O365Shell.FlexPane.CloseFlexPaneForProvider(t),!0},t.onReadyOrError=function(e,n){var r=t.opxComponentData[e];if(!r)throw new Error("Message received for an OPX component that no longer exists.");if(r.initCompleteCallback&&!r.initializationResult){var a=n.asyncContext===d.A.PageReady?0:5;r.initCompleteCallback(a)}else r.messageListener&&r.messageListener(n);return!0},t}return(0,a.__extends)(t,e),t.prototype.initializeComponent=function(){this.opxHostUrl=this.SuiteApi.Configuration.OpxHostUrl,this.opxResourceUrl=this.SuiteApi.Configuration.OpxResourceUrl,this.upn=this.SuiteApi.Configuration.CurrentUserUpn,this.opxSystemConfigurationPromise=this.initializeOpxOrchestrator()},t.prototype.prefetchOpxAccessToken=function(e){var t=this;this.opxSystemConfigurationPromise.then((function(n){null==t.opxSystemConfiguration&&(t.opxSystemConfiguration=n);var r=t.opxSystemConfiguration.OpxEndpoints[e];void 0!==r&&t.SuiteApi.Service.prefetchAccessToken(r.OpxOAuthResourceUrl,r.OpxOAuthResourceUrl)})).catch((function(e){(0,o.jl)().tag("OwaPoweredExperiences_PrefetchAccessTokenFailed",1,e)}))},t.prototype.initializeOpx=function(e,t,n,r){var a=this,i=document.getElementById(t);if(!i)return Promise.resolve(2);this.prefetchOpxAccessToken(p.x.MyDay);var s=new Promise((function(s){a.opxSystemConfigurationPromise.then((function(u){null==a.opxSystemConfiguration&&(a.opxSystemConfiguration=u),a.opxFrameToComponentMap[t]=e,a.opxComponentData[e]={frameID:t,opxComponentConfiguration:n,initCompleteCallback:function(t){switch(t){case 0:case 5:a.opxComponentData[e].initializationResult=t}s(t)},messageListener:r},i.onerror=function(e,t,n,r,a){var i=JSON.stringify(null!=e?e:"Script error");(0,o.jl)().exception(i,6,a,t,n,r),s(3)},i.src=a.createOpxFrameUrl(e,t)})).catch((function(){s(1)}))}));return Promise.race([new Promise((function(t){s.then((function(n){clearTimeout(a.opxTimers[e]),t(n)}))})),new Promise((function(t){clearTimeout(a.opxTimers[e]),a.opxTimers[e]=window.setTimeout((function(){clearTimeout(a.opxTimers[e]),t(4)}),a.OpxInitializationTimeout)}))])},t.prototype.changeTheme=function(e,t,n){var a=this.opxComponentData[e];if(0!==a.initializationResult)throw new Error("Theme cannot be changed before OPX is in the operational state.");var i=a.frameID,o={UseDarkMode:n};n?o.DarkPalette=t:o.LightPalette=t,this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:i,message:{eventType:r.ChangeTheme,asyncResult:o}})},t.prototype.updateData=function(e,t,n){var a=this.opxComponentData[e];if(!a||0!==a.initializationResult)return Promise.reject(new Error("UpdateData cannot be called before OPX is in the operational state."));var i={type:t,request:n};return this.queryOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:a.frameID,message:{eventType:r.UpdateData,asyncResult:i}})},t.prototype.createOpxFrameUrl=function(e,t){if(null==this.opxSystemConfiguration||null==this.opxSystemConfiguration.OpxRootUrlLowerCase||null==this.opxSystemConfiguration.OpxEndpoints[e]||null==this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)throw new Error("OPX system configuration incomplete.");return"".concat(this.opxSystemConfiguration.OpxRootUrlLowerCase).concat(this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)+"?hostApp=o365shell&frameName=".concat(f.TokenFactoryIFrameID,"&opxInstanceId=").concat(t,"&OpxHostOrigin=").concat(this.SuiteApi.Configuration.TokenFactoryIframeOrigin)},t.prototype.initializeOpxOrchestrator=function(){var e=this;return new Promise((function(t,n){e.fetchSystemConfiguration().then((function(r){e.SuiteApi.Service.registerOpxHost(e.opxResourceUrl,e.opxHostUrl,e.OpxInitializationTimeout).then((function(){e.registerOpxMessageListener(),t(r)})).catch((function(e){(0,o.jl)().exception("OPX_RegisterOpxHost_Failure",6,e),n(e)}))})).catch((function(e){(0,o.jl)().exception("OPX_FetchSystemConfiguration_Failure",6,e),n(e)}))}))},t.prototype.fetchSystemConfiguration=function(){return Promise.resolve({OpxEndpoints:{MyDay:{OpxEndpointUrl:this.upn?"/opx/".concat(this.upn,"/myday"):"/opx/myday",OpxOAuthResourceUrl:this.opxResourceUrl},ExchangeData:{OpxEndpointUrl:this.upn?"/opx/".concat(this.upn,"/dataprovider"):"/opx/dataprovider",OpxOAuthResourceUrl:this.opxResourceUrl}},OpxRootUrlLowerCase:this.opxHostUrl.toLowerCase(),OpxSupported:!0})},t.prototype.registerOpxMessageListener=function(){this.SuiteApi.Service.registerPostMessageHandler({handleMessage:this.handleIncomingOpxMessage,validateMessage:this.validateIncomingOpxMessage,validateOrigin:this.validateIncomingOpxMessageOrigin})},t.prototype.queryOpxIframe=function(e,t){var n=this;void 0===t&&(t=5e3);var r=e.message.asyncResult;return new Promise((function(a,i){n.SuiteApi.Service.callOpxIframe(e),null==n.opxOutstandingOpxQueries[e.targetOpxInstance]&&(n.opxOutstandingOpxQueries[e.targetOpxInstance]={});var o=n.currentOpxQueryID++,s=n.opxOutstandingOpxQueries[e.targetOpxInstance],u=setTimeout((function(){delete s[o],i(new Error("Query timeout."))}),t);s[o]={id:o,opxFrameID:e.targetOpxInstance,queryType:r.type,onQueryComplete:function(e){clearTimeout(u),delete s[o],a(e)}}}))},t}(l.V);var m=n(47487),S=n(62244),y=n(63481),v=n(43474),C=function(){function e(e){this.userTheme=e}return e.prototype.GetUserThemeId=function(){return(0,o.q4)().getCurrentThemeId()},e.prototype.ChangeTheme=function(e){},e.prototype.SaveTheme=function(e,t){var n=this;return new Promise((function(r,a){n.userTheme.setUserTheme(e,t).then((function(e){e.O365Success||e.OwaSuccess?r():a(new Error("SaveThemeFailure"))})).catch(a)}))},e.prototype.SaveDarkTheme=function(e){var t=this;return new Promise((function(n,r){t.userTheme.setUserThemeSettingsInWCSS(e).then((function(e){e.O365Success||e.OwaSuccess?n():r(new Error("SaveThemeFailure"))})).catch(r)}))},e.prototype.GetModeLogo=function(e){var t=this;return new Promise((function(n,r){t.userTheme.getModeLogo(e).then((function(e){if(e){var t="";e.HasTenantLogo&&(e.LogoUrl?t=e.LogoUrl:e.LogoData&&(t=e.LogoData));var a={isLogoVisible:!0,logoUrl:t,logoNavigationUrl:e.HomePageUrl?e.HomePageUrl:""};return n(a)}return r(new Error("GetModeLogoFailure"))})).catch(r)}))},e.prototype.SetUserThemesData=function(e){(0,u.ef)().dispatch((0,u.gJ)(e))},e}(),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.initializeComponent=function(){(0,o.q4)().setUserThemesHandler(new C(this))},t.prototype.loadUserThemeChoices=function(){return this.checkInitialized(),(0,o.q4)().loadAllThemeJson()},t.prototype.setUserTheme=function(e,t){var n=this;this.checkInitialized(),this.clearUserThemeCache();var r,a=e=e.replace(/^\w/,(function(e){return e.toUpperCase()}));return e.toLowerCase()===y.fy&&t&&(a=y.wn),r=m.X((function(){return n.setUserThemeInWCSS(e,e.toLowerCase()===y.fy&&t)}),2),this.SuiteApi.Configuration.IsPwa?r:r.then((function(){return m.X((function(){return n.setUserThemeInExchange(a,!0)}),2)}))},t.prototype.setUserThemeInWCSS=function(e,t){var n=this;return new Promise((function(r,a){var s={url:(0,S.Uw)("{0}/api/settings/theme",n.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:n.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:i.FH.PUT,headers:v.A,body:JSON.stringify({ThemeID:e,PreferOfficeTheme:t})};(0,o.jl)().tag("SetUserThemeStart",1,"WCSS",e),n.SuiteApi.Service.callEndpointWithOauthToken(s).then((function(t){(0,o.jl)().tag("SetUserThemeSuccess",1,"WCSS",e),r({OwaSuccess:void 0,O365Success:!0})})).catch((function(e){i.LU.genericServiceRejection("Settings_SetUserThemeInWCSS_Failed",6,e,a)}))}))},t.prototype.setUserThemeSettingsInWCSS=function(e){var t=this;return new Promise((function(n,r){var a={url:(0,S.Uw)("{0}/api/settings/darkmode",t.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:i.FH.PUT,headers:v.A,body:JSON.stringify({IsDarkmode:e})};t.SuiteApi.Service.callEndpointWithOauthToken(a).then((function(t){(0,o.jl)().tag("SetUserThemeSettingsSuccess",1,e.toString()),n({O365Success:!0})})).catch((function(e){i.LU.genericServiceRejection("Settings_SetUserThemeSettingsInWCSS_Failed",6,e,r)}))}))},t.prototype.getModeLogo=function(e){var t=this;return new Promise((function(n,r){var a={url:(0,S.Uw)("{0}/api/theme/tenant?useDarkMode="+"".concat(e),t.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:i.FH.GET,headers:v.A};t.SuiteApi.Service.callEndpointWithOauthToken(a).then((function(e){n(e)})).catch((function(e){i.LU.genericServiceRejection("Settings_GetModeLogoFromWCSS_Failed",6,e,r)}))}))},t.prototype.setUserThemeInExchange=function(e,t){var n=this;return new Promise((function(r,a){(0,o.q4)().getUserThemeByID(e).then((function(o){(n.SuiteApi.Configuration.OpxEnabled&&n.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!n.SuiteApi.Configuration.IsOwa?n.setUserThemeViaOpx(e,t):n.setUserThemeViaSuiteServiceProxy(e,t,o)).then((function(e){r({OwaSuccess:e.OwaSuccess,O365Success:e.O365Success||t})})).catch((function(e){i.LU.genericServiceRejection("Settings_SetUserThemeInExchange_Failed",6,e,a)}))}))}))},t.prototype.setUserThemeViaOpx=function(e,t){return n.e("exchangedata").then(n.bind(n,5172)).then((function(n){return n.setUserTheme(e,t)}))},t.prototype.setUserThemeViaSuiteServiceProxy=function(e,t,n){var r=this,i={ThemeId:e,SkipO365Call:t};n&&e!==y.wn&&(i.UserThemeJson=JSON.stringify(n));var o,s={request:(o=i,(0,a.__assign)({__type:"SetUserThemeRequest:#Exchange"},o))};return new Promise((function(e,t){r.SuiteApi.User.getOwaUserConfiguration().then((function(t){var n=r.SuiteApi.Service.callOwaIframeAction("SetUserTheme",s);e(n)})).catch((function(e){t(e)}))}))},t.prototype.clearUserThemeCache=function(){var e=this;this.SuiteApi.Configuration.ClearThemeCacheData&&0!==this.SuiteApi.Configuration.ClearThemeCacheData.length&&this.SuiteApi.Configuration.ClearThemeCacheData.map((function(t){if(null!=t.WorkloadUrl&&t.WorkloadUrl.length>0&&(!t.NoRequestInSameWorkload||e.SuiteApi.Configuration.WorkloadId.toLowerCase()!==t.WorkloadId.toLowerCase())&&null!=t.RequestType&&t.RequestType.length>0&&("img"===t.RequestType.toLowerCase()||"iframe"===t.RequestType.toLowerCase())){var n=document.createElement(t.RequestType);n.setAttribute("src",t.WorkloadUrl),n.setAttribute("style","display:none"),"iframe"===t.RequestType.toLowerCase()&&(n.addEventListener("load",(function(){return document.body.removeChild(n)})),document.body.appendChild(n))}}))},t}(l.V);function I(e){return(0,a.__assign)({__type:"JsonRequestHeaders:#Exchange"},e)}function T(e){return(0,a.__assign)({__type:"TimeZoneContext:#Exchange"},e)}var D={baseUrl:"/owa",isFeatureEnabled:function(){return!1},prefetchTaskQueue:new(function(){function e(e){void 0===e&&(e={maxParallelTasks:1,taskQuanta:0}),this.config=e,this.taskList={},this.numberOfTasksRunning=0}return e.prototype.add=function(e,t){var n=this;return void 0===t&&(t=0),this.taskList[t]||(this.taskList[t]=[]),new Promise((function(r,a){n.taskList[t].unshift({func:e,resolve:r,reject:a}),n.scheduleTask()}))},e.prototype.clear=function(){this.taskList={}},e.prototype.scheduleTask=function(){var e=this;this.config.taskQuanta<0?this.tryRunTask():setTimeout((function(){e.tryRunTask()}),this.config.taskQuanta||0)},e.prototype.tryRunTask=function(){var e=this,t=Object.keys(this.taskList);if(this.numberOfTasksRunning<(this.config.maxParallelTasks||1)&&t.length>0){var n=Math.min.apply(null,t.map((function(e){return parseInt(e)}))),r=this.taskList[n].pop();this.taskList[n]&&0!=this.taskList[n].length||delete this.taskList[n],this.numberOfTasksRunning++,r.func().then((function(t){r.resolve(t),e.onTaskComplete()})).catch((function(t){r.reject(t),e.onTaskComplete()})),this.scheduleTask()}},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e}())({taskQuanta:-1}),timeoutMS:9e4,disableAllRequests:!1},w=D;function A(e){return e||(e=w.timezone),I(e?{RequestServerVersion:"V2018_01_08",TimeZoneContext:T({TimeZoneDefinition:(t={Id:e},(0,a.__assign)({__type:"TimeZoneDefinitionType:#Exchange"},t))})}:{RequestServerVersion:"V2018_01_08"});var t}var O=n(96520),x=null,L=i.xX.SuiteServiceApiRelativePath+"LanguageTimezone",k=null,R=null,P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.initializeComponent=function(){null!=(x=this.SuiteApi.Configuration.GraphOauthResourceUrl)&&(x=(0,u.Uw)("{0}/{1}",x,"v1.0/me"),k=(0,u.Uw)("{0}/{1}",x,"outlook/supportedLanguages"),R=(0,u.Uw)("{0}/{1}",x,"outlook/supportedTimeZones"))},t.prototype.getLanguageAndTimeZone=function(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageAndTimeZone():this.getSuiteLanguage()},t.prototype.getLanguageChoices=function(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageChoices():this.getSuiteLanguageChoices()},t.prototype.getTimeZoneChoices=function(){var e=this;return new Promise((function(t,n){var r={url:R,method:i.FH.GET};e.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){t(e.value)})).catch((function(e){i.LU.genericServiceRejection("Settings_GetTimeZoneChoices_Failed",6,e,n)}))}))},t.prototype.getDateTimeFormats=function(e){var t=this;return new Promise((function(n,r){var a={url:(0,u.Uw)("{0}/api/settings/datetimeformats?cultureName={1}",t.SuiteApi.Configuration.TokenFactoryIframeOrigin,e),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:i.FH.GET,headers:v.A};t.SuiteApi.Service.callEndpointWithOauthToken(a).then(n).catch((function(e){i.LU.genericServiceRejection("Settings_GetDateTimeFormats_Failed",6,e,r)}))}))},t.prototype.setLanguageAndTimeZone=function(e){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.setOwaLanguageAndTimeZone(e):this.setSuiteLanguage(e.CurrentCultureName)},t.prototype.setSuiteLanguage=function(e){var t=this;return new Promise((function(n,r){var a={url:x,method:i.FH.PATCH,headers:v.D,body:JSON.stringify({preferredLanguage:e})};t.SuiteApi.Service.callEndpointWithOauthToken(a).then((function(e){n()})).catch((function(e){i.LU.genericServiceRejection("Settings_SetSuiteLanguage_Failed",6,e,r)}))}))},t.prototype.setOwaLanguageAndTimeZone=function(e){var t=this;return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise((function(n,r){e.CurrentCultureLcid=null;var o,s={Language:e.CurrentCultureName,TimeZone:e.CurrentTimeZone,DateFormat:e.CurrentDateFormat,TimeFormat:e.CurrentTimeFormat},u=(o={Header:A(),Options:s},(0,a.__assign)({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},o));t.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("SetMailboxRegionalConfiguration",u,null).then((function(r){t.setSuiteLanguage(e.CurrentCultureName),n()})).catch((function(e){i.LU.genericServiceRejection("Settings_SetOwsOwaLanguageAndTimeZone_Failed",6,e,r)}))})):new Promise((function(n,r){e.CurrentCultureLcid=null,t.SuiteApi.Service.callOwaIframeResourceUrl(L,e,i.FH.PUT).then(n).catch((function(e){i.LU.genericServiceRejection("Settings_SetLanguageAndTimeZoneViaOwa_Failed",6,e,r)}))}))},t.prototype.getSuiteLanguageChoices=function(){return new Promise((function(e,t){O?e(O):t(new Error("Supported languages not found"))}))},t.prototype.getOwaLanguageChoices=function(){var e=this;return new Promise((function(t,n){var r={url:k,method:i.FH.GET};e.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){var n=e.value.map((function(e){return{Locale:e.locale,DisplayName:e.displayName}}));t(n)})).catch((function(e){i.LU.genericServiceRejection("Settings_GetOwaLanguageChoices_Failed",6,e,n)}))}))},t.prototype.getSuiteLanguage=function(){var e=this;return new Promise((function(t,n){var r={url:x,method:i.FH.GET};e.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){var n={CurrentCultureName:e.preferredLanguage};t(n)})).catch((function(e){i.LU.genericServiceRejection("Settings_GetSuiteLanguage_Failed",6,e,n)}))}))},t.prototype.getOwaLanguageAndTimeZone=function(){var e=this;return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise((function(t,n){var r,o=(r={Header:A(),VerifyDefaultFolderNameLanguage:!1},(0,a.__assign)({__type:"GetMailboxRegionalConfigurationRequest:#Exchange"},r));e.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("GetMailboxRegionalConfiguration",o,null).then((function(e){var n=e.Options,r={CurrentCultureLcid:0,CurrentCultureName:n.Language,CurrentTimeZone:n.TimeZone,CurrentDateFormat:n.DateFormat,CurrentTimeFormat:n.TimeFormat};t(r)})).catch((function(e){i.LU.genericServiceRejection("Settings_GetOwsOwaLanguageAndTimeZone_Failed",6,e,n)}))})):new Promise((function(t,n){e.SuiteApi.Service.callOwaIframeResourceUrl(L,null,i.FH.GET).then((function(e){var n=e.Body.Configuration;t(n)})).catch((function(e){i.LU.genericServiceRejection("Settings_GetOwaLanguageAndTimeZone_Failed",6,e,n)}))}))},t}(l.V),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.initializeComponent=function(){this.userTheme=null==this.SuiteApi.Configuration.IUserThemeOverride?new b:this.SuiteApi.Configuration.IUserThemeOverride,this.languageAndTimeZone=null==this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride?new P:this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride,this.userTheme.initialize(this.SuiteApi),this.languageAndTimeZone.initialize(this.SuiteApi)},t.prototype.loadUserThemeChoices=function(){return this.userTheme.loadUserThemeChoices()},t.prototype.setUserTheme=function(e,t){return this.userTheme.setUserTheme(e,t)},t.prototype.getLanguageAndTimeZone=function(){return this.languageAndTimeZone.getLanguageAndTimeZone()},t.prototype.getLanguageChoices=function(){return this.languageAndTimeZone.getLanguageChoices()},t.prototype.getTimeZoneChoices=function(){return this.languageAndTimeZone.getTimeZoneChoices()},t.prototype.getDateTimeFormats=function(e){return this.languageAndTimeZone.getDateTimeFormats(e)},t.prototype.setLanguageAndTimeZone=function(e){return this.languageAndTimeZone.setLanguageAndTimeZone(e)},t}(l.V),U=n(60331),F="/v1.0/me/photo/$value",N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.initializeComponent=function(){},Object.defineProperty(t.prototype,"OwaUserConfig",{get:function(){return this.userConfig},enumerable:!1,configurable:!0}),t.prototype.getOwaUserConfiguration=function(){null==this.userConfigPromise&&(this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.userConfigPromise=this.getOwaUserConfigurationViaOpx():this.userConfigPromise=this.getOwaUserConfigurationViaSuiteServiceProxy());var e=window.setTimeout((function(){return(0,o.jl)().tag("User_GetOwaUserConfiguration_MessageTimeout",6)}),15e3);return this.userConfigPromise.then((function(){return window.clearTimeout(e)})).catch((function(){return window.clearTimeout(e)})),this.userConfigPromise},t.prototype.getOwaUserConfigurationViaOpx=function(){return n.e("exchangedata").then(n.bind(n,5172)).then((function(e){return e.getOwaUserConfig()})).catch((function(e){throw(0,o.jl)().exception("User_GetOwaUserConfigurationViaOpx_Failed",4,e),e}))},t.prototype.getOwaUserConfigurationViaSuiteServiceProxy=function(){var e=this;return new Promise((function(t,n){var r={command:i.uJ.OwaUserConfig,timeout:1e4},a=function(){e.SuiteApi.Service.callOwaIframeAction("GetOwaUserConfiguration",{}).then((function(r){if(e.userConfig=r,null!=e.userConfig&&""!==e.userConfig)e.onOwaUserConfigSucceeded(t);else{var a=new i.Pp("null OwaUserConfiguration received from server");(0,o.jl)().exception("User_GetOwaUserConfiguration_NullConfig",4,a),n(a)}})).catch((function(e){i.LU.genericServiceRejection("User_GetOwaUserConfiguration_Failed",4,e,n)}))};if(e.SuiteApi.Configuration.IsOwa)a();else{r.success=function(n){e.userConfig=n.responseObject,"GetOwaUserConfiguration"===i.es.Instance.configuration.StartupActionName&&e.SuiteApi.Service.setStartupActionCompleted(),e.onOwaUserConfigSucceeded(t)},r.error=function(e,t,n){(0,o.jl)().exception("GetOwaUserConfiguration_ContextUnavailable",4,new i.Pp(n,t)),a()};var s=i.Ou.OwaInstance;null==s?n(new i.Pp("OwaIframe",-1011)):s.getOwaUserConfiguration(r)}}))},t.prototype.getPhotoFromGraph=function(e){var t=this,n=(0,S.xH)(e)?F:(0,S.Uw)("/v1.0/users/{0}/photo/$value",e),r={method:i.FH.GET,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+n,binaryStringResponseBody:!0};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(t){e(window.btoa(t))})).catch((function(t){404===t.errorInfo.HttpStatus?e(""):i.LU.genericServiceRejection("User_GetPhotoFromGraph_Failed",4,t,n)}))}))},t.prototype.prefetchGraphToken=function(){var e=this;return new Promise((function(t,n){null!=e.SuiteApi.Configuration.GraphOauthResourceUrl?e.SuiteApi.Service.prefetchAccessToken(e.SuiteApi.Configuration.GraphOauthResourceUrl+F,e.SuiteApi.Configuration.GraphOauthResourceUrl).then(t).catch(n):n()}))},t.prototype.uploadPhotoToGraph=function(e){var t=this,n=e.split(","),r=n[0].split(":")[1].split(";")[0],a=n[1],o={method:i.FH.PUT,headers:{"Content-Type":r},timeout:7e3,body:window.atob(a),resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+F,binaryStringRequestBody:!0};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(o).then(e).catch((function(e){i.LU.genericServiceRejection("User_UploadPhotoToGraph_Failed",6,e,n)}))}))},t.prototype.onOwaUserConfigSucceeded=function(e){null!=this.userConfig.SessionSettings?i.es.Instance.MailboxGuid=this.userConfig.SessionSettings.MailboxGuid:(0,o.jl)().tag("User_GetOwaUserConfiguration_SessionSettingsNull",4),e(this.userConfig)},t.prototype.getOCPSUserPolicies=function(e,t){var n=this,r=this.SuiteApi.Configuration.OcpsOauthResourceUrl,a=e?r+"?PoliciesHash="+e:r,o={body:"",method:i.FH.GET,headers:{Accept:"application/json","x-Cid":t},resource:a,url:this.SuiteApi.Configuration.OcpsOauthEndpointUrl};return new Promise((function(e,t){n.SuiteApi.Service.callEndpointWithOauthToken(o,!0).then((function(t){e(t)})).catch((function(e){i.LU.genericServiceRejection("getOCPSPolicies_Failed",6,e,t)}))}))},t}(l.V),_=function(){function e(e){this.configuration=e,this.StartupActionName="GetOwaUserConfiguration",this.validateConfiguration(e),this.owaUrlSpecialHandling(e),i.es.Initialize((0,a.__assign)((0,a.__assign)({},e),{StartupActionName:this.StartupActionName})),this.service=i.t6.Instance,this.storage=null==e.IStorageOverride?new U.Ke:e.IStorageOverride,this.webShellStorage=null==e.IWebShellStorageOverride?new U.RQ:e.IWebShellStorageOverride,this.user=null==e.IUserOverride?new N:e.IUserOverride,this.settings=null==e.ISettingsOverride?new E:e.ISettingsOverride,this.documentsModule=null==e.IDocumentsOverride?new c:e.IDocumentsOverride,this.owaPoweredExperiences=null==e.IOwaPoweredExperiencesOverride?new g:e.IOwaPoweredExperiencesOverride,this.service=i.t6.Instance,e.UserHasExchangeLicense?e.SuiteServiceCallsDisabled?this.service.blockSuiteServiceCalls(i.vj.Brs):e.IsPwa&&this.service.blockSuiteServiceCalls(i.vj.Pwa):this.service.blockSuiteServiceCalls(i.vj.NoExoLicense),this.storage.initialize(this),this.webShellStorage.initialize(this),this.user.initialize(this),this.documentsModule.initialize(this),this.settings.initialize(this),e.OpxEnabled&&this.owaPoweredExperiences.initialize(this)}return Object.defineProperty(e.prototype,"Configuration",{get:function(){return this.configuration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Service",{get:function(){return this.service},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"User",{get:function(){return this.user},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Storage",{get:function(){return this.storage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"WebShellStorage",{get:function(){return this.webShellStorage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DocumentsModule",{get:function(){return this.documentsModule},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OwaPoweredExperiences",{get:function(){return this.owaPoweredExperiences},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this.settings},enumerable:!1,configurable:!0}),e.CreateInstance=function(t){if(null!=this.instance){var n=new Error("Instance already exists.");throw(0,o.jl)().exception("SuiteApi_InstanceAlreadyExists",6,n),n}return this.instance=new e(t),this.instance},e.isInitialized=function(){return null!=this.instance},Object.defineProperty(e,"Instance",{get:function(){if(null==e.instance)throw new Error("Instance not yet created.");return e.instance},enumerable:!1,configurable:!0}),e.clearInstanceForTesting=function(){i.es.isUnitTestMode&&(e.instance=null,i.Ou.resetAllInstancesForTesting())},e.prototype.validateConfiguration=function(e){s.throwOnNullOrUndefined(e,"configuration"),s.throwOnNullOrUndefined(e.SuiteServiceUrl,"SuiteApiConfiguration.SuiteServiceUrl")},e.prototype.owaUrlSpecialHandling=function(e){if(e.IsOwa){var t=e.SuiteServiceUrl.toLowerCase(),n=i.xX.getUrlDomainPart(t),r=i.xX.getUrlDomainPart(window.location.href).toLowerCase();n!==r&&(e.SuiteServiceUrl=t.replace(n,r))}},e}()},28949:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});var r=n(9028),a=n(20851),i=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"SuiteApi",{get:function(){return this.suiteApi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsInitialized",{get:function(){return this.isInitialized},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){r.throwOnNullOrUndefined(e,"suiteApi"),this.IsInitialized||(this.suiteApi=e,this.initializeComponent(),this.isInitialized=!0)},e.prototype.checkInitialized=function(){if(!this.isInitialized)throw new a.Pp("SuiteApiComponent_InvalidInitializationCheck",-2002)},e}()},43474:function(e,t,n){"use strict";n.d(t,{A:function(){return r},D:function(){return a}});var r={Accept:"application/json","Content-Type":"application/json; charset=utf-8"},a={Accept:"application/json","Content-Type":"application/json; charset=utf-8"}},2823:function(e,t,n){"use strict";n.d(t,{p:function(){return i},y:function(){return a}});var r=n(20851);function a(e){return new r.Pp("Argument Exception: ".concat(e),-2001)}function i(e){return new r.Pp("Invalid Operation: ".concat(e),-2002)}},79502:function(e,t,n){"use strict";n.d(t,{nR:function(){return o.n}});var r=n(91011),a=n(56003),i=n(59633),o=n(13663);n(2823);function s(e,t){var n,r,i=null!==(n=t.OpxDefaultHostUrl)&&void 0!==n?n:a.WA,o=null!==(r=t.OpxAlternateHostUrls)&&void 0!==r?r:a.Gj;return null!=e.opxHostUrlOverride&&o.indexOf(e.opxHostUrlOverride)>=0&&(i=e.opxHostUrlOverride),i}(0,r.Lo)().subscribe("ShellDataUpdated",(function e(t,n){var u;if(n.SuiteServiceUrl&&(n.IsConsumerShell||n.TokenFactoryIframeOrigin)&&!o.n.isInitialized()){var l=(0,r.aH)(),c={SuiteServiceUrl:n.SuiteServiceUrl,AdminServiceUrl:n.PortalUrl,CurrentUserUpn:n.UPN,CurrentUserPuid:n.PUID,UserHasExchangeLicense:n.HasEXOLicense,SuiteServiceCallsDisabled:n.SuiteServiceCallsDisabled,TokenFactoryIframeOrigin:n.TokenFactoryIframeOrigin,IsOwa:(0,i.o5)(n.WorkloadId),ShellSID:n.SHSID,HintUserName:null!=n.EnableUsernameHinting&&n.EnableUsernameHinting,CultureName:t.CultureName,MruOauthEndpointUrl:n.MruOauthEndpointUrl,MruOauthResourceUrl:n.MruOauthResourceUrl,GraphOauthEndpointUrl:n.GraphOauthEndpointUrl,GraphOauthResourceUrl:n.GraphOauthResourceUrl,OcpsOauthEndpointUrl:n.OcpsOauthEndpointUrl,OcpsOauthResourceUrl:n.OcpsOauthResourceUrl,NotificationsEnabled:n.NotificationsEnabled&&n.HasEXOLicense,WorkloadId:n.WorkloadId,ClientShellVersion:window.O365ShellVerStr,IsPwa:(0,i.So)(n.WorkloadId,t.CurrentMainLinkElementID),IsOwsLanguageTimezoneCallEnabled:n.OwsLanguageTimezoneCallEnabled,GetTokenRequestDictionary:l.GetTokenRequestDictionary,ServiceWorkerCacheId:l.serviceWorkerCacheId,ServiceWorkerFetchStrategy:l.serviceWorkerFetchStrategy,ClearThemeCacheData:null!=n.ClearUserThemeCacheUrls&&n.ClearUserThemeCacheUrls.length>0?JSON.parse(n.ClearUserThemeCacheUrls):[],IsConsumer:n.IsConsumerShell,CSSExperiencesEnabled:n.CSSExperiencesEnabled,OpxEnabled:n.OpxEnabled&&!(0,i.So)(n.WorkloadId,t.CurrentMainLinkElementID),OpxHostUrl:s(l,n),OpxResourceUrl:null!==(u=n.OpxDefaultHostUrl)&&void 0!==u?u:a.WA,ExchangeDataOpxEnabled:n.ExchangeDataOpxEnabled};o.n.CreateInstance(c);var p=(0,r.Lo)();p.invoke("SuiteAPILoaded",o.n.Instance),p.unsubscribe("ShellDataUpdated",e)}}),!0)},81235:function(e,t,n){"use strict";var r;n.d(t,{x:function(){return r}}),function(e){e.MyDay="MyDay",e.ExchangeData="ExchangeData"}(r||(r={}))},35653:function(e,t,n){"use strict";var r,a;n.d(t,{g:function(){return a},r:function(){return r}}),function(e){e.SystemMetadata="SystemMetadata",e.CustomerContent="CustomerContent"}(r||(r={})),function(e){e.User="User",e.Tenant="Tenant"}(a||(a={}))},60331:function(e,t,n){"use strict";n.d(t,{Ke:function(){return S},rq:function(){return y.r},Qt:function(){return c},RQ:function(){return D},gD:function(){return y.g}});var r=n(77224),a=n(20851),i=n(28949),o=n(2823),s=a.xX.SuiteServiceApiRelativePath+"NotificationsSettings/User",u=function(){function e(e){this.suiteApi=e}return e.prototype.readNotificationSettings=function(){var e=this;return new Promise((function(t,n){e.suiteApi.Service.callOwaIframeResourceUrl(s,null,a.FH.GET).then((function(e){t(e)})).catch((function(e){a.LU.genericServiceRejection("ReadNotificationSettings",6,e,n)}))}))},e.prototype.writeNotificationSettings=function(e){var t=this;return new Promise((function(n,r){if(null==e)throw(0,o.y)("settingValue");t.suiteApi.Service.callOwaIframeResourceUrl(s,e,a.FH.PUT).then((function(){n()})).catch((function(e){a.LU.genericServiceRejection("WriteNotificationSettings",6,e,r)}))}))},e}(),l=n(9028),c=function(){function e(e,t,n){this.Scope=e,this.Namespace=t,this.Name=n,(0,l.throwOnNullOrEmpty)(e,"keyScope"),(0,l.throwOnNullOrEmpty)(t,"keyNamespace"),(0,l.throwOnNullOrEmpty)(n,"keyName")}return e.prototype.toString=function(){return this.Scope+a.fO.DictionaryStringPartsSeparator+this.Namespace+a.fO.DictionaryStringPartsSeparator+this.Name},e.fromDictionaryKey=function(t){(0,l.throwOnNullOrEmpty)(t,"keyString");var n=t.split(a.fO.DictionaryStringPartsSeparator);if(n.length<3)throw(0,o.p)("Malformed keyString: Expected format <Scope>//<Namespace>//<Name>");return new e(n[0],n[1],n[2])},e}(),p=function(e,t){this.Key=e,this.Value=t,(0,l.throwOnNull)(e,"key"),(0,l.throwOnNull)(t,"value")},d=function(e){function t(t,n){var r=e.call(this,t)||this;return r.Header=t,r.Body=n,r}return(0,r.__extends)(t,e),t}((function(e){this.Header=e})),f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e)}((function(){})),"Cannot remove a key needed for read or write."),h=function(){function e(e,t,n,r){void 0===e&&(e=!1),void 0===t&&(t=[]),void 0===n&&(n={}),void 0===r&&(r=[]);var a=this;this.clearAll=e,this.writes=n,this.reads={},this.removes={},t.forEach((function(e){return a.reads[e.toString()]=e})),r.forEach((function(e){return a.removes[e.toString()]=e}))}return e.prototype.getReadStorageKeys=function(){var e=this;return Object.keys(this.reads).map((function(t){return e.reads[t]}))},e.prototype.getWriteStorageKeyValues=function(){var e=this;return Object.keys(this.writes).map((function(t){return e.writes[t]}))},e.prototype.getRemoveStorageKeys=function(){var e=this;return Object.keys(this.removes).map((function(t){return e.removes[t]}))},e.prototype.requestRead=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(0,l.throwOnNullOrEmptyArray)(e,"keys");for(var n=0,r=e;n<r.length;n++){var i=r[n];if((0,l.throwOnNull)(i,"key"),this.isRemoveRequested(i))throw new a.Pp(f,-2002);this.reads[i.toString()]=i}},e.prototype.requestWrite=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];(0,l.throwOnUndefined)(e,"value"),(0,l.throwOnNullOrEmptyArray)(t,"keys");for(var r=0,i=t;r<i.length;r++){var o=i[r];if((0,l.throwOnNull)(o,"key"),this.isRemoveRequested(o))throw new a.Pp(f,-2002);this.writes[o.toString()]=new p(o,e)}},e.prototype.requestRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(0,l.throwOnNullOrEmptyArray)(e,"keys");for(var n=0,r=e;n<r.length;n++){var i=r[n];if((0,l.throwOnNull)(i,"key"),i.toString()in this.reads||i.toString()in this.writes)throw new a.Pp(f,-2002);this.removes[i.toString()]=i}},e.prototype.requestClearAll=function(){this.clearAll=!0},e.prototype.combine=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(0,l.throwOnNullOrEmptyArray)(t,"requests");for(var r=new e(this.clearAll),a=0,i=t.concat(this);a<i.length;a++){var o=i[a];o.getReadStorageKeys().length&&r.requestRead.apply(r,o.getReadStorageKeys());for(var s=0,u=Object.keys(o.writes);s<u.length;s++){var c=u[s];r.requestWrite(o.writes[c].Value,o.writes[c].Key)}o.getRemoveStorageKeys().length&&r.requestRemove.apply(r,o.getRemoveStorageKeys())}return r},e.prototype.valueToBeWritten=function(e){(0,l.throwOnNullOrUndefined)(e,"key");var t=this.writes[e.toString()];if(null==t)throw new a.Pp("Cannot read key without value.",-2002);return t.Value},e.prototype.isRemoveRequested=function(e){return(0,l.throwOnNullOrUndefined)(e,"key"),e.toString()in this.removes},e.prototype.isClearAllRequested=function(){return this.clearAll},e.prototype.toStorageServerJsonRequest=function(){var e={ReadSettings:this.getReadStorageKeys().slice(),WriteSettings:this.getWriteStorageKeyValues().map((function(e){return new p(e.Key,JSON.stringify(e.Value))}))};return new d({},e)},e.prototype.toStorageDataRequest=function(e){return{UserId:e,ClearAll:this.clearAll,Reads:this.getReadStorageKeys().map((function(e){return e.toString()})),Writes:this.getWriteStorageKeyValues().map((function(e){return{Key:e.Key.toString(),Value:JSON.stringify(e.Value)}})),Deletes:this.getRemoveStorageKeys().map((function(e){return e.toString()})),RequestType:0}},e}(),g=function(){function e(e){void 0===e&&(e={}),this.values=e}return e.fromStorageSessionResponseData=function(t){l.throwOnNullOrUndefined(t,"data");for(var n=new e({}),r=0,a=Object.keys(t.Reads);r<a.length;r++){var i=a[r],o=new p(c.fromDictionaryKey(i),JSON.parse(t.Reads[i]));n.values[o.Key.toString()]=o.Value}return n},e.fromStorageServerResponseData=function(t){l.throwOnNullOrUndefined(t,"data");for(var n=new e({}),r=0,a=t.Settings;r<a.length;r++){var i=a[r],o=new p(i.Key,JSON.parse(i.Value));n.values[o.Key.toString()]=o.Value}return n},e.prototype.hasKey=function(e){return l.throwOnNullOrUndefined(e,"key"),e.toString()in this.values},e.prototype.value=function(e){if(l.throwOnNullOrUndefined(e,"key"),!(e.toString()in this.values))throw new a.Pp("Key value missing.",-2002);return this.values[e.toString()]},e.prototype.getStorageKeyValues=function(){var e=this;return Object.keys(this.values).map((function(t){return e.values[t]}))},e}(),m=n(91011),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){this.NotificationsStorage=new u(this.SuiteApi)},t.prototype.createStorageRequest=function(){return this.checkInitialized(),new h},t.prototype.submitStorageRequestToOwaSessionStorage=function(e,t){var n=this;return this.checkInitialized(),new Promise((function(r,i){if(null==e)return i(o.y("request"));n.SuiteApi.Service.owaSessionStorageRequest(e.toStorageDataRequest(n.SuiteApi.Configuration.CurrentUserUpn)).then((function(e){n.checkStorageResponseErrors(e,i)||r(g.fromStorageSessionResponseData(e))})).catch((function(e){a.LU.isCallsBlockedException(e)||(0,m.jl)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,e.errorCode),i(e)})),null!=t&&window.setTimeout((function(){var e=new Error("Session Storage Request Timeout");(0,m.jl)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,-1001),i(e)}),t)}))},t.prototype.isServerStorageEnabled=function(e){return a.es.Instance.configuration.UserHasExchangeLicense||e},t.prototype.readNotificationSettings=function(){return this.checkInitialized(),this.NotificationsStorage.readNotificationSettings()},t.prototype.writeNotificationSettings=function(e){return this.checkInitialized(),this.NotificationsStorage.writeNotificationSettings(e)},t.prototype.checkStorageResponseErrors=function(e,t){var n=e;return n.ClearError,n.WriteError,n.ReadError,null!=n.ResetError&&(t(n.ResetError),!0)},t}(i.V),y=n(35653),v=n(6037),C=n(37005),b=n(43474),I=function(){function e(e){void 0===e&&(e=new h),this.storageRequest=e}return e.prototype.requestRead=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.storageRequest).requestRead.apply(e,t)},e.prototype.requestWrite=function(e){for(var t,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];(t=this.storageRequest).requestWrite.apply(t,(0,r.__spreadArray)([e],n,!1))},e.prototype.toStorageDataRequest=function(e){return this.storageRequest.toStorageDataRequest(e)},e.prototype.requestClearAll=function(){this.storageRequest.requestClearAll()},e}(),T=function(){function e(e){void 0===e&&(e=void 0),this.value=e}return e.prototype.fromStorageSessionResponseData=function(e){this.storageResponse=g.fromStorageSessionResponseData(e)},e.prototype.hasValue=function(e){return v.vo.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.hasKey(e)&&null!=this.storageResponse.value(e)},e.prototype.getValue=function(e){return v.vo.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.value(e)},e}(),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){},t.prototype.createWebShellStorageRequest=function(){return this.checkInitialized(),new I},t.prototype.readStorage=function(e,t,n){this.checkInitialized();var r=this.createTokenFactoryRequest(t,e,n,a.FH.GET);return this.useStorage(r)},t.prototype.batchReadStorage=function(e,t,n){this.checkInitialized();var r=this.createTokenFactoryBatchRequest(t,e,n,a.FH.GET);return this.useStorage(r)},t.prototype.writeStorage=function(e,t,n,r){this.checkInitialized();var i=this.createTokenFactoryRequest(t,e,n,a.FH.PUT);return i.body=JSON.stringify(r),this.useStorage(i)},t.prototype.removeStorage=function(e,t,n){this.checkInitialized();var r=this.createTokenFactoryRequest(t,e,n,a.FH.DELETE);return this.useStorage(r)},t.prototype.readSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.writeSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.removeSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.readLocalStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.writeLocalStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.removeLocalStorage=function(e){return Promise.reject(new Error("not implemented"))},t.prototype.createTokenFactoryRequest=function(e,n,r,a){v.vo.throwOnNullOrEmpty(r,"keyName");var i=(0,v.Uw)("{0}/api/storage/{1}/{2}/{3}?api-version={4}&shellType=OneShell",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,n,encodeURIComponent(r),t.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)},t.prototype.createTokenFactoryBatchRequest=function(e,n,r,a){v.vo.throwOnNullOrEmptyArray(r,"keyNames");var i=(0,v.Uw)("{0}/api/storage/{1}/{2}/{3}?api-version={4}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,n,encodeURIComponent(r.join(",")),t.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)},t.prototype.createTokenFactoryRequestHelper=function(e,t){return{url:e,resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:t,headers:b.A}},t.prototype.useStorage=function(e){var t=this;return new Promise((function(n,r){t.SuiteApi.Service.callEndpointWithOauthToken(e).then((function(e){n(new T(e))})).catch(r)}))},t.prototype.useBrowserStorage=function(e){var t=this;return new Promise((function(n,r){v.vo.throwOnNull(e,"StorageRequest");var i=!1,s=e.toStorageDataRequest(t.SuiteApi.Configuration.CurrentUserUpn),u={url:a.es.Instance.configuration.TokenFactoryIframeOrigin,requestObject:s,timeout:3e4,success:function(e){i=!0;var a=e.responseObject;if(!t.checkStorageResponseErrors(a,r)){var o=new T;o.fromStorageSessionResponseData(a),n(o)}},error:function(e,t,n){i=!0;var a=C.Eu(n);(0,m.jl)().tag("StorageApi_RequestError",6,t,a),r((0,o.p)(a))}},l=null;t.SuiteApi.Service.AreSuiteServiceCallsBlocked||(l=a.Ou.OauthTokenFactoryInstance),null!=l?(setTimeout((function(){if(!i){i=!0;var e=new Error("StorageTimeout");(0,m.jl)().exception("StorageApi_TimeoutError",6,e),r(e)}}),u.timeout),l.executeStorageRequest(u)):r(new a.Pp("OauthTokenFactoryIframe",-1011))}))},t.prototype.checkStorageResponseErrors=function(e,t){var n=e;if(!n){var r=new Error("Empty response received.");(0,m.jl)().exception("StorageApi_NoResponse",6,r),t(r)}if(null!=n.ClearError)t(n.ClearError);else if(null!=n.WriteError)t(n.WriteError);else if(null!=n.ReadError)t(n.ReadError);else{if(null==n.ResetError)return!1;t(n.ResetError)}return!0},t.ApiVersion="1",t}(i.V)},96520:function(e){"use strict";e.exports=JSON.parse('[{"Locale":"af-NA","DisplayName":"Afrikaans (Namibi)"},{"Locale":"af-ZA","DisplayName":"Afrikaans (Suid-Afrika)"},{"Locale":"am-ET","DisplayName":" ()"},{"Locale":"ar-AE","DisplayName":" (  )"},{"Locale":"ar-BH","DisplayName":" ()"},{"Locale":"ar-DJ","DisplayName":" ()"},{"Locale":"ar-DZ","DisplayName":" ()"},{"Locale":"ar-EG","DisplayName":" ()"},{"Locale":"ar-ER","DisplayName":" ()"},{"Locale":"ar-IL","DisplayName":" ()"},{"Locale":"ar-IQ","DisplayName":" ()"},{"Locale":"ar-JO","DisplayName":" ()"},{"Locale":"ar-KM","DisplayName":" ( )"},{"Locale":"ar-KW","DisplayName":" ()"},{"Locale":"ar-LB","DisplayName":" ()"},{"Locale":"ar-LY","DisplayName":" ()"},{"Locale":"ar-MA","DisplayName":" ( )"},{"Locale":"ar-MR","DisplayName":" ()"},{"Locale":"ar-OM","DisplayName":" ()"},{"Locale":"ar-PS","DisplayName":" ( )"},{"Locale":"ar-QA","DisplayName":" ()"},{"Locale":"ar-SA","DisplayName":" (  )"},{"Locale":"ar-SO","DisplayName":" ()"},{"Locale":"ar-SS","DisplayName":" ( )"},{"Locale":"ar-TD","DisplayName":" ()"},{"Locale":"ar-TN","DisplayName":" ()"},{"Locale":"as-IN","DisplayName":" ()"},{"Locale":"az-Latn-AZ","DisplayName":"azrbaycan (Azrbaycan)"},{"Locale":"be-BY","DisplayName":" ()"},{"Locale":"bg-BG","DisplayName":" ()"},{"Locale":"bn-BD","DisplayName":" ()"},{"Locale":"bn-IN","DisplayName":" ()"},{"Locale":"bs-Latn-BA","DisplayName":"bosanski (Bosna i Hercegovina)"},{"Locale":"ca-AD","DisplayName":"catal (Andorra)"},{"Locale":"ca-ES","DisplayName":"catal (catal)"},{"Locale":"ca-FR","DisplayName":"catal (Frana)"},{"Locale":"ca-IT","DisplayName":"catal (Itlia)"},{"Locale":"cs-CZ","DisplayName":"etina (esko)"},{"Locale":"cy-GB","DisplayName":"Cymraeg (Y Deyrnas Unedig)"},{"Locale":"da-DK","DisplayName":"dansk (Danmark)"},{"Locale":"da-GL","DisplayName":"dansk (Grnland)"},{"Locale":"de-AT","DisplayName":"Deutsch (sterreich)"},{"Locale":"de-BE","DisplayName":"Deutsch (Belgien)"},{"Locale":"de-CH","DisplayName":"Deutsch (Schweiz)"},{"Locale":"de-DE","DisplayName":"Deutsch (Deutschland)"},{"Locale":"de-IT","DisplayName":"Deutsch (Italien)"},{"Locale":"de-LI","DisplayName":"Deutsch (Liechtenstein)"},{"Locale":"de-LU","DisplayName":"Deutsch (Luxemburg)"},{"Locale":"el-CY","DisplayName":" ()"},{"Locale":"el-GR","DisplayName":" ()"},{"Locale":"en-GB","DisplayName":"English (United Kingdom)"},{"Locale":"es-AR","DisplayName":"espaol (Argentina)"},{"Locale":"es-BO","DisplayName":"espaol (Bolivia)"},{"Locale":"es-BR","DisplayName":"espaol (Brasil)"},{"Locale":"es-BZ","DisplayName":"espaol (Belice)"},{"Locale":"es-CL","DisplayName":"espaol (Chile)"},{"Locale":"es-CO","DisplayName":"espaol (Colombia)"},{"Locale":"es-CR","DisplayName":"espaol (Costa Rica)"},{"Locale":"es-CU","DisplayName":"espaol (Cuba)"},{"Locale":"es-DO","DisplayName":"espaol (Repblica Dominicana)"},{"Locale":"es-EC","DisplayName":"espaol (Ecuador)"},{"Locale":"es-ES","DisplayName":"espaol (Espaa, alfabetizacin internacional)"},{"Locale":"es-GQ","DisplayName":"espaol (Guinea Ecuatorial)"},{"Locale":"es-GT","DisplayName":"espaol (Guatemala)"},{"Locale":"es-HN","DisplayName":"espaol (Honduras)"},{"Locale":"es-MX","DisplayName":"espaol (Mxico)"},{"Locale":"es-NI","DisplayName":"espaol (Nicaragua)"},{"Locale":"es-PA","DisplayName":"espaol (Panam)"},{"Locale":"es-PE","DisplayName":"espaol (Per)"},{"Locale":"es-PH","DisplayName":"espaol (Filipinas)"},{"Locale":"es-PR","DisplayName":"espaol (Puerto Rico)"},{"Locale":"es-PY","DisplayName":"espaol (Paraguay)"},{"Locale":"es-SV","DisplayName":"espaol (El Salvador)"},{"Locale":"es-US","DisplayName":"espaol (Estados Unidos)"},{"Locale":"es-UY","DisplayName":"espaol (Uruguay)"},{"Locale":"es-VE","DisplayName":"espaol (Venezuela)"},{"Locale":"et-EE","DisplayName":"eesti (Eesti)"},{"Locale":"eu-ES","DisplayName":"euskara (euskara)"},{"Locale":"fa-IR","DisplayName":" ()"},{"Locale":"fi-FI","DisplayName":"suomi (Suomi)"},{"Locale":"fil-PH","DisplayName":"Filipino (Pilipinas)"},{"Locale":"fr-BE","DisplayName":"franais (Belgique)"},{"Locale":"fr-BF","DisplayName":"franais (Burkina Faso)"},{"Locale":"fr-BI","DisplayName":"franais (Burundi)"},{"Locale":"fr-BJ","DisplayName":"franais (Bnin)"},{"Locale":"fr-BL","DisplayName":"franais (Saint-Barthlemy)"},{"Locale":"fr-CA","DisplayName":"franais (Canada)"},{"Locale":"fr-CF","DisplayName":"franais (Rpublique centrafricaine)"},{"Locale":"fr-CG","DisplayName":"franais (Congo)"},{"Locale":"fr-CH","DisplayName":"franais (Suisse)"},{"Locale":"fr-CI","DisplayName":"franais (Cte dIvoire)"},{"Locale":"fr-CM","DisplayName":"franais (Cameroun)"},{"Locale":"fr-DJ","DisplayName":"franais (Djibouti)"},{"Locale":"fr-DZ","DisplayName":"franais (Algrie)"},{"Locale":"fr-FR","DisplayName":"franais (France)"},{"Locale":"fr-GA","DisplayName":"franais (Gabon)"},{"Locale":"fr-GF","DisplayName":"franais (Guyane franaise)"},{"Locale":"fr-GN","DisplayName":"franais (Guine)"},{"Locale":"fr-GP","DisplayName":"franais (Guadeloupe)"},{"Locale":"fr-GQ","DisplayName":"franais (Guine quatoriale)"},{"Locale":"fr-HT","DisplayName":"franais (Hati)"},{"Locale":"fr-KM","DisplayName":"franais (Comores)"},{"Locale":"fr-LU","DisplayName":"franais (Luxembourg)"},{"Locale":"fr-MA","DisplayName":"franais (Maroc)"},{"Locale":"fr-MC","DisplayName":"franais (Monaco)"},{"Locale":"fr-MF","DisplayName":"franais (Saint-Martin)"},{"Locale":"fr-MG","DisplayName":"franais (Madagascar)"},{"Locale":"fr-ML","DisplayName":"franais (Mali)"},{"Locale":"fr-MQ","DisplayName":"franais (Martinique)"},{"Locale":"fr-MR","DisplayName":"franais (Mauritanie)"},{"Locale":"fr-MU","DisplayName":"franais (Maurice)"},{"Locale":"fr-NC","DisplayName":"franais (Nouvelle-Caldonie)"},{"Locale":"fr-NE","DisplayName":"franais (Niger)"},{"Locale":"fr-PF","DisplayName":"franais (Polynsie franaise)"},{"Locale":"fr-PM","DisplayName":"franais (Saint-Pierre-et-Miquelon)"},{"Locale":"fr-RE","DisplayName":"franais (La Runion)"},{"Locale":"fr-RW","DisplayName":"franais (Rwanda)"},{"Locale":"fr-SC","DisplayName":"franais (Seychelles)"},{"Locale":"fr-SN","DisplayName":"franais (Sngal)"},{"Locale":"fr-TD","DisplayName":"franais (Tchad)"},{"Locale":"fr-TG","DisplayName":"franais (Togo)"},{"Locale":"fr-TN","DisplayName":"franais (Tunisie)"},{"Locale":"fr-VU","DisplayName":"franais (Vanuatu)"},{"Locale":"fr-WF","DisplayName":"franais (Wallis-et-Futuna)"},{"Locale":"fr-YT","DisplayName":"franais (Mayotte)"},{"Locale":"ga-IE","DisplayName":"Gaeilge (ire)"},{"Locale":"gd-GB","DisplayName":"Gidhlig (An Roghachd Aonaichte)"},{"Locale":"gl-ES","DisplayName":"galego (galego)"},{"Locale":"gu-IN","DisplayName":" ()"},{"Locale":"ha-Latn-NG","DisplayName":"Hausa (Najeriya)"},{"Locale":"he-IL","DisplayName":" ()"},{"Locale":"hi-IN","DisplayName":" ()"},{"Locale":"hr-BA","DisplayName":"hrvatski (Bosna i Hercegovina)"},{"Locale":"hr-HR","DisplayName":"hrvatski (Hrvatska)"},{"Locale":"hu-HU","DisplayName":"magyar (Magyarorszg)"},{"Locale":"hy-AM","DisplayName":" ()"},{"Locale":"id-ID","DisplayName":"Indonesia (Indonesia)"},{"Locale":"is-IS","DisplayName":"slenska (sland)"},{"Locale":"it-CH","DisplayName":"italiano (Svizzera)"},{"Locale":"it-IT","DisplayName":"italiano (Italia)"},{"Locale":"it-SM","DisplayName":"italiano (San Marino)"},{"Locale":"it-VA","DisplayName":"italiano (Citt del Vaticano)"},{"Locale":"ja-JP","DisplayName":" ()"},{"Locale":"ka-GE","DisplayName":" ()"},{"Locale":"kk-KZ","DisplayName":"  ()"},{"Locale":"km-KH","DisplayName":" ()"},{"Locale":"kn-IN","DisplayName":" ()"},{"Locale":"ko-KR","DisplayName":"()"},{"Locale":"kok-IN","DisplayName":" ()"},{"Locale":"ky-KG","DisplayName":" ()"},{"Locale":"lb-LU","DisplayName":"Ltzebuergesch (Ltzebuerg)"},{"Locale":"lo-LA","DisplayName":" ()"},{"Locale":"lt-LT","DisplayName":"lietuvi (Lietuva)"},{"Locale":"lv-LV","DisplayName":"latvieu (Latvija)"},{"Locale":"mi-NZ","DisplayName":"te reo Mori (Aotearoa)"},{"Locale":"mk-MK","DisplayName":" ( )"},{"Locale":"ml-IN","DisplayName":" ()"},{"Locale":"mn-MN","DisplayName":" ()"},{"Locale":"mr-IN","DisplayName":" ()"},{"Locale":"ms-BN","DisplayName":"Melayu (Brunei)"},{"Locale":"ms-MY","DisplayName":"Melayu (Malaysia)"},{"Locale":"ms-SG","DisplayName":"Melayu (Singapura)"},{"Locale":"mt-MT","DisplayName":"Malti (Malta)"},{"Locale":"nb-NO","DisplayName":"norsk bokml (Norge)"},{"Locale":"nb-SJ","DisplayName":"norsk bokml (Svalbard og Jan Mayen)"},{"Locale":"ne-NP","DisplayName":" ()"},{"Locale":"nl-AW","DisplayName":"Nederlands (Aruba)"},{"Locale":"nl-BE","DisplayName":"Nederlands (Belgi)"},{"Locale":"nl-BQ","DisplayName":"Nederlands (Bonaire, Sint Eustatius en Saba)"},{"Locale":"nl-CW","DisplayName":"Nederlands (Curaao)"},{"Locale":"nl-NL","DisplayName":"Nederlands (Nederland)"},{"Locale":"nl-SR","DisplayName":"Nederlands (Suriname)"},{"Locale":"nl-SX","DisplayName":"Nederlands (Sint-Maarten)"},{"Locale":"or-IN","DisplayName":" ()"},{"Locale":"pa-IN","DisplayName":" ()"},{"Locale":"pl-PL","DisplayName":"polski (Polska)"},{"Locale":"prs-AF","DisplayName":" ()"},{"Locale":"pt-AO","DisplayName":"portugus (Angola)"},{"Locale":"pt-BR","DisplayName":"portugus (Brasil)"},{"Locale":"pt-CH","DisplayName":"portugus (Sua)"},{"Locale":"pt-CV","DisplayName":"portugus (Cabo Verde)"},{"Locale":"pt-GQ","DisplayName":"portugus (Guin Equatorial)"},{"Locale":"pt-GW","DisplayName":"portugus (Guin-Bissau)"},{"Locale":"pt-LU","DisplayName":"portugus (Luxemburgo)"},{"Locale":"pt-MO","DisplayName":"portugus (RAE de Macau)"},{"Locale":"pt-MZ","DisplayName":"portugus (Moambique)"},{"Locale":"pt-PT","DisplayName":"portugus (Portugal)"},{"Locale":"pt-ST","DisplayName":"portugus (So Tom e Prncipe)"},{"Locale":"pt-TL","DisplayName":"portugus (Timor-Leste)"},{"Locale":"quz-PE","DisplayName":"Runasimi (Per)"},{"Locale":"ro-MD","DisplayName":"romn (Republica Moldova)"},{"Locale":"ro-RO","DisplayName":"romn (Romnia)"},{"Locale":"ru-BY","DisplayName":" ()"},{"Locale":"ru-KG","DisplayName":" ()"},{"Locale":"ru-KZ","DisplayName":" ()"},{"Locale":"ru-MD","DisplayName":" ()"},{"Locale":"ru-RU","DisplayName":" ()"},{"Locale":"ru-UA","DisplayName":" ()"},{"Locale":"sd-Arab-PK","DisplayName":" ()"},{"Locale":"si-LK","DisplayName":" ( )"},{"Locale":"sk-SK","DisplayName":"slovenina (Slovensko)"},{"Locale":"sl-SI","DisplayName":"slovenina (Slovenija)"},{"Locale":"sq-AL","DisplayName":"shqip (Shqipri)"},{"Locale":"sq-MK","DisplayName":"shqip (Maqedonia e Veriut)"},{"Locale":"sq-XK","DisplayName":"shqip (Kosov)"},{"Locale":"sr-Cyrl-BA","DisplayName":" (  )"},{"Locale":"sr-Cyrl-ME","DisplayName":" ( )"},{"Locale":"sr-Cyrl-RS","DisplayName":" ()"},{"Locale":"sr-Cyrl-XK","DisplayName":" ()"},{"Locale":"sr-Latn-BA","DisplayName":"srpski (Bosna i Hercegovina)"},{"Locale":"sr-Latn-ME","DisplayName":"srpski (Crna Gora)"},{"Locale":"sr-Latn-RS","DisplayName":"srpski (Srbija)"},{"Locale":"sr-Latn-XK","DisplayName":"srpski (Kosovo)"},{"Locale":"sv-AX","DisplayName":"svenska (land)"},{"Locale":"sv-FI","DisplayName":"svenska (Finland)"},{"Locale":"sv-SE","DisplayName":"svenska (Sverige)"},{"Locale":"sw-KE","DisplayName":"Kiswahili (Kenya)"},{"Locale":"sw-TZ","DisplayName":"Kiswahili (Tanzania)"},{"Locale":"sw-UG","DisplayName":"Kiswahili (Uganda)"},{"Locale":"ta-IN","DisplayName":" ()"},{"Locale":"ta-LK","DisplayName":" ()"},{"Locale":"ta-MY","DisplayName":" ()"},{"Locale":"ta-SG","DisplayName":" ()"},{"Locale":"te-IN","DisplayName":" ()"},{"Locale":"th-TH","DisplayName":" ()"},{"Locale":"tk-TM","DisplayName":"Trkmen dili (Trkmenistan)"},{"Locale":"tr-CY","DisplayName":"Trke (Kbrs)"},{"Locale":"tr-TR","DisplayName":"Trke (Trkiye)"},{"Locale":"tt-RU","DisplayName":" ()"},{"Locale":"ug-CN","DisplayName":" (  )"},{"Locale":"uk-UA","DisplayName":" ()"},{"Locale":"ur-IN","DisplayName":" ()"},{"Locale":"ur-PK","DisplayName":" ()"},{"Locale":"uz-Arab-AF","DisplayName":" ()"},{"Locale":"uz-Cyrl-UZ","DisplayName":" ()"},{"Locale":"uz-Latn-UZ","DisplayName":"ozbek (Ozbekiston)"},{"Locale":"vi-VN","DisplayName":"Ting Vit (Vit Nam)"},{"Locale":"zh-CN","DisplayName":"()"},{"Locale":"zh-Hans-HK","DisplayName":" ()"},{"Locale":"zh-Hans-MO","DisplayName":" ()"},{"Locale":"zh-HK","DisplayName":"()"},{"Locale":"zh-MO","DisplayName":"()"},{"Locale":"zh-SG","DisplayName":"()"},{"Locale":"zh-TW","DisplayName":"()"}]')}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_plus_end"),shellPerformance.measure("shell_plus","shell_plus_start","shell_plus_end"));