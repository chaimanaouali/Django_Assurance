var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_chat_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["chat"],{28748:function(t,e,n){(e=t.exports=n(25127)(!1)).push([t.id,".w4P7LBKjs8s7OCcvAbPoBQ\\=\\={display:inline-block;font-size:19px;vertical-align:middle}",""]),e.locals={icon:"w4P7LBKjs8s7OCcvAbPoBQ=="}},54326:function(t,e,n){var a=n(28748);"string"==typeof a&&(a=[[t.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(t.exports=a.locals)},29987:function(t,e,n){"use strict";n.d(e,{k:function(){return m},w:function(){return C}});var a,i=n(77224),r=n(64731),o=n(6037),s=n(91011),u=n(58930),c=n(33836),l=n(72607),h=n(54326),d=n(78822),p=n(27676),f=n(82548),C=function(t){var e=t instanceof MouseEvent;if(t instanceof KeyboardEvent)switch(t.which){case 40:e=t.altKey;break;case 13:case 32:e=!0}e&&function(t){t.preventDefault(),window.open(a),(0,s.jl)().click("ChatButton","NavBar",null,null,"Default chat web page")}(t)};var m=function(t){function e(e){var n=t.call(this,e)||this;return n.onMouseChange=function(t){return n.setState({isHovered:t})},n.state={isHovered:!1},a=n.props.chatWebLink,n}return(0,i.__extends)(e,t),e.prototype.render=function(){if(!this.props.chatEnabled)return null;var t=this.props.isConsumerShell?"SkypeLogo":"OfficeChat",e=(0,u.j)(),n=this.props.unreadBadgeValue>0?"":null;return r.createElement("button",{type:"button",id:l.vP,className:(0,o.iv)(d.button,e.headerButton),"aria-disabled":"false",title:p.b.Chat,"aria-label":p.b.Chat,role:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1)},r.createElement(o.BH,{fontIconCss:"ms-Icon--".concat(t),fontSize:f.GX.toString(),className:(0,o.iv)(h.icon),isAriaHidden:!0}),r.createElement(o.Eb,{unseenItemCount:this.props.unreadBadgeValue,isParentHovered:this.state.isHovered,badgeStyles:(0,o.iv)(d.headerButtonBadgePosition),badgeCharacter:n}))},e.prototype.componentDidMount=function(){(0,o.yw)([l.vP],"".concat(c.t.CLICK," ").concat(c.t.KEYDOWN),C)},e}(r.Component)},51907:function(t,e,n){"use strict";n.r(e),n.d(e,{ChatHeaderButtonConnector:function(){return _},ChatIconConnector:function(){return k},initializeChatComponent:function(){return A}});var a=n(64731),i=n(25445),r=n(2979),o=n(62293),s=n(91011),u=n(77224),c=(0,n(3073).k)((function(){return n.e("chatbase").then(n.bind(n,32094)).then((function(t){return t.ChatBaseControlConnector}))})),l=function(t){function e(e){var n=t.call(this,e)||this;return n.state={shouldPreAuth:!1},n}return(0,u.__extends)(e,t),e.prototype.render=function(){var t=this.state.shouldPreAuth;return this.props.shouldInitChatOnFirstClick||t?a.createElement(c,null):null},e.prototype.componentDidMount=function(){this.fetchShouldPreAuth()},e.prototype.fetchShouldPreAuth=function(){return(0,u.__awaiter)(this,void 0,void 0,(function(){var t;return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.props.isTeamsAvailable];case 1:return e.sent()?[4,this.props.shouldLoadEmbedChatPreAuthOnIdle]:[3,3];case 2:t=e.sent(),this.setState({shouldPreAuth:t}),e.label=3;case 3:return[2]}}))}))},e}(a.Component),h=(0,r.connect)((function(t){var e=t.shellInitDataState;return{shouldInitChatOnFirstClick:t.chatState.initChatOnFirstClick,shouldLoadEmbedChatPreAuthOnIdle:e.renderSettings.shouldLoadEmbedChatPreAuthOnIdle,isTeamsAvailable:e.renderSettings.shouldEnableChat}}))(l),d=n(6037),p=n(47487),f=n(70163),C=n(85266),m=n(82548),v=n(78822),b=n(27676),g=function(t){function e(e){var n=t.call(this,e)||this;return n.chatEnablementPromise=null,n.state={isHovered:!1,delayRender:!!e.shouldEnableChat},n}return(0,u.__extends)(e,t),e.prototype.componentDidMount=function(){return(0,u.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,u.__generator)(this,(function(n){switch(n.label){case 0:if(!this.state.delayRender)return[3,4];this.chatEnablementPromise=(0,p.W)(this.props.shouldEnableChat),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.chatEnablementPromise.promise];case 2:return t=n.sent(),this.setState({delayRender:!t}),[3,4];case 3:return(e=n.sent())&&!e.isCancelled&&(0,s.jl)().exception("Chat_Delay_Initialization_Failed",6,e),[3,4];case 4:return this.props.isAvailable&&(0,s.jl)().perfMarker("ChatTimeToInteractive"),[2]}}))}))},e.prototype.componentWillUnmount=function(){var t;null===(t=this.chatEnablementPromise)||void 0===t||t.cancel()},e.prototype.getAriaLabel=function(){var t=b.b.Chat;return void 0!==this.props.unseenItemCount&&0!==this.props.unseenItemCount&&(t=b.b.ChatUnreadItems),t},e.prototype.render=function(){var t=this;if(!this.props.chatEnabled||this.state.delayRender)return null;var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getAriaLabel(),affordanceMenuItemText:b.b.Chat,iconID:this.props.isConsumerShell?"SkypeLogo":"OfficeChat",iconFontSize:m.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:function(e){t.setState({isHovered:e})},onDimensionsChanged:this.props.controlDimensionsChanged},n=this.props.unseenItemCount>0?"":null;return 0===this.props.renderContext?a.createElement(f.sO,(0,u.__assign)({},e),a.createElement(d.Eb,{unseenItemCount:this.props.unseenItemCount,isParentHovered:this.state.isHovered,badgeStyles:v.headerButtonBadgePosition,badgeCharacter:n})):a.createElement(f.b,(0,u.__assign)({},e),a.createElement(d.Eb,{unseenItemCount:this.props.unseenItemCount,isParentHovered:this.state.isHovered,badgeStyles:C.affordanceContextMenuItemBadgePosition,badgeCharacter:n}))},e}(a.Component),S=n(74213),I=n(51932);var _=(0,r.connect)((function(t,e){var n,a,i=function(t){var e=!1,n=!1;t.chatState.chatEnabled&&(e=!t.shellInitDataState.renderSettings.initChatOnPageLoad,null!==t.chatState.isChatAPIInitialized&&(t.chatState.isChatAPIInitialized?e=!0:t.userState.isConsumer&&(e=!0,n=!0)));return{showButton:e,useButtonAsLink:n}}(t);return{isAvailable:i.showButton,id:e&&e.id,isActive:null!==(n=t.chatState&&t.chatState.isChatRecentsPaneOpen)&&void 0!==n&&n,useButtonAsLink:i.useButtonAsLink,chatWebLink:t.chatState&&t.chatState.chatWebLink,chatEnabled:t.chatState&&t.chatState.chatEnabled,isConsumerShell:null===(a=t.shellInitDataState.clientData)||void 0===a?void 0:a.IsConsumerShell,controlDimensionsChanged:e.controlDimensionsChanged,isChatRecentsPaneInitialized:t.chatState.isChatRecentsPaneInitialized,isChatAPIInitialized:t.chatState.isChatAPIInitialized,unseenItemCount:t.chatState.unreadBadgeValue,shouldEnableChat:t.shellInitDataState.renderSettings.shouldEnableChat}}),(function(t){return{onClick:function(e,n){e.stopPropagation(),(0,s.jl)().click("ChatButton","NavBar",null,null,"Active state: ".concat(n.isActive,", Render context: ").concat(n.renderContext,", Use Button as Link: ").concat(n.useButtonAsLink)),n.onClick&&n.onClick(e),n.useButtonAsLink?(e.preventDefault(),window.open(n.chatWebLink)):(n.isChatAPIInitialized?n.isChatRecentsPaneInitialized||(0,I.UN)((function(){t((0,S.Lc)(!0))}),(function(e,n){t((0,S.ik)(e)),t((0,d.uS)(n))})):t((0,S.NL)(!0)),t((0,S.ik)(!n.isActive)),t((0,d.uS)(e.currentTarget&&e.currentTarget.id)))}}}),(function(t,e,n){var a=(0,u.__assign)((0,u.__assign)({},n),t);return(0,u.__assign)((0,u.__assign)((0,u.__assign)({},a),e),{onClick:function(t){return e.onClick(t,a)},onDimensionsChanged:function(){return e.onDimensionsChanged(a)}})}))(g),P=n(29987),k=(0,r.connect)((function(t){return{unreadBadgeValue:t.chatState.unreadBadgeValue,chatEnabled:t.chatState.chatEnabled,chatWebLink:t.chatState.chatWebLink,isConsumerShell:t.shellInitDataState&&t.shellInitDataState.clientData.IsConsumerShell}}))(P.k);function A(){var t=document.createElement("div");document.getElementById((0,s.aH)().top).appendChild(t);var e=(0,o.e)();i.render(a.createElement(r.Provider,{store:e},a.createElement(h,null)),t)}},74213:function(t,e,n){"use strict";n.d(e,{Lc:function(){return o},NL:function(){return d},e$:function(){return s},ik:function(){return r},pA:function(){return c},uA:function(){return l},ug:function(){return h},xg:function(){return u}});var a=n(36198),i=n(40719);function r(t){return{type:a.__,isRecentsOpen:t}}function o(t){return{type:i.q,isRecentsInitialized:t}}function s(t){return{type:i.D,isChatAPIInitialized:t}}function u(t){return{type:i.P7,isChatAPIPreAuthCompleted:t}}function c(t){return{type:i.nZ,unreadBadgeValue:t}}function l(t){return{type:i.YI,isTeamsChatActivated:t}}function h(){return{type:i.M3}}function d(t){return{type:i.Ak,initChatOnFirstClick:t}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_chat_end"),shellPerformance.measure("shell_chat","shell_chat_start","shell_chat_end"));