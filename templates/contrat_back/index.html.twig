{% extends 'admin/base-front.html.twig' %}

{% block title %}Contrat index{% endblock %}

{% block body %}
    <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
        <div class="app-brand demo">
            <a href="index-2.html" class="app-brand-link">
                <span class="app-brand-logo demo">
                    {# Your logo here #}
                </span>
                <span class="app-brand-text demo menu-text fw-bold ms-2">Django</span>
            </a>
            <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
                <i class="bx bx-chevron-left bx-sm align-middle"></i>
            </a>
        </div>
        <div class="menu-inner-shadow"></div>
        <ul class="menu-inner py-1">
            <li class="menu-header small text-uppercase">
                <span class="menu-header-text">Gestions</span>
            </li>
            <li class="menu-item">
                <a href="javascript:void(0);" class="menu-link menu-toggle">
                    <i class="menu-icon tf-icons bx bx-dock-top"></i>
                    <div data-i18n="Gestion Contrat">Gestion Contrat</div>
                </a>
                <ul class="menu-sub">
                    <li class="menu-item">
                        <a href="{{ path('app_contrat_back_index') }}" class="menu-link">
                            <div data-i18n="contrat">Contrat</div>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ path('app_type_index') }}" class="menu-link">
                            <div data-i18n="Type Contrat">Type Contrat</div>
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
    </aside>

    <h1>Contrat index</h1>
 <div style="margin-bottom: 10px;">
    <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Write here..." name="text" class="input" style="margin-left: 1000px;">
    <div class="paste-button" onmouseleave="hideDropdown()">
        <button class="button" onmouseenter="showDropdown()">Select Attribute &nbsp; ▼</button>
        <div class="dropdown-content" id="searchAttributeDropdown">
            <a href="#" onclick="selectAttribute('id')">Id</a>
            <a href="#" onclick="selectAttribute('nom')">Nom</a>
            <a href="#" onclick="selectAttribute('prenom')">Prenom</a>
            <a href="#" onclick="selectAttribute('email')">Email</a>
            <a href="#" onclick="selectAttribute('dateDebutContrat')">DateDebutContrat</a>
            <a href="#" onclick="selectAttribute('datefinContrat')">DatefinContrat</a>
            <a href="#" onclick="selectAttribute('typeCouverture')">Type de contrat</a>
            <a href="#" onclick="selectAttribute('adresseAssuré')">AdresseAssuré</a> 
            <a href="#" onclick="selectAttribute('numeroAssur')">NumeroAssur</a>           
        </div>
    </div>
</div>

<select id="searchAttribute" style="display: none;">
    <option value="id">Id</option>
    <option value="nom">Nom</option>
    <option value="prenom">Prenom</option>
    <option value="email">Email</option>
    <option value="dateDebutContrat">DateDebutContrat</option>
    <option value="datefinContrat">DatefinContrat</option>
    <option value="typeCouverture">Type de contrat</option>
    <option value="adresseAssuré">AdresseAssuré</option>
    <option value="numeroAssur">NumeroAssur</option>
</select>

<table class="table" id="ContratTable">
    <thead>
        <tr>
            <th><a href="#" onclick="toggleSorting(0)">Id</a></th>
            <th><a href="#" onclick="toggleSorting(1)">Nom</a></th>
            <th><a href="#" onclick="toggleSorting(2)">Prenom</a></th>
            <th><a href="#" onclick="toggleSorting(3)">Email</a></th>
            <th><a href="#" onclick="toggleSorting(4)">DateDebutContrat</a></th>
            <th><a href="#" onclick="toggleSorting(5)">DatefinContrat</a></th>
            <th><a href="#" onclick="toggleSorting(6)">Type de contrat</a></th>
            <th><a href="#" onclick="toggleSorting(7)">AdresseAssuré</a></th>
            <th><a href="#" onclick="toggleSorting(8)">NumeroAssur</a></th>
        </tr>
    </thead>
        <tbody>
            {% for contrat in contrats %}
                <tr>
                    <td>{{ contrat.id }}</td>
                    <td>{{ contrat.nom }}</td>
                    <td>{{ contrat.prenom }}</td>
                    <td>{{ contrat.email }}</td>
                    <td>{{ contrat.dateDebutContrat ? contrat.dateDebutContrat|date('Y-m-d') : '' }}</td>
                    <td>{{ contrat.datefinContrat ? contrat.datefinContrat|date('Y-m-d') : '' }}</td>
                    <td>{{ contrat.getTypeCouverture }}</td>
                    <td>{{ contrat.adresseAssur }}</td>
                    <td>{{ contrat.numeroAssur }}</td>
                    <td>
                        <a href="{{ path('app_contrat_show', {'id': contrat.id}) }}">show</a>
                        <a href="{{ path('app_contrat_edit', {'id': contrat.id}) }}">edit</a>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="10">no records found</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{{ path('app_contrat_new') }}">Create new</a>


    <script>
       var sortOrder = "asc";

    function searchTable() {
        var input, filter, table, tr, td, i, j, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("ContratTable");
        tr = table.getElementsByTagName("tr");

        // Get the index of the selected attribute from the dropdown
        var attributeIndex = document.getElementById("searchAttribute").selectedIndex;

        for (i = 1; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[attributeIndex];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }

    function toggleSorting(columnIndex) {
        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("ContratTable");
        switching = true;

        while (switching) {
            switching = false;
            rows = table.rows;

            for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("td")[columnIndex];
                y = rows[i + 1].getElementsByTagName("td")[columnIndex];

                if (sortOrder === "asc") {
                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                        shouldSwitch = true;
                        break;
                    }
                } else if (sortOrder === "desc") {
                    if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                        shouldSwitch = true;
                        break;
                    }
                }
            }
            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
            }
        }
        // Reverse the sorting order for the next click
        sortOrder = sortOrder === "asc" ? "desc" : "asc";
    }

    function showDropdown() {
    var dropdownContent = document.getElementById("searchAttributeDropdown");
    dropdownContent.style.display = "block";
    }

    function hideDropdown() {
    var dropdownContent = document.getElementById("searchAttributeDropdown");
    dropdownContent.style.display = "none";
    }

    function selectAttribute(attribute) {
    document.getElementById("searchAttribute").value = attribute;
    hideDropdown();
    updateButtonText(attribute);
    }

    function updateButtonText(attribute) {
    var button = document.querySelector(".paste-button .button");
    button.textContent = attribute /*+ " &nbsp; ▼"*/;
    }


</script>

<style>
.input {
  border-radius: 10px;
  outline: 2px solid #FEBF00;
  border: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  background-color: #e2e2e2;
  outline-offset: 3px;
  padding: 10px 1rem;
  transition: 0.25s;
}

.input:focus {
  outline-offset: 5px;
  background-color: #fff
}

.paste-button {
  position: relative;
  display: inline-block;
}

.button {
  background-color: #4CAF50;
  color: #ffffff;
  padding: 10px 15px;
  font-size: 15px;
  font-weight: bold;
  border: none;
  border-radius: 15px;
  cursor: pointer;
  margin-left: 10px;
}

.dropdown-content {
  display: none;
  position: absolute;
  z-index: 1;
  min-width: 200px;
  background-color: #ffffff;
  border: 2px solid #4CAF50;
  border-top: none;
  border-radius: 0px 0px 15px 15px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}

.dropdown-content a {
  color: #4CAF50;
  padding: 8px 10px;
  text-decoration: none;
  display: block;
  transition: 0.1s;
}

.dropdown-content a:hover {
  background-color: #4CAF50;
  color: #ffffff;
}

.paste-button:hover .dropdown-content {
  display: block;
}

</style>
{% endblock %}
